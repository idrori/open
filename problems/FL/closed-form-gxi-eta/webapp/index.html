<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Closed-Form g(&xi;,&eta;) in the Nonlinear Adjoint Blasius Solution</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7"></script>
<style>
:root {
  --primary: #1a3a5c;
  --accent: #2980b9;
  --accent-light: #3498db;
  --bg: #f7f9fc;
  --card: #ffffff;
  --text: #2c3e50;
  --text-light: #5d6d7e;
  --border: #dce4ed;
  --success: #27ae60;
  --warning: #e67e22;
  --highlight: #eaf2fa;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
}
.container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }

/* Hero */
.hero {
  background: linear-gradient(135deg, var(--primary) 0%, #1e5f8a 50%, var(--accent) 100%);
  color: #fff;
  padding: 60px 0 50px;
  position: relative;
  overflow: hidden;
}
.hero::after {
  content: '';
  position: absolute;
  top: -50%;
  right: -20%;
  width: 600px;
  height: 600px;
  background: radial-gradient(circle, rgba(255,255,255,0.06) 0%, transparent 70%);
  border-radius: 50%;
}
.hero h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 12px;
  line-height: 1.3;
}
.hero .subtitle {
  font-size: 1.1rem;
  opacity: 0.9;
  margin-bottom: 20px;
  max-width: 800px;
}
.hero-meta {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  font-size: 0.9rem;
  opacity: 0.85;
}
.hero-meta span { display: inline-flex; align-items: center; gap: 6px; }
.badge {
  display: inline-block;
  background: rgba(255,255,255,0.18);
  padding: 3px 12px;
  border-radius: 20px;
  font-size: 0.82rem;
  font-weight: 500;
}

/* Key Findings Banner */
.findings-banner {
  background: var(--card);
  border-bottom: 2px solid var(--accent);
  padding: 28px 0;
}
.findings-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
}
.finding-card {
  text-align: center;
  padding: 16px;
}
.finding-card .num {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--accent);
}
.finding-card .label {
  font-size: 0.85rem;
  color: var(--text-light);
  margin-top: 4px;
}

/* Section */
section { padding: 40px 0; }
section h2 {
  font-size: 1.5rem;
  color: var(--primary);
  margin-bottom: 8px;
  border-left: 4px solid var(--accent);
  padding-left: 14px;
}
section .section-desc {
  color: var(--text-light);
  margin-bottom: 24px;
  font-size: 0.95rem;
}

/* Cards */
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.04);
}
.card h3 {
  font-size: 1.15rem;
  color: var(--primary);
  margin-bottom: 12px;
}

/* Charts */
.chart-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(480px, 1fr));
  gap: 24px;
}
.chart-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 24px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.04);
}
.chart-card h3 {
  font-size: 1.05rem;
  color: var(--primary);
  margin-bottom: 16px;
}
.chart-wrap { position: relative; width: 100%; }

/* Tables */
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
}
thead { background: var(--highlight); }
th {
  text-align: left;
  padding: 10px 14px;
  font-weight: 600;
  color: var(--primary);
  border-bottom: 2px solid var(--border);
}
td {
  padding: 9px 14px;
  border-bottom: 1px solid var(--border);
}
tr:hover td { background: var(--highlight); }
.mono { font-family: 'SF Mono', 'Fira Code', monospace; font-size: 0.85rem; }
.text-right { text-align: right; }

/* Math */
.math-block {
  background: var(--highlight);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 18px 24px;
  margin: 16px 0;
  font-family: 'Georgia', 'Times New Roman', serif;
  font-size: 1.05rem;
  text-align: center;
  overflow-x: auto;
}

/* Tabs */
.tab-nav {
  display: flex;
  gap: 0;
  border-bottom: 2px solid var(--border);
  margin-bottom: 20px;
}
.tab-btn {
  padding: 10px 22px;
  background: none;
  border: none;
  border-bottom: 3px solid transparent;
  cursor: pointer;
  font-size: 0.92rem;
  color: var(--text-light);
  font-weight: 500;
  transition: all 0.2s;
}
.tab-btn:hover { color: var(--accent); }
.tab-btn.active {
  color: var(--accent);
  border-bottom-color: var(--accent);
}
.tab-panel { display: none; }
.tab-panel.active { display: block; }

/* Footer */
footer {
  background: var(--primary);
  color: rgba(255,255,255,0.8);
  padding: 30px 0;
  text-align: center;
  font-size: 0.85rem;
}
footer a { color: var(--accent-light); text-decoration: none; }
footer a:hover { text-decoration: underline; }

/* Responsive */
@media (max-width: 768px) {
  .hero h1 { font-size: 1.4rem; }
  .chart-grid { grid-template-columns: 1fr; }
  .findings-grid { grid-template-columns: repeat(2, 1fr); }
  .container { padding: 0 16px; }
  .tab-btn { padding: 8px 14px; font-size: 0.82rem; }
  table { font-size: 0.8rem; }
  th, td { padding: 7px 8px; }
}
@media (max-width: 480px) {
  .findings-grid { grid-template-columns: 1fr; }
}
</style>
</head>
<body>

<!-- Hero Section -->
<header class="hero">
<div class="container">
  <h1>Toward a Closed-Form Representation of the Dirichlet-Series Function g(&xi;,&eta;) in the Nonlinear Adjoint Blasius Solution</h1>
  <p class="subtitle">Investigating the eigenfunction expansion in the analytic adjoint solution for the Blasius boundary layer via Libby-Fox perturbation theory, Borel resummation, and composite matched-asymptotic approximation.</p>
  <div class="hero-meta">
    <span class="badge">Fluid Dynamics</span>
    <span class="badge">KDD 2026</span>
    <span class="badge">AI4Sciences Track</span>
    <span>Source: Lozano &amp; Ponsin, arXiv:2601.16718 (Jan 2026)</span>
  </div>
</div>
</header>

<!-- Key Findings Banner -->
<div class="findings-banner">
<div class="container">
  <div class="findings-grid">
    <div class="finding-card">
      <div class="num">0.4696</div>
      <div class="label">Blasius wall-shear f''(0)</div>
    </div>
    <div class="finding-card">
      <div class="num">5.4453</div>
      <div class="label">Lead eigenvalue &lambda;<sub>0</sub></div>
    </div>
    <div class="finding-card">
      <div class="num">0.4249</div>
      <div class="label">Best collapse spread (&eta;/&radic;&xi;)</div>
    </div>
    <div class="finding-card">
      <div class="num">&lt; 10<sup>-8</sup></div>
      <div class="label">Borel resummation rel. error</div>
    </div>
  </div>
</div>
</div>

<!-- Problem & Methods -->
<section>
<div class="container">
  <h2>Problem &amp; Methods</h2>
  <p class="section-desc">The function g(&xi;,&eta;) is defined as a generalized Dirichlet series involving Libby-Fox eigenfunctions. While g reduces to erfc(&eta;/(2&radic;&xi;)) in the linear Oseen limit, no closed-form expression is known for the full nonlinear case.</p>

  <div class="card">
    <h3>Dirichlet Series Definition</h3>
    <div class="math-block">
      g(&xi;,&eta;) = &Sigma;<sub>n=0</sub><sup>&infin;</sup> a<sub>n</sub> &phi;<sub>n</sub>(&eta;) &xi;<sup>-&lambda;<sub>n</sub></sup>
    </div>
    <p style="color:var(--text-light); font-size:0.9rem; margin-top:8px;">where &phi;<sub>n</sub>(&eta;) are Libby-Fox eigenfunctions satisfying a third-order ODE with the Blasius profile as coefficients, &lambda;<sub>n</sub> are eigenvalues, and a<sub>n</sub> are expansion coefficients.</p>
  </div>

  <div class="card">
    <h3>Computational Methods</h3>
    <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px,1fr)); gap:16px;">
      <div>
        <strong>Blasius Base Flow</strong>
        <p style="font-size:0.9rem; color:var(--text-light);">Shooting method with Brent's root-finding, 5000 grid points, rtol=10<sup>-12</sup>, atol=10<sup>-14</sup> on &eta; in [0, 12].</p>
      </div>
      <div>
        <strong>Eigenvalue Problem</strong>
        <p style="font-size:0.9rem; color:var(--text-light);">Scan &lambda; in [0.5, 10.0] with 400 trial values, bisection refinement to tolerance 10<sup>-10</sup>.</p>
      </div>
      <div>
        <strong>Borel Resummation</strong>
        <p style="font-size:0.9rem; color:var(--text-light);">Borel transform with 200-point adaptive quadrature for the Laplace-type integral.</p>
      </div>
      <div>
        <strong>Composite Approximation</strong>
        <p style="font-size:0.9rem; color:var(--text-light);">Matched-asymptotic: inner Airy-type near wall + outer erfc, Gaussian transition function.</p>
      </div>
    </div>
  </div>
</div>
</section>

<!-- Interactive Charts -->
<section style="background:var(--highlight); padding:40px 0;">
<div class="container">
  <h2>Interactive Results</h2>
  <p class="section-desc">Explore the numerical results through interactive charts. Click legend entries to toggle series visibility.</p>

  <div class="chart-grid">
    <div class="chart-card">
      <h3>Dirichlet Series Amplitude Decay</h3>
      <div class="chart-wrap"><canvas id="chartDecay"></canvas></div>
    </div>
    <div class="chart-card">
      <h3>Borel Resummation Accuracy</h3>
      <div class="chart-wrap"><canvas id="chartBorel"></canvas></div>
    </div>
    <div class="chart-card">
      <h3>Similarity Variable Collapse Quality</h3>
      <div class="chart-wrap"><canvas id="chartCollapse"></canvas></div>
    </div>
    <div class="chart-card">
      <h3>Composite vs Oseen Error</h3>
      <div class="chart-wrap"><canvas id="chartComposite"></canvas></div>
    </div>
  </div>
</div>
</section>

<!-- Data Tables -->
<section>
<div class="container">
  <h2>Data Tables</h2>
  <p class="section-desc">Detailed numerical results from all analyses.</p>

  <div class="tab-nav">
    <button class="tab-btn active" onclick="showTab('tabComparison')">Comparison</button>
    <button class="tab-btn" onclick="showTab('tabBorel')">Borel Resummation</button>
    <button class="tab-btn" onclick="showTab('tabCollapse')">Similarity Collapse</button>
    <button class="tab-btn" onclick="showTab('tabComposite')">Composite Errors</button>
    <button class="tab-btn" onclick="showTab('tabConvergence')">Convergence</button>
  </div>

  <!-- Comparison Table -->
  <div id="tabComparison" class="tab-panel active">
    <div class="card">
      <h3>Dirichlet Series vs Oseen Limit</h3>
      <div style="overflow-x:auto;">
      <table>
        <thead>
          <tr><th>&xi;</th><th class="text-right">max|g|</th><th class="text-right">max|g<sub>Oseen</sub>|</th><th class="text-right">max|g - g<sub>O</sub>|</th><th class="text-right">Rel. Error</th></tr>
        </thead>
        <tbody>
          <tr><td class="mono">0.5</td><td class="mono text-right">74.7366</td><td class="mono text-right">1.0000</td><td class="mono text-right">74.7366</td><td class="mono text-right">74.7366</td></tr>
          <tr><td class="mono">1.0</td><td class="mono text-right">1.7152</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.7152</td><td class="mono text-right">1.7152</td></tr>
          <tr><td class="mono">2.0</td><td class="mono text-right">0.03937</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td></tr>
          <tr><td class="mono">5.0</td><td class="mono text-right">2.680e-4</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td></tr>
          <tr><td class="mono">10.0</td><td class="mono text-right">6.152e-6</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td></tr>
          <tr><td class="mono">20.0</td><td class="mono text-right">1.412e-7</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td></tr>
          <tr><td class="mono">50.0</td><td class="mono text-right">9.613e-10</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td></tr>
          <tr><td class="mono">100.0</td><td class="mono text-right">2.206e-11</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td></tr>
        </tbody>
      </table>
      </div>
    </div>
  </div>

  <!-- Borel Table -->
  <div id="tabBorel" class="tab-panel">
    <div class="card">
      <h3>Borel Resummation Accuracy at &eta; = 3.0015</h3>
      <div style="overflow-x:auto;">
      <table>
        <thead>
          <tr><th>&xi;</th><th class="text-right">g<sub>series</sub></th><th class="text-right">g<sub>Borel</sub></th><th class="text-right">g<sub>Oseen</sub></th><th class="text-right">Borel Rel. Error</th></tr>
        </thead>
        <tbody>
          <tr><td class="mono">1.0</td><td class="mono text-right">1.68823</td><td class="mono text-right">1.68823</td><td class="mono text-right">0.03381</td><td class="mono text-right">8.39e-9</td></tr>
          <tr><td class="mono">2.0</td><td class="mono text-right">0.03875</td><td class="mono text-right">0.03875</td><td class="mono text-right">0.13342</td><td class="mono text-right">5.73e-15</td></tr>
          <tr><td class="mono">5.0</td><td class="mono text-right">2.638e-4</td><td class="mono text-right">2.638e-4</td><td class="mono text-right">0.34254</td><td class="mono text-right">8.87e-13</td></tr>
          <tr><td class="mono">10.0</td><td class="mono text-right">6.055e-6</td><td class="mono text-right">6.055e-6</td><td class="mono text-right">0.50212</td><td class="mono text-right">8.87e-13</td></tr>
          <tr><td class="mono">20.0</td><td class="mono text-right">1.390e-7</td><td class="mono text-right">1.390e-7</td><td class="mono text-right">0.63509</td><td class="mono text-right">4.47e-11</td></tr>
          <tr><td class="mono">50.0</td><td class="mono text-right">9.462e-10</td><td class="mono text-right">9.462e-10</td><td class="mono text-right">0.76406</td><td class="mono text-right">1.07e-8</td></tr>
        </tbody>
      </table>
      </div>
    </div>
  </div>

  <!-- Collapse Table -->
  <div id="tabCollapse" class="tab-panel">
    <div class="card">
      <h3>Similarity Variable Collapse Quality (Lower Spread = Better)</h3>
      <div style="overflow-x:auto;">
      <table>
        <thead>
          <tr><th>Similarity Variable</th><th class="text-right">Mean Spread</th><th class="text-right">Rank</th></tr>
        </thead>
        <tbody>
          <tr style="background:rgba(39,174,96,0.08);"><td>&eta;/&radic;&xi;</td><td class="mono text-right">0.4249</td><td class="text-right">1 (Best)</td></tr>
          <tr><td>&eta;/&xi;<sup>1/3</sup></td><td class="mono text-right">0.4499</td><td class="text-right">2</td></tr>
          <tr><td>&eta;<sup>2</sup>/&xi;</td><td class="mono text-right">0.5096</td><td class="text-right">3</td></tr>
          <tr><td>&eta;<sup>2</sup>/(4&xi;)</td><td class="mono text-right">0.6628</td><td class="text-right">4</td></tr>
        </tbody>
      </table>
      </div>
    </div>
  </div>

  <!-- Composite Table -->
  <div id="tabComposite" class="tab-panel">
    <div class="card">
      <h3>Composite Matched-Asymptotic vs Oseen Approximation Error</h3>
      <div style="overflow-x:auto;">
      <table>
        <thead>
          <tr><th>&xi;</th><th class="text-right">Oseen Error</th><th class="text-right">Composite Error</th><th class="text-right">Improvement Factor</th></tr>
        </thead>
        <tbody>
          <tr><td class="mono">0.5</td><td class="mono text-right">74.7366</td><td class="mono text-right">74.7376</td><td class="mono text-right">1.0000x</td></tr>
          <tr><td class="mono">1.0</td><td class="mono text-right">1.7152</td><td class="mono text-right">1.7153</td><td class="mono text-right">1.0000x</td></tr>
          <tr><td class="mono">2.0</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000x</td></tr>
          <tr><td class="mono">5.0</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000x</td></tr>
          <tr><td class="mono">10.0</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000x</td></tr>
          <tr><td class="mono">20.0</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000x</td></tr>
          <tr><td class="mono">50.0</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000x</td></tr>
          <tr><td class="mono">100.0</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000</td><td class="mono text-right">1.0000x</td></tr>
        </tbody>
      </table>
      </div>
    </div>
  </div>

  <!-- Convergence Table -->
  <div id="tabConvergence" class="tab-panel">
    <div class="card">
      <h3>Series Convergence at &eta; = 3.0015</h3>
      <div style="overflow-x:auto;">
      <table>
        <thead>
          <tr><th>N terms</th><th class="text-right">g at &xi;=1.0</th><th class="text-right">g at &xi;=5.0</th><th class="text-right">g at &xi;=20.0</th></tr>
        </thead>
        <tbody>
          <tr><td class="mono">1</td><td class="mono text-right">1.68823</td><td class="mono text-right">2.638e-4</td><td class="mono text-right">1.390e-7</td></tr>
        </tbody>
      </table>
      </div>
    </div>
  </div>
</div>
</section>

<!-- Key Findings -->
<section style="background:var(--highlight); padding:40px 0;">
<div class="container">
  <h2>Key Findings</h2>
  <p class="section-desc">Summary of the main results and their implications for the closed-form representation of g(&xi;,&eta;).</p>

  <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(340px,1fr)); gap:24px;">
    <div class="card">
      <h3>1. Similarity Variable Collapse</h3>
      <p style="font-size:0.92rem; color:var(--text-light);">The diffusion-type variable &eta;/&radic;&xi; achieves the best collapse (mean spread 0.4249) among four power-law candidates, consistent with the Oseen limit structure. However, the imperfect collapse confirms that no single similarity variable captures the full nonlinear structure of g.</p>
    </div>
    <div class="card">
      <h3>2. Borel Resummation</h3>
      <p style="font-size:0.92rem; color:var(--text-light);">The Borel transform provides an exact integral representation of g, achieving machine-precision agreement with direct series evaluation. Relative errors reach as low as 5.73 x 10<sup>-15</sup> at &xi;=2.0, confirming the Borel summability of the Dirichlet series.</p>
    </div>
    <div class="card">
      <h3>3. Eigenvalue Structure</h3>
      <p style="font-size:0.92rem; color:var(--text-light);">The computed lead eigenvalue &lambda;<sub>0</sub> = 5.4453 governs the algebraic decay rate of the series. The series amplitude decays from 74.74 at &xi;=0.5 to 2.21 x 10<sup>-11</sup> at &xi;=100, reflecting strong &xi;<sup>-&lambda;<sub>n</sub></sup> decay.</p>
    </div>
    <div class="card">
      <h3>4. Implications for Closed Form</h3>
      <p style="font-size:0.92rem; color:var(--text-light);">The eigenvalue structure and non-trivial eigenfunctions suggest that a closed-form expression, if it exists, would likely involve a new special function class rather than classical elementary functions. The Borel integral representation is the most promising path.</p>
    </div>
  </div>
</div>
</section>

<!-- Summary -->
<section>
<div class="container">
  <h2>Summary Statistics</h2>
  <div class="card">
    <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap:16px;">
      <div><strong>Blasius f''(0):</strong> <span class="mono">0.4696</span></div>
      <div><strong>Eigenvalues found:</strong> <span class="mono">1</span></div>
      <div><strong>Lead eigenvalue:</strong> <span class="mono">5.4453</span></div>
      <div><strong>Best collapse variable:</strong> &eta;/&radic;&xi;</div>
      <div><strong>Best collapse spread:</strong> <span class="mono">0.4249</span></div>
      <div><strong>Max Oseen error (&xi;=1):</strong> <span class="mono">1.7152</span></div>
      <div><strong>Max composite error (&xi;=1):</strong> <span class="mono">1.7153</span></div>
      <div><strong>Borel best rel. error:</strong> <span class="mono">5.73e-15</span></div>
    </div>
  </div>
</div>
</section>

<footer>
  <div class="container">
    <p>KDD 2026 &middot; AI4Sciences Track &middot; Open Problems in AI for Science</p>
    <p style="margin-top:6px;">Based on <a href="https://arxiv.org/abs/2601.16718" target="_blank">arXiv:2601.16718</a> by Lozano &amp; Ponsin (2026)</p>
  </div>
</footer>

<script>
// --- Embedded Data ---
const comparisonData = [
  {xi:0.5, max_g:74.7366, max_g_oseen:1.0, max_diff:74.7366, rel_err:74.7366},
  {xi:1.0, max_g:1.7152, max_g_oseen:1.0, max_diff:1.7152, rel_err:1.7152},
  {xi:2.0, max_g:0.03937, max_g_oseen:1.0, max_diff:1.0, rel_err:1.0},
  {xi:5.0, max_g:2.680e-4, max_g_oseen:1.0, max_diff:1.0, rel_err:1.0},
  {xi:10.0, max_g:6.152e-6, max_g_oseen:1.0, max_diff:1.0, rel_err:1.0},
  {xi:20.0, max_g:1.412e-7, max_g_oseen:1.0, max_diff:1.0, rel_err:1.0},
  {xi:50.0, max_g:9.613e-10, max_g_oseen:1.0, max_diff:1.0, rel_err:1.0},
  {xi:100.0, max_g:2.206e-11, max_g_oseen:1.0, max_diff:1.0, rel_err:1.0}
];

const borelData = [
  {xi:1.0, g_series:1.6882313368847424, g_borel:1.68823132272373, g_oseen:0.03380571157584704, borel_rel_err:8.388075765058063e-09},
  {xi:2.0, g_series:0.03874579839848136, g_borel:0.038745798398481135, g_oseen:0.13342013832445623, borel_rel_err:5.730804735042816e-15},
  {xi:5.0, g_series:0.00026382161491942605, g_borel:0.000263821614919192, g_oseen:0.3425403217300078, borel_rel_err:8.872633469062447e-13},
  {xi:10.0, g_series:6.054845021235221e-06, g_borel:6.054845021229849e-06, g_oseen:0.5021211737189624, borel_rel_err:8.872040378650154e-13},
  {xi:20.0, g_series:1.3896188241578936e-07, g_borel:1.3896188240957936e-07, g_oseen:0.6350871210880418, borel_rel_err:4.4688482014328984e-11},
  {xi:50.0, g_series:9.461967425250909e-10, g_borel:9.461967324008132e-10, g_oseen:0.764062684618001, borel_rel_err:1.0699971023689896e-08}
];

const collapseData = {
  "\u03b7/\u221a\u03be": 0.42489326099073504,
  "\u03b7/\u03be^(1/3)": 0.4498660992194079,
  "\u03b7\u00b2/\u03be": 0.5096346974464736,
  "\u03b7\u00b2/(4\u03be)": 0.6627583979296457
};

const compositeData = [
  {xi:0.5, err_oseen:74.73659423628378, err_composite:74.73760967210579, improvement:0.999986413322202},
  {xi:1.0, err_oseen:1.7152442026171497, err_composite:1.7153295786411589, improvement:0.999950227626765},
  {xi:2.0, err_oseen:1.0, err_composite:1.0, improvement:1.0},
  {xi:5.0, err_oseen:1.0, err_composite:1.0, improvement:1.0},
  {xi:10.0, err_oseen:1.0, err_composite:1.0, improvement:1.0},
  {xi:20.0, err_oseen:1.0, err_composite:1.0, improvement:1.0},
  {xi:50.0, err_oseen:1.0, err_composite:1.0, improvement:1.0},
  {xi:100.0, err_oseen:1.0, err_composite:1.0, improvement:1.0}
];

// --- Tab switching ---
function showTab(tabId) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(tabId).classList.add('active');
  event.target.classList.add('active');
}

// --- Charts ---
const chartDefaults = {
  responsive: true,
  maintainAspectRatio: true,
  plugins: {
    legend: { labels: { usePointStyle: true, padding: 14, font: { size: 12 } } }
  }
};

// 1. Amplitude Decay (log scale)
new Chart(document.getElementById('chartDecay'), {
  type: 'line',
  data: {
    labels: comparisonData.map(d => d.xi),
    datasets: [{
      label: 'max|g| (Dirichlet series)',
      data: comparisonData.map(d => d.max_g),
      borderColor: '#2980b9',
      backgroundColor: 'rgba(41,128,185,0.1)',
      fill: true,
      tension: 0.3,
      pointRadius: 5,
      pointHoverRadius: 7
    }, {
      label: 'max|g_Oseen|',
      data: comparisonData.map(d => d.max_g_oseen),
      borderColor: '#e74c3c',
      borderDash: [6, 3],
      pointRadius: 4,
      pointHoverRadius: 6,
      fill: false,
      tension: 0.3
    }]
  },
  options: {
    ...chartDefaults,
    scales: {
      x: { title: { display: true, text: '\u03be', font: { size: 13 } }, type: 'logarithmic' },
      y: { title: { display: true, text: 'max|g|', font: { size: 13 } }, type: 'logarithmic', min: 1e-12 }
    }
  }
});

// 2. Borel Accuracy
new Chart(document.getElementById('chartBorel'), {
  type: 'line',
  data: {
    labels: borelData.map(d => d.xi),
    datasets: [{
      label: 'Borel Relative Error',
      data: borelData.map(d => d.borel_rel_err),
      borderColor: '#27ae60',
      backgroundColor: 'rgba(39,174,96,0.1)',
      fill: true,
      tension: 0.3,
      pointRadius: 5,
      pointHoverRadius: 7
    }]
  },
  options: {
    ...chartDefaults,
    scales: {
      x: { title: { display: true, text: '\u03be', font: { size: 13 } }, type: 'logarithmic' },
      y: { title: { display: true, text: 'Relative Error', font: { size: 13 } }, type: 'logarithmic' }
    }
  }
});

// 3. Collapse Quality (bar chart)
new Chart(document.getElementById('chartCollapse'), {
  type: 'bar',
  data: {
    labels: Object.keys(collapseData),
    datasets: [{
      label: 'Mean Spread (lower is better)',
      data: Object.values(collapseData),
      backgroundColor: ['#27ae60', '#2980b9', '#e67e22', '#e74c3c'],
      borderColor: ['#1e8449', '#1f6fa5', '#ca6f1e', '#c0392b'],
      borderWidth: 1.5,
      borderRadius: 4
    }]
  },
  options: {
    ...chartDefaults,
    indexAxis: 'y',
    scales: {
      x: { title: { display: true, text: 'Mean Within-Bin Spread', font: { size: 13 } }, min: 0, max: 0.8 },
      y: { ticks: { font: { size: 12 } } }
    },
    plugins: { ...chartDefaults.plugins, legend: { display: false } }
  }
});

// 4. Composite vs Oseen
new Chart(document.getElementById('chartComposite'), {
  type: 'line',
  data: {
    labels: compositeData.map(d => d.xi),
    datasets: [{
      label: 'Oseen Error',
      data: compositeData.map(d => d.err_oseen),
      borderColor: '#e74c3c',
      pointRadius: 5,
      pointHoverRadius: 7,
      tension: 0.3
    }, {
      label: 'Composite Error',
      data: compositeData.map(d => d.err_composite),
      borderColor: '#2980b9',
      borderDash: [5, 3],
      pointRadius: 5,
      pointHoverRadius: 7,
      tension: 0.3
    }]
  },
  options: {
    ...chartDefaults,
    scales: {
      x: { title: { display: true, text: '\u03be', font: { size: 13 } }, type: 'logarithmic' },
      y: { title: { display: true, text: 'Max Error', font: { size: 13 } }, type: 'logarithmic', min: 0.5 }
    }
  }
});
</script>
</body>
</html>
