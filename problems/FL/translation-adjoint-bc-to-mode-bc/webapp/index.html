<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Translation of Adjoint Boundary Conditions into Modal Conditions</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7"></script>
<style>
:root {
  --primary: #1a3a5c;
  --accent: #2980b9;
  --bg: #f8f9fa;
  --card-bg: #ffffff;
  --text: #2c3e50;
  --text-light: #6c757d;
  --border: #dee2e6;
  --success: #27ae60;
  --warning: #f39c12;
  --danger: #e74c3c;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
}

.hero {
  background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
  color: white;
  padding: 3rem 2rem;
  text-align: center;
}

.hero h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  max-width: 800px;
  margin-left: auto;
  margin-right: auto;
}

.hero .subtitle {
  font-size: 1.1rem;
  opacity: 0.9;
  margin-bottom: 1.5rem;
}

.hero .meta {
  display: flex;
  justify-content: center;
  gap: 2rem;
  flex-wrap: wrap;
  font-size: 0.9rem;
  opacity: 0.85;
}

.hero .meta span {
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem 1.5rem;
}

.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
}

.grid-3 {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
}

.card {
  background: var(--card-bg);
  border-radius: 8px;
  border: 1px solid var(--border);
  padding: 1.5rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.card h2 {
  font-size: 1.15rem;
  color: var(--primary);
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid var(--accent);
}

.card h3 {
  font-size: 1rem;
  color: var(--primary);
  margin-bottom: 0.75rem;
}

.full-width {
  grid-column: 1 / -1;
}

.stat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
}

.stat-box {
  text-align: center;
  padding: 1rem;
  background: var(--bg);
  border-radius: 6px;
}

.stat-box .value {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--accent);
}

.stat-box .label {
  font-size: 0.8rem;
  color: var(--text-light);
  margin-top: 0.2rem;
}

.chart-container {
  position: relative;
  width: 100%;
  height: 300px;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
}

th, td {
  padding: 0.6rem 0.8rem;
  text-align: left;
  border-bottom: 1px solid var(--border);
}

th {
  background: var(--bg);
  color: var(--primary);
  font-weight: 600;
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.02em;
}

tr:hover td {
  background: #f0f7ff;
}

.badge {
  display: inline-block;
  padding: 0.15rem 0.5rem;
  border-radius: 3px;
  font-size: 0.75rem;
  font-weight: 600;
}

.badge-pass { background: #d4edda; color: #155724; }
.badge-warn { background: #fff3cd; color: #856404; }
.badge-info { background: #d1ecf1; color: #0c5460; }

.eq-box {
  background: var(--bg);
  border-left: 3px solid var(--accent);
  padding: 1rem 1.2rem;
  margin: 0.75rem 0;
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
  overflow-x: auto;
}

.theorem-box {
  background: #f0f7ff;
  border: 1px solid #b3d7ff;
  border-radius: 6px;
  padding: 1.2rem;
  margin: 0.75rem 0;
}

.theorem-box .title {
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 0.5rem;
}

.theorem-box ol {
  margin-left: 1.2rem;
  margin-top: 0.5rem;
}

.theorem-box li {
  margin-bottom: 0.4rem;
  font-size: 0.9rem;
}

.controls {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.btn {
  padding: 0.4rem 1rem;
  border: 1px solid var(--border);
  background: var(--card-bg);
  color: var(--text);
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.85rem;
  transition: all 0.2s;
}

.btn:hover { border-color: var(--accent); color: var(--accent); }
.btn.active { background: var(--accent); color: white; border-color: var(--accent); }

.footer {
  text-align: center;
  padding: 2rem;
  color: var(--text-light);
  font-size: 0.85rem;
  border-top: 1px solid var(--border);
  margin-top: 2rem;
}

@media (max-width: 768px) {
  .grid-2, .grid-3 { grid-template-columns: 1fr; }
  .hero h1 { font-size: 1.4rem; }
  .hero .meta { flex-direction: column; align-items: center; gap: 0.5rem; }
  .stat-grid { grid-template-columns: repeat(2, 1fr); }
}
</style>
</head>
<body>

<div class="hero">
  <h1>Translation of Adjoint Boundary Conditions into Modal Conditions</h1>
  <p class="subtitle">Blasius Boundary Layer -- Adjoint Eigenvalue Problem</p>
  <div class="meta">
    <span>Category: Fluid Dynamics (physics.flu-dyn)</span>
    <span>Reference: Lozano et al., arXiv:2601.16718 (2026)</span>
    <span>Date: Jan 23, 2026</span>
  </div>
</div>

<div class="container">

  <!-- Key Metrics -->
  <div class="card" style="margin-bottom: 1.5rem;">
    <h2>Key Results</h2>
    <div class="stat-grid">
      <div class="stat-box">
        <div class="value">2.0000</div>
        <div class="label">Leading eigenvalue &sigma;<sub>0</sub></div>
      </div>
      <div class="stat-box">
        <div class="value">0.6474</div>
        <div class="label">Second eigenvalue &sigma;<sub>1</sub></div>
      </div>
      <div class="stat-box">
        <div class="value">0.3321</div>
        <div class="label">Blasius f<sub>0</sub>''(0)</div>
      </div>
      <div class="stat-box">
        <div class="value">2</div>
        <div class="label">Modes computed</div>
      </div>
      <div class="stat-box">
        <div class="value">4001</div>
        <div class="label">Grid points</div>
      </div>
      <div class="stat-box">
        <div class="value">15.0</div>
        <div class="label">&eta;<sub>max</sub></div>
      </div>
    </div>
  </div>

  <!-- Problem Statement and Theorem -->
  <div class="grid-2">
    <div class="card">
      <h2>Problem Statement</h2>
      <p style="font-size: 0.9rem; margin-bottom: 0.75rem;">
        Determine how to translate the adjoint boundary conditions for the
        Blasius boundary layer into explicit boundary conditions for the adjoint
        eigenfunctions D<sub>k</sub>(&eta;) and separation constants &sigma;<sub>k</sub>.
      </p>
      <div class="eq-box">
        Y(x, 0) = -K / (12x)<br>
        Y(L, &eta;) = 0<br>
        Y(x, &infin;) = 0
      </div>
      <p style="font-size: 0.85rem; color: var(--text-light); margin-top: 0.5rem;">
        Separated representation: Y(x,&eta;) = &Sigma;<sub>k</sub> a<sub>k</sub> D<sub>k</sub>(&eta;) x<sup>-&sigma;<sub>k</sub>/2</sup>
      </p>
    </div>

    <div class="card">
      <h2>Main Result</h2>
      <div class="theorem-box">
        <div class="title">Theorem: Modal Boundary Conditions</div>
        <ol>
          <li><strong>Leading mode (k=0):</strong> &sigma;<sub>0</sub> = 2, D<sub>0</sub>(0) &ne; 0,
            a<sub>0</sub> D<sub>0</sub>(0) = -K/12</li>
          <li><strong>Higher modes (k &ge; 1):</strong> D<sub>k</sub>(0) = 0,
            D<sub>k</sub>(&eta; &rarr; &infin;) = 0</li>
          <li><strong>Outflow:</strong> Automatic for L &rarr; &infin; when Re(&sigma;<sub>k</sub>) &gt; 0</li>
          <li><strong>Spectral correspondence:</strong> &sigma;<sub>k</sub> = 2&lambda;<sub>k</sub></li>
          <li><strong>Biorthogonality:</strong> &langle;&phi;<sub>j</sub>, D<sub>k</sub>&rangle;<sub>F<sub>0</sub>''</sub> = &delta;<sub>jk</sub> N<sub>k</sub></li>
        </ol>
      </div>
    </div>
  </div>

  <!-- Eigenvalue Charts -->
  <div class="grid-2">
    <div class="card">
      <h2>Eigenvalue Spectrum</h2>
      <div class="chart-container">
        <canvas id="eigenvalueChart"></canvas>
      </div>
    </div>
    <div class="card">
      <h2>Primal--Adjoint Correspondence</h2>
      <div class="chart-container">
        <canvas id="correspondenceChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Boundary Condition Verification -->
  <div class="card" style="margin-bottom: 1.5rem;">
    <h2>Boundary Condition Verification</h2>
    <div class="controls">
      <button class="btn active" id="btnWall" onclick="showBC('wall')">BC1: Wall</button>
      <button class="btn" id="btnFarfield" onclick="showBC('farfield')">BC3: Far-field</button>
      <button class="btn" id="btnOutflow" onclick="showBC('outflow')">BC2: Outflow Decay</button>
    </div>
    <div class="chart-container" style="height: 280px;">
      <canvas id="bcChart"></canvas>
    </div>
    <p id="bcDescription" style="margin-top: 0.75rem; font-size: 0.85rem; color: var(--text-light);">
      Wall condition: D_0(0) = 1.0 (nonzero, absorbs wall source), D_k(0) = 0 for higher modes.
    </p>
  </div>

  <!-- Outflow Decay Interactive -->
  <div class="card" style="margin-bottom: 1.5rem;">
    <h2>Outflow Decay Rates vs. Plate Length</h2>
    <div class="controls">
      <label style="font-size: 0.85rem; display: flex; align-items: center; gap: 0.5rem;">
        Plate length L:
        <input type="range" id="plateLength" min="1" max="3" step="0.01" value="2" style="width: 200px;">
        <span id="plateLengthVal">100</span>
      </label>
    </div>
    <div class="chart-container" style="height: 250px;">
      <canvas id="decayChart"></canvas>
    </div>
  </div>

  <!-- Data Tables -->
  <div class="grid-2">
    <div class="card">
      <h2>Eigenvalue Table</h2>
      <table>
        <thead>
          <tr>
            <th>k</th>
            <th>&sigma;<sub>k</sub></th>
            <th>&lambda;<sub>k</sub> = &sigma;<sub>k</sub>/2</th>
            <th>Type</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>0</td>
            <td>2.0000</td>
            <td>1.0000</td>
            <td><span class="badge badge-warn">Inhomogeneous</span></td>
          </tr>
          <tr>
            <td>1</td>
            <td>0.6474</td>
            <td>0.3237</td>
            <td><span class="badge badge-pass">Homogeneous</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="card">
      <h2>Wall Values D<sub>k</sub>(0)</h2>
      <table>
        <thead>
          <tr>
            <th>k</th>
            <th>D<sub>k</sub>(0)</th>
            <th>Expected</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>0</td>
            <td>1.0000</td>
            <td>nonzero</td>
            <td><span class="badge badge-pass">PASS</span></td>
          </tr>
          <tr>
            <td>1</td>
            <td>0.0000</td>
            <td>= 0</td>
            <td><span class="badge badge-pass">PASS</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Biorthogonality Matrix -->
  <div class="card" style="margin-bottom: 1.5rem;">
    <h2>Biorthogonality Matrix</h2>
    <p style="font-size: 0.85rem; color: var(--text-light); margin-bottom: 0.75rem;">
      B<sub>jk</sub> = inner product of primal and adjoint eigenfunctions weighted by F<sub>0</sub>'' -- should be approximately diagonal.
    </p>
    <div class="chart-container" style="height: 280px;">
      <canvas id="biorthChart"></canvas>
    </div>
  </div>

  <!-- Numerical Parameters and Outflow Decay Table -->
  <div class="grid-2">
    <div class="card">
      <h2>Numerical Parameters</h2>
      <table>
        <tbody>
          <tr><td>Domain</td><td>[0, 15.0]</td></tr>
          <tr><td>Grid points</td><td>4001</td></tr>
          <tr><td>ODE solver</td><td>RK45</td></tr>
          <tr><td>Relative tolerance</td><td>10<sup>-12</sup></td></tr>
          <tr><td>Absolute tolerance</td><td>10<sup>-14</sup></td></tr>
          <tr><td>Eigenvalue scan points</td><td>2000</td></tr>
          <tr><td>Scan range &sigma;</td><td>[0.5, 30.0]</td></tr>
          <tr><td>Root tolerance</td><td>10<sup>-10</sup></td></tr>
        </tbody>
      </table>
    </div>

    <div class="card">
      <h2>Outflow Decay at L = 100</h2>
      <table>
        <thead>
          <tr>
            <th>k</th>
            <th>&sigma;<sub>k</sub></th>
            <th>L<sup>-&sigma;<sub>k</sub>/2</sup></th>
            <th>Assessment</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>0</td>
            <td>2.0000</td>
            <td>0.0100</td>
            <td><span class="badge badge-pass">Strong decay</span></td>
          </tr>
          <tr>
            <td>1</td>
            <td>0.6474</td>
            <td>0.2252</td>
            <td><span class="badge badge-info">Moderate decay</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>

<div class="footer">
  <p>Translation of Adjoint Boundary Conditions into Modal Conditions -- Blasius Boundary Layer</p>
  <p>Reference: Lozano et al., arXiv:2601.16718 (2026) | Open Problem in Fluid Dynamics</p>
</div>

<script>
// Data from experiments
var eigenvalues = [2.0, 0.6474046214493232];
var wallValues = [1.0, 0.0];
var farfieldValues = [3.586304719273971e+77, 1.0];
var decayRatesL100 = [0.01, 0.22521399711760373];
var sigmaOver2 = [1.0, 0.3237023107246616];
var biorthMatrix = [
  [1.1636184782668691e+64, 3.26008486010723e-14],
  [8.969247211850043e+62, 2.512945299509574e-15]
];
var modeLabels = ['k=0', 'k=1'];

// BC description texts
var bcDescriptions = {
  wall: 'Wall condition: D_0(0) = 1.0 (nonzero, absorbs wall source), D_k(0) = 0 for higher modes.',
  farfield: 'Far-field condition: D_k should decay to 0 as eta approaches infinity. Large values for k=0 are a numerical artifact of shooting on a truncated domain.',
  outflow: 'Outflow condition: Each mode decays as L^(-sigma_k/2). For L approaching infinity, all modes with Re(sigma_k) > 0 satisfy the outflow BC automatically.'
};

// Chart defaults
Chart.defaults.font.family = "'Segoe UI', system-ui, sans-serif";
Chart.defaults.font.size = 12;

// Eigenvalue Spectrum Chart
var eigenCtx = document.getElementById('eigenvalueChart').getContext('2d');
new Chart(eigenCtx, {
  type: 'bar',
  data: {
    labels: modeLabels,
    datasets: [{
      label: 'Adjoint eigenvalue',
      data: eigenvalues,
      backgroundColor: ['rgba(41, 128, 185, 0.7)', 'rgba(39, 174, 96, 0.7)'],
      borderColor: ['#2980b9', '#27ae60'],
      borderWidth: 2
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'Adjoint Eigenvalues', font: { size: 14, weight: 'bold' } }
    },
    scales: {
      y: {
        beginAtZero: true,
        title: { display: true, text: 'Eigenvalue' }
      }
    }
  }
});

// Correspondence Chart
var corrCtx = document.getElementById('correspondenceChart').getContext('2d');
new Chart(corrCtx, {
  type: 'bar',
  data: {
    labels: modeLabels,
    datasets: [
      {
        label: 'Adjoint (sigma_k)',
        data: eigenvalues,
        backgroundColor: 'rgba(41, 128, 185, 0.6)',
        borderColor: '#2980b9',
        borderWidth: 2
      },
      {
        label: 'Predicted primal (sigma_k/2)',
        data: sigmaOver2,
        backgroundColor: 'rgba(231, 76, 60, 0.6)',
        borderColor: '#e74c3c',
        borderWidth: 2
      }
    ]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'Primal--Adjoint Correspondence', font: { size: 14, weight: 'bold' } }
    },
    scales: {
      y: { beginAtZero: true, title: { display: true, text: 'Eigenvalue' } }
    }
  }
});

// Boundary Condition Chart
var bcChartInstance = null;

function createBCChart(type) {
  var ctx = document.getElementById('bcChart').getContext('2d');
  if (bcChartInstance) bcChartInstance.destroy();

  var data, label, title, yLabel, colors;

  if (type === 'wall') {
    data = wallValues;
    label = 'D_k(0)';
    title = 'BC1: Wall Values D_k(0)';
    yLabel = 'D_k(0)';
    colors = ['rgba(231, 76, 60, 0.7)', 'rgba(39, 174, 96, 0.7)'];
  } else if (type === 'farfield') {
    data = farfieldValues.map(function(v) { return Math.log10(Math.abs(v) + 1e-300); });
    label = 'log10|D_k(eta_max)|';
    title = 'BC3: Far-field |D_k(eta_max)|';
    yLabel = 'log10|D_k(eta_max)|';
    colors = ['rgba(231, 76, 60, 0.7)', 'rgba(41, 128, 185, 0.7)'];
  } else {
    data = decayRatesL100;
    label = 'L^(-sigma_k/2)';
    title = 'BC2: Outflow Decay at L=100';
    yLabel = 'Decay factor';
    colors = ['rgba(41, 128, 185, 0.7)', 'rgba(39, 174, 96, 0.7)'];
  }

  document.getElementById('bcDescription').textContent = bcDescriptions[type];

  bcChartInstance = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: modeLabels,
      datasets: [{
        label: label,
        data: data,
        backgroundColor: colors,
        borderColor: colors.map(function(c) { return c.replace('0.7', '1'); }),
        borderWidth: 2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        title: { display: true, text: title, font: { size: 14, weight: 'bold' } }
      },
      scales: {
        y: { title: { display: true, text: yLabel } }
      }
    }
  });
}

function showBC(type) {
  document.getElementById('btnWall').classList.remove('active');
  document.getElementById('btnFarfield').classList.remove('active');
  document.getElementById('btnOutflow').classList.remove('active');
  if (type === 'wall') document.getElementById('btnWall').classList.add('active');
  if (type === 'farfield') document.getElementById('btnFarfield').classList.add('active');
  if (type === 'outflow') document.getElementById('btnOutflow').classList.add('active');
  createBCChart(type);
}

createBCChart('wall');

// Outflow Decay Interactive Chart
var decayChartInstance = null;

function updateDecayChart() {
  var logL = parseFloat(document.getElementById('plateLength').value);
  var L = Math.pow(10, logL);
  document.getElementById('plateLengthVal').textContent = L.toFixed(0);

  var ctx = document.getElementById('decayChart').getContext('2d');
  if (decayChartInstance) decayChartInstance.destroy();

  var decays = eigenvalues.map(function(s) { return Math.pow(L, -s / 2); });

  decayChartInstance = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: modeLabels,
      datasets: [{
        label: 'L^(-sigma_k/2)',
        data: decays,
        backgroundColor: ['rgba(41, 128, 185, 0.7)', 'rgba(39, 174, 96, 0.7)'],
        borderColor: ['#2980b9', '#27ae60'],
        borderWidth: 2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        title: {
          display: true,
          text: 'Modal Decay at L = ' + L.toFixed(0),
          font: { size: 14, weight: 'bold' }
        },
        tooltip: {
          callbacks: {
            label: function(ctx) {
              return ctx.dataset.label + ': ' + ctx.parsed.y.toExponential(4);
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          title: { display: true, text: 'Decay factor' }
        }
      }
    }
  });
}

document.getElementById('plateLength').addEventListener('input', updateDecayChart);
updateDecayChart();

// Biorthogonality Heatmap (using bar chart of log magnitudes)
var biorthCtx = document.getElementById('biorthChart').getContext('2d');
var logBiorth = [];
var biorthLabels = [];
var biorthColors = [];

for (var j = 0; j < 2; j++) {
  for (var k = 0; k < 2; k++) {
    biorthLabels.push('B[' + j + ',' + k + ']');
    logBiorth.push(Math.log10(Math.abs(biorthMatrix[j][k]) + 1e-300));
    biorthColors.push(j === k ? 'rgba(41, 128, 185, 0.7)' : 'rgba(231, 76, 60, 0.7)');
  }
}

new Chart(biorthCtx, {
  type: 'bar',
  data: {
    labels: biorthLabels,
    datasets: [{
      label: 'log10|B[j,k]|',
      data: logBiorth,
      backgroundColor: biorthColors,
      borderColor: biorthColors.map(function(c) { return c.replace('0.7', '1'); }),
      borderWidth: 2
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'Biorthogonality Matrix (log scale)', font: { size: 14, weight: 'bold' } },
      legend: { display: true, labels: { generateLabels: function() {
        return [
          { text: 'Diagonal (j=k)', fillStyle: 'rgba(41, 128, 185, 0.7)', strokeStyle: '#2980b9' },
          { text: 'Off-diagonal (j!=k)', fillStyle: 'rgba(231, 76, 60, 0.7)', strokeStyle: '#e74c3c' }
        ];
      }}}
    },
    scales: {
      y: {
        title: { display: true, text: 'log10|B[j,k]|' }
      }
    }
  }
});
</script>

</body>
</html>
