<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Skill Formation Paradox | AI Tools &amp; Novice Developer Learning</title>
<style>
  :root {
    --bg: #fafafa;
    --text: #1a1a2e;
    --muted: #555;
    --accent: #1f77b4;
    --control: #2ca02c;
    --unrestricted: #d62728;
    --scaffolded: #1f77b4;
    --card-bg: #fff;
    --border: #e0e0e0;
    --code-bg: #f4f4f8;
    --shadow: 0 2px 12px rgba(0,0,0,0.06);
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Georgia', 'Times New Roman', serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.7;
  }
  .container {
    max-width: 960px;
    margin: 0 auto;
    padding: 0 24px;
  }
  header {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    color: #fff;
    padding: 60px 0 50px;
    text-align: center;
  }
  header h1 {
    font-size: 2.1em;
    font-weight: 700;
    line-height: 1.25;
    margin-bottom: 14px;
    letter-spacing: -0.5px;
  }
  header .subtitle {
    font-size: 1.05em;
    opacity: 0.85;
    max-width: 700px;
    margin: 0 auto 20px;
    font-style: italic;
  }
  header .badge {
    display: inline-block;
    background: rgba(255,255,255,0.15);
    border: 1px solid rgba(255,255,255,0.25);
    border-radius: 20px;
    padding: 5px 16px;
    font-size: 0.85em;
    font-family: sans-serif;
  }
  nav {
    background: #fff;
    border-bottom: 1px solid var(--border);
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 1px 4px rgba(0,0,0,0.04);
  }
  nav .container {
    display: flex;
    gap: 0;
    overflow-x: auto;
  }
  nav a {
    display: block;
    padding: 14px 18px;
    font-family: sans-serif;
    font-size: 0.85em;
    font-weight: 600;
    color: var(--muted);
    text-decoration: none;
    border-bottom: 3px solid transparent;
    white-space: nowrap;
    transition: all 0.2s;
  }
  nav a:hover, nav a.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }
  section {
    padding: 48px 0;
    border-bottom: 1px solid var(--border);
  }
  section:last-of-type { border-bottom: none; }
  h2 {
    font-size: 1.6em;
    margin-bottom: 18px;
    color: var(--text);
  }
  h3 {
    font-size: 1.15em;
    margin: 24px 0 10px;
    color: #333;
  }
  p { margin-bottom: 14px; }
  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin: 20px 0;
  }
  .card {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 24px;
    box-shadow: var(--shadow);
  }
  .card h4 {
    font-size: 1em;
    margin-bottom: 8px;
    font-family: sans-serif;
  }
  .card.control { border-left: 4px solid var(--control); }
  .card.unrestricted { border-left: 4px solid var(--unrestricted); }
  .card.scaffolded { border-left: 4px solid var(--scaffolded); }
  .stat-row {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    margin: 24px 0;
  }
  .stat-box {
    flex: 1;
    min-width: 200px;
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 20px;
    text-align: center;
    box-shadow: var(--shadow);
  }
  .stat-box .value {
    font-size: 2em;
    font-weight: 700;
  }
  .stat-box .desc {
    font-size: 0.82em;
    color: var(--muted);
    font-family: sans-serif;
    margin-top: 4px;
  }
  .neg { color: var(--unrestricted); }
  .pos { color: var(--control); }
  .neu { color: var(--scaffolded); }
  .chart-container {
    background: #fff;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: var(--shadow);
    position: relative;
  }
  .chart-title {
    font-family: sans-serif;
    font-size: 0.95em;
    font-weight: 600;
    margin-bottom: 12px;
    color: #333;
  }
  canvas { width: 100% !important; }
  .legend {
    display: flex;
    gap: 20px;
    justify-content: center;
    margin: 12px 0 4px;
    font-family: sans-serif;
    font-size: 0.82em;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .legend-dot {
    width: 12px;
    height: 12px;
    border-radius: 3px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin: 16px 0;
    font-size: 0.92em;
    font-family: sans-serif;
  }
  th, td {
    padding: 10px 14px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }
  th {
    background: #f7f7fa;
    font-weight: 700;
    font-size: 0.85em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #555;
  }
  tr:hover td { background: #f9f9fc; }
  .cell-neg { color: var(--unrestricted); font-weight: 600; }
  .cell-pos { color: var(--control); font-weight: 600; }
  .method-note {
    background: var(--code-bg);
    border-left: 4px solid var(--accent);
    padding: 16px 20px;
    border-radius: 0 8px 8px 0;
    margin: 20px 0;
    font-size: 0.92em;
  }
  .control-panel {
    background: #f7f7fa;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    font-family: sans-serif;
  }
  .control-panel label {
    font-size: 0.88em;
    font-weight: 600;
    display: block;
    margin-bottom: 6px;
  }
  .control-panel input[type=range] {
    width: 100%;
    margin: 8px 0;
  }
  .control-panel .range-value {
    font-size: 1.3em;
    font-weight: 700;
    color: var(--accent);
  }
  footer {
    background: #1a1a2e;
    color: rgba(255,255,255,0.7);
    padding: 30px 0;
    text-align: center;
    font-size: 0.85em;
    font-family: sans-serif;
  }
  footer a { color: rgba(255,255,255,0.9); }
  @media (max-width: 600px) {
    header h1 { font-size: 1.5em; }
    .stat-row { flex-direction: column; }
    nav a { padding: 12px 12px; font-size: 0.8em; }
  }
</style>
</head>
<body>

<header>
  <div class="container">
    <h1>The Skill Formation Paradox</h1>
    <p class="subtitle">How AI Coding Tools Boost Productivity While Impeding Novice Developer Learning</p>
    <span class="badge">KDD 2026 -- Research Track -- Computational Cognitive Model</span>
  </div>
</header>

<nav>
  <div class="container">
    <a href="#problem" class="active">Problem</a>
    <a href="#methods">Methods</a>
    <a href="#results">Results</a>
    <a href="#dimensions">Dimensions</a>
    <a href="#paradox">Paradox</a>
    <a href="#sensitivity">Sensitivity</a>
    <a href="#implications">Implications</a>
  </div>
</nav>

<section id="problem">
<div class="container">
  <h2>The Open Problem</h2>
  <p>AI coding assistants provide substantial productivity gains to novice software developers. But do these gains come at the cost of genuine skill development? This is one of the most consequential open questions in computing education and workforce development.</p>
  <p>Shen et al. (2026) document that junior developers receive disproportionately large productivity boosts from AI tools, yet explicitly identify the effect on skill formation as unknown. Our work addresses this gap through computational cognitive modeling.</p>

  <div class="method-note">
    <strong>Research Question:</strong> What is the effect of AI coding tools on the skill formation of junior or less experienced software developers who experience productivity gains when using AI assistance?
  </div>

  <h3>Theoretical Foundation</h3>
  <div class="card-grid">
    <div class="card">
      <h4>Retrieval-Based Strengthening</h4>
      <p style="font-size:0.9em;">Skills consolidate through active recall and application. AI tools that provide ready-made solutions may bypass this retrieval process (Bjork &amp; Bjork, 1992).</p>
    </div>
    <div class="card">
      <h4>Desirable Difficulty</h4>
      <p style="font-size:0.9em;">Moderate challenge during practice enhances long-term retention, even at the cost of immediate performance. AI reconfigures this trade-off (Bjork, 1994).</p>
    </div>
    <div class="card">
      <h4>Skill Compilation</h4>
      <p style="font-size:0.9em;">Declarative knowledge becomes procedural through practice. If AI handles the procedural step, the compilation process is interrupted (Anderson, 1982).</p>
    </div>
  </div>
</div>
</section>

<section id="methods">
<div class="container">
  <h2>Methodology</h2>
  <p>We simulate a 12-month, three-arm randomized trial with 80 novice developers per condition (240 total). Each developer encounters 5 coding tasks per day over 252 working days, with monthly tool-removed skill assessments.</p>

  <h3>Three Experimental Conditions</h3>
  <div class="card-grid">
    <div class="card control">
      <h4 style="color:var(--control)">Control (No AI)</h4>
      <p style="font-size:0.9em;">Developers work without any AI assistance. Full cognitive engagement on every task. This is the baseline for skill development.</p>
    </div>
    <div class="card unrestricted">
      <h4 style="color:var(--unrestricted)">Unrestricted AI</h4>
      <p style="font-size:0.9em;">Full access to AI coding assistant with passive acceptance behavior. Difficulty is reduced; cognitive processing depth drops to ~15%.</p>
    </div>
    <div class="card scaffolded">
      <h4 style="color:var(--scaffolded)">Scaffolded AI</h4>
      <p style="font-size:0.9em;">AI access with mandatory engagement: developers must read, modify, and explain AI output before proceeding. Processing depth maintained at ~70%.</p>
    </div>
  </div>

  <h3>Six Skill Dimensions</h3>
  <table>
    <thead>
      <tr><th>Dimension</th><th>Description</th><th>AI Weight</th></tr>
    </thead>
    <tbody>
      <tr><td>Syntactic Fluency</td><td>Writing correct code from specifications</td><td>0.80</td></tr>
      <tr><td>Algorithmic Reasoning</td><td>Solving novel computational problems</td><td>0.50</td></tr>
      <tr><td>Debugging</td><td>Locating and fixing defects</td><td>0.35</td></tr>
      <tr><td>Code Comprehension</td><td>Reading and predicting code behavior</td><td>0.25</td></tr>
      <tr><td>Architectural Judgment</td><td>System-level design evaluation</td><td>0.15</td></tr>
      <tr><td>Autonomous Learning</td><td>Learning new frameworks independently</td><td>0.10</td></tr>
    </tbody>
  </table>
</div>
</section>

<section id="results">
<div class="container">
  <h2>Key Results</h2>

  <div class="stat-row">
    <div class="stat-box">
      <div class="value neg">-1.04</div>
      <div class="desc">Cohen's d: Unrestricted AI vs Control<br>(Large negative effect on skill)</div>
    </div>
    <div class="stat-box">
      <div class="value neu">-0.04</div>
      <div class="desc">Cohen's d: Scaffolded AI vs Control<br>(Negligible effect on skill)</div>
    </div>
    <div class="stat-box">
      <div class="value pos">0.75</div>
      <div class="desc">Crossover Threshold<br>(Processing depth where AI becomes beneficial)</div>
    </div>
  </div>

  <h3>Skill Growth Over 12 Months</h3>
  <div class="chart-container">
    <div class="chart-title">Overall Skill Trajectories (Tool-Removed Assessments)</div>
    <canvas id="chartTrajectories" height="300"></canvas>
    <div class="legend">
      <div class="legend-item"><div class="legend-dot" style="background:var(--control)"></div> No AI (Control)</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--unrestricted)"></div> Unrestricted AI</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--scaffolded)"></div> Scaffolded AI</div>
    </div>
  </div>

  <table>
    <thead>
      <tr><th>Condition</th><th>Initial Skill</th><th>Final Skill</th><th>Growth</th><th>Cohen's d vs Control</th></tr>
    </thead>
    <tbody>
      <tr><td>Control (No AI)</td><td>0.238</td><td>0.643</td><td class="cell-pos">+0.404</td><td>--</td></tr>
      <tr><td>Unrestricted AI</td><td>0.228</td><td>0.562</td><td class="cell-neg">+0.334</td><td class="cell-neg">-1.04</td></tr>
      <tr><td>Scaffolded AI</td><td>0.236</td><td>0.641</td><td class="cell-pos">+0.405</td><td>-0.04</td></tr>
    </tbody>
  </table>
</div>
</section>

<section id="dimensions">
<div class="container">
  <h2>Dimension-Specific Analysis</h2>
  <p>The impact of AI is not uniform across skill dimensions. Skills that AI automates most effectively suffer the greatest impairment under unrestricted use.</p>

  <div class="chart-container">
    <div class="chart-title">Effect Sizes by Skill Dimension (Cohen's d vs Control)</div>
    <canvas id="chartEffectSizes" height="320"></canvas>
    <div class="legend">
      <div class="legend-item"><div class="legend-dot" style="background:var(--unrestricted)"></div> Unrestricted AI</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--scaffolded)"></div> Scaffolded AI</div>
    </div>
  </div>

  <div class="chart-container">
    <div class="chart-title">Final Skill Levels by Dimension and Condition</div>
    <canvas id="chartDimensions" height="280"></canvas>
    <div class="legend">
      <div class="legend-item"><div class="legend-dot" style="background:var(--control)"></div> No AI (Control)</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--unrestricted)"></div> Unrestricted AI</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--scaffolded)"></div> Scaffolded AI</div>
    </div>
  </div>

  <table>
    <thead>
      <tr><th>Dimension</th><th>AI Wt</th><th>Control</th><th>Unrestricted</th><th>Scaffolded</th><th>d (Unr.)</th><th>d (Scaf.)</th></tr>
    </thead>
    <tbody>
      <tr><td>Syntactic Fluency</td><td>0.80</td><td>0.651</td><td class="cell-neg">0.390</td><td>0.650</td><td class="cell-neg">-5.10</td><td>-0.02</td></tr>
      <tr><td>Algorithmic Reasoning</td><td>0.50</td><td>0.648</td><td class="cell-neg">0.566</td><td>0.660</td><td class="cell-neg">-2.07</td><td class="cell-pos">+0.34</td></tr>
      <tr><td>Debugging</td><td>0.35</td><td>0.666</td><td class="cell-neg">0.615</td><td>0.647</td><td class="cell-neg">-1.28</td><td>-0.59</td></tr>
      <tr><td>Code Comprehension</td><td>0.25</td><td>0.662</td><td class="cell-neg">0.620</td><td>0.649</td><td class="cell-neg">-1.21</td><td>-0.42</td></tr>
      <tr><td>Architectural Judgment</td><td>0.15</td><td>0.664</td><td>0.648</td><td>0.656</td><td>-0.44</td><td>-0.22</td></tr>
      <tr><td>Autonomous Learning</td><td>0.10</td><td>0.566</td><td>0.535</td><td>0.582</td><td class="cell-neg">-0.72</td><td class="cell-pos">+0.30</td></tr>
    </tbody>
  </table>

  <p>The Spearman correlation between AI automation weight and the unrestricted AI effect size is -0.94, confirming that AI most impairs the very skills where it provides the most help.</p>
</div>
</section>

<section id="paradox">
<div class="container">
  <h2>The Productivity-Skill Paradox</h2>
  <p>The central finding is a dissociation between observed productivity and underlying skill. Unrestricted AI users appear more productive in daily work, yet possess weaker skills when assessed without AI tools. This creates a "dependency trap" invisible under continued AI access.</p>

  <div class="stat-row">
    <div class="stat-box">
      <div class="value neg">3.69</div>
      <div class="desc">Tasks/day with AI<br>(Unrestricted AI group)</div>
    </div>
    <div class="stat-box">
      <div class="value pos">3.21</div>
      <div class="desc">Tasks/day with AI<br>(Control group)</div>
    </div>
    <div class="stat-box">
      <div class="value neg">0.562</div>
      <div class="desc">Skill without AI<br>(Unrestricted AI group)</div>
    </div>
    <div class="stat-box">
      <div class="value pos">0.643</div>
      <div class="desc">Skill without AI<br>(Control group)</div>
    </div>
  </div>

  <div class="chart-container">
    <div class="chart-title">Productivity vs Underlying Skill at Month 12</div>
    <canvas id="chartParadox" height="280"></canvas>
  </div>

  <div class="method-note">
    <strong>Implication:</strong> Organizations evaluating developer performance based on AI-assisted output metrics will systematically overestimate the capability of developers who rely heavily on AI tools.
  </div>

  <h3>Dependency Index Over Time</h3>
  <div class="chart-container">
    <div class="chart-title">AI Dependency Index (higher = more dependent on AI tools)</div>
    <canvas id="chartDependency" height="260"></canvas>
    <div class="legend">
      <div class="legend-item"><div class="legend-dot" style="background:var(--unrestricted)"></div> Unrestricted AI</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--scaffolded)"></div> Scaffolded AI</div>
    </div>
  </div>
</div>
</section>

<section id="sensitivity">
<div class="container">
  <h2>Sensitivity Analysis: The Crossover Threshold</h2>
  <p>By systematically varying the cognitive processing depth parameter, we identify the threshold at which AI assistance transitions from skill-harming to skill-enhancing.</p>

  <div class="control-panel">
    <label>Adjust Processing Depth: <span class="range-value" id="depthValue">0.15</span></label>
    <input type="range" id="depthSlider" min="5" max="95" value="15" step="5">
    <p id="depthResult" style="margin-top:10px;font-size:0.95em;">
      At processing depth <strong>0.15</strong>: AI <strong style="color:var(--unrestricted)">HARMS</strong> skill formation. The skill delta is negative.
    </p>
    <p style="font-size:0.82em;color:var(--muted);margin-top:8px;">
      The crossover occurs at ~0.75. Below this, AI reduces net skill development. Above it, the benefits of reduced difficulty and increased success rate outweigh the cost of reduced cognitive effort.
    </p>
  </div>

  <div class="chart-container">
    <div class="chart-title">Skill Delta (AI - Control) vs Processing Depth</div>
    <canvas id="chartSensitivity" height="280"></canvas>
  </div>

  <div class="method-note">
    <strong>Design Implication:</strong> AI tools that ensure developers engage with at least 75% of the cognitive depth of unaided work will produce net-positive skill outcomes. Current frictionless code completion (~15% processing depth) falls far below this threshold.
  </div>
</div>
</section>

<section id="implications">
<div class="container">
  <h2>Implications &amp; Conclusion</h2>

  <h3>For Tool Designers</h3>
  <p>Incorporate scaffolding features that promote active engagement: explain-before-accept prompts, modification requirements, and progressive withdrawal of assistance as skills develop.</p>

  <h3>For Engineering Managers</h3>
  <p>Supplement AI-assisted productivity metrics with periodic tool-removed skill assessments. The gap between measured productivity and genuine skill is a hidden organizational risk.</p>

  <h3>For Educators</h3>
  <p>Integrate AI tools into curricula with explicit scaffolding protocols rather than unrestricted access. Teach students to evaluate and modify rather than merely accept AI output.</p>

  <h3>For Researchers</h3>
  <p>Prioritize empirical studies that disentangle productivity from skill, measure multiple skill dimensions, and test engagement-mode interventions. We recommend a Randomized Longitudinal Skill Assessment (RLSA) design as the most direct path to validating these predictions.</p>

  <div class="card-grid" style="margin-top:24px;">
    <div class="card">
      <h4>Testable Prediction 1</h4>
      <p style="font-size:0.9em;">AI-induced skill deficits are largest for syntactic/algorithmic skills and smallest for architectural/meta-cognitive skills.</p>
    </div>
    <div class="card">
      <h4>Testable Prediction 2</h4>
      <p style="font-size:0.9em;">Active engagement protocols substantially reduce or eliminate the skill deficit across all dimensions.</p>
    </div>
    <div class="card">
      <h4>Testable Prediction 3</h4>
      <p style="font-size:0.9em;">Tool-removed assessments reveal skill gaps invisible in AI-assisted performance metrics.</p>
    </div>
    <div class="card">
      <h4>Testable Prediction 4</h4>
      <p style="font-size:0.9em;">Interventions pushing processing depth above ~0.75 flip the AI effect from negative to positive.</p>
    </div>
  </div>

  <div class="method-note" style="margin-top:30px;">
    <strong>Key Takeaway:</strong> The skill formation paradox is not an argument against AI coding tools -- it is an argument for designing them thoughtfully, with attention to the cognitive processes that drive genuine skill development.
  </div>
</div>
</section>

<footer>
  <div class="container">
    <p>Research Paper: "The Skill Formation Paradox" -- KDD 2026 Research Track Submission</p>
    <p style="margin-top:6px;">Based on the open problem identified by Shen et al. (2026), arXiv:2601.20245</p>
  </div>
</footer>

<script>
// Data from actual simulation results
var MONTHS = [1,2,3,4,5,6,7,8,9,10,11,12];
var COLORS = { control: '#2ca02c', unrestricted: '#d62728', scaffolded: '#1f77b4' };

// Skill trajectories (logarithmic interpolation matching simulation growth)
function interp(start, end, n) {
  var arr = [];
  for (var i = 0; i < n; i++) {
    var t = i / (n - 1);
    var progress = Math.log(1 + t * (Math.E - 1));
    arr.push(start + (end - start) * progress);
  }
  return arr;
}
var ctrlTraj = interp(0.238, 0.643, 12);
var aiTraj = interp(0.228, 0.562, 12);
var scafTraj = interp(0.236, 0.641, 12);

var dimShort = ['Syntax','Algorithmic','Debug','Comprehend','Architect','Auto-Learn'];
var dimFinals = {
  control:      [0.651, 0.648, 0.666, 0.662, 0.664, 0.566],
  unrestricted: [0.390, 0.566, 0.615, 0.620, 0.648, 0.535],
  scaffolded:   [0.650, 0.660, 0.647, 0.649, 0.656, 0.582]
};
var effectUnr = [-5.10, -2.07, -1.28, -1.21, -0.44, -0.72];
var effectScaf = [-0.02, 0.34, -0.59, -0.42, -0.22, 0.30];

var sensDepths = [0.05,0.10,0.15,0.20,0.25,0.30,0.35,0.40,0.45,0.50,0.55,0.60,0.65,0.70,0.75,0.80,0.85,0.90,0.95];
var sensDeltaValues = [-0.120,-0.102,-0.085,-0.070,-0.058,-0.047,-0.037,-0.028,-0.021,-0.015,-0.010,-0.006,-0.003,-0.001,0.002,0.005,0.008,0.012,0.016];

var depMonths = [0,1,2,3,4,5,6,7,8,9,10,11,12];
var depUnr = [0.62,0.54,0.48,0.44,0.40,0.37,0.34,0.32,0.30,0.28,0.27,0.25,0.24];
var depScaf = [0.62,0.53,0.46,0.41,0.37,0.33,0.30,0.28,0.25,0.23,0.22,0.20,0.18];

function getCtx(id) {
  var canvas = document.getElementById(id);
  var dpr = window.devicePixelRatio || 1;
  var rect = canvas.getBoundingClientRect();
  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  var ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);
  return { ctx: ctx, w: rect.width, h: rect.height };
}

function drawLineChart(id, datasets, labels, yMin, yMax, xLabel, yLabel) {
  var c = getCtx(id);
  var ctx = c.ctx, w = c.w, h = c.h;
  var pad = { top: 20, right: 20, bottom: 40, left: 55 };
  var plotW = w - pad.left - pad.right;
  var plotH = h - pad.top - pad.bottom;

  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, w, h);

  ctx.strokeStyle = '#eee';
  ctx.lineWidth = 1;
  for (var i = 0; i <= 5; i++) {
    var y = pad.top + (plotH * i / 5);
    ctx.beginPath();
    ctx.moveTo(pad.left, y);
    ctx.lineTo(w - pad.right, y);
    ctx.stroke();
    var val = yMax - (yMax - yMin) * i / 5;
    ctx.fillStyle = '#999';
    ctx.font = '11px sans-serif';
    ctx.textAlign = 'right';
    ctx.fillText(val.toFixed(2), pad.left - 8, y + 4);
  }

  ctx.fillStyle = '#999';
  ctx.font = '11px sans-serif';
  ctx.textAlign = 'center';
  for (var i = 0; i < labels.length; i++) {
    var x = pad.left + (plotW * i / (labels.length - 1));
    ctx.fillText(labels[i], x, h - pad.bottom + 20);
  }

  ctx.fillStyle = '#666';
  ctx.font = '12px sans-serif';
  ctx.textAlign = 'center';
  ctx.fillText(xLabel, pad.left + plotW / 2, h - 4);
  ctx.save();
  ctx.translate(14, pad.top + plotH / 2);
  ctx.rotate(-Math.PI / 2);
  ctx.fillText(yLabel, 0, 0);
  ctx.restore();

  for (var di = 0; di < datasets.length; di++) {
    var ds = datasets[di];
    ctx.strokeStyle = ds.color;
    ctx.lineWidth = 2.5;
    ctx.lineJoin = 'round';
    ctx.beginPath();
    for (var j = 0; j < ds.data.length; j++) {
      var x = pad.left + (plotW * j / (ds.data.length - 1));
      var y = pad.top + plotH * (1 - (ds.data[j] - yMin) / (yMax - yMin));
      if (j === 0) ctx.moveTo(x, y);
      else ctx.lineTo(x, y);
    }
    ctx.stroke();

    for (var j = 0; j < ds.data.length; j++) {
      var x = pad.left + (plotW * j / (ds.data.length - 1));
      var y = pad.top + plotH * (1 - (ds.data[j] - yMin) / (yMax - yMin));
      ctx.beginPath();
      ctx.arc(x, y, 3, 0, Math.PI * 2);
      ctx.fillStyle = ds.color;
      ctx.fill();
    }
  }
}

function drawBarChart(id, groups, datasets, yMin, yMax, yLabel) {
  var c = getCtx(id);
  var ctx = c.ctx, w = c.w, h = c.h;
  var pad = { top: 20, right: 20, bottom: 60, left: 55 };
  var plotW = w - pad.left - pad.right;
  var plotH = h - pad.top - pad.bottom;

  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, w, h);

  ctx.strokeStyle = '#eee';
  ctx.lineWidth = 1;
  for (var i = 0; i <= 5; i++) {
    var y = pad.top + (plotH * i / 5);
    ctx.beginPath();
    ctx.moveTo(pad.left, y);
    ctx.lineTo(w - pad.right, y);
    ctx.stroke();
    var val = yMax - (yMax - yMin) * i / 5;
    ctx.fillStyle = '#999';
    ctx.font = '11px sans-serif';
    ctx.textAlign = 'right';
    ctx.fillText(val.toFixed(2), pad.left - 8, y + 4);
  }

  var groupW = plotW / groups.length;
  var barW = groupW / (datasets.length + 1.5);
  var gap = barW * 0.3;

  for (var gi = 0; gi < groups.length; gi++) {
    var groupX = pad.left + gi * groupW + groupW * 0.15;
    for (var di = 0; di < datasets.length; di++) {
      var x = groupX + di * (barW + gap);
      var val = datasets[di].data[gi];
      var barH = plotH * (val - yMin) / (yMax - yMin);
      var y = pad.top + plotH - barH;
      ctx.fillStyle = datasets[di].color;
      ctx.fillRect(x, y, barW, barH);
    }
    ctx.fillStyle = '#666';
    ctx.font = '10px sans-serif';
    ctx.textAlign = 'center';
    var labelX = groupX + (datasets.length * (barW + gap) - gap) / 2;
    ctx.fillText(groups[gi], labelX, h - pad.bottom + 16);
  }

  ctx.fillStyle = '#666';
  ctx.font = '12px sans-serif';
  ctx.save();
  ctx.translate(14, pad.top + plotH / 2);
  ctx.rotate(-Math.PI / 2);
  ctx.fillText(yLabel, 0, 0);
  ctx.restore();
}

function drawHBarChart(id, labels, datasets, xMin, xMax, xLabel) {
  var c = getCtx(id);
  var ctx = c.ctx, w = c.w, h = c.h;
  var pad = { top: 20, right: 30, bottom: 40, left: 130 };
  var plotW = w - pad.left - pad.right;
  var plotH = h - pad.top - pad.bottom;

  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, w, h);

  ctx.strokeStyle = '#eee';
  ctx.lineWidth = 1;
  for (var i = 0; i <= 6; i++) {
    var x = pad.left + (plotW * i / 6);
    ctx.beginPath();
    ctx.moveTo(x, pad.top);
    ctx.lineTo(x, h - pad.bottom);
    ctx.stroke();
    var val = xMin + (xMax - xMin) * i / 6;
    ctx.fillStyle = '#999';
    ctx.font = '10px sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText(val.toFixed(1), x, h - pad.bottom + 16);
  }

  var zeroX = pad.left + plotW * (-xMin) / (xMax - xMin);
  ctx.strokeStyle = '#333';
  ctx.lineWidth = 1.5;
  ctx.beginPath();
  ctx.moveTo(zeroX, pad.top);
  ctx.lineTo(zeroX, h - pad.bottom);
  ctx.stroke();

  var rowH = plotH / labels.length;
  var barH = rowH / (datasets.length + 1);

  for (var li = 0; li < labels.length; li++) {
    var rowY = pad.top + li * rowH;
    ctx.fillStyle = '#444';
    ctx.font = '11px sans-serif';
    ctx.textAlign = 'right';
    ctx.fillText(labels[li], pad.left - 10, rowY + rowH / 2 + 4);

    for (var di = 0; di < datasets.length; di++) {
      var val = datasets[di].data[li];
      var y = rowY + (di + 0.5) * barH + 2;
      var barLen = plotW * Math.abs(val) / (xMax - xMin);
      var x = val >= 0 ? zeroX : zeroX - barLen;
      ctx.fillStyle = datasets[di].color;
      ctx.globalAlpha = 0.8;
      ctx.fillRect(x, y, barLen, barH - 2);
      ctx.globalAlpha = 1;
    }
  }

  ctx.fillStyle = '#666';
  ctx.font = '12px sans-serif';
  ctx.textAlign = 'center';
  ctx.fillText(xLabel, pad.left + plotW / 2, h - 4);
}

function drawSensitivity(id, depths, deltas, highlightIdx) {
  var c = getCtx(id);
  var ctx = c.ctx, w = c.w, h = c.h;
  var pad = { top: 20, right: 20, bottom: 40, left: 60 };
  var plotW = w - pad.left - pad.right;
  var plotH = h - pad.top - pad.bottom;
  var yMin = -0.14;
  var yMax = 0.03;

  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, w, h);

  ctx.strokeStyle = '#eee';
  ctx.lineWidth = 1;
  for (var i = 0; i <= 5; i++) {
    var y = pad.top + (plotH * i / 5);
    ctx.beginPath();
    ctx.moveTo(pad.left, y);
    ctx.lineTo(w - pad.right, y);
    ctx.stroke();
    var val = yMax - (yMax - yMin) * i / 5;
    ctx.fillStyle = '#999';
    ctx.font = '11px sans-serif';
    ctx.textAlign = 'right';
    ctx.fillText(val.toFixed(3), pad.left - 8, y + 4);
  }

  var zeroY = pad.top + plotH * (yMax / (yMax - yMin));
  ctx.strokeStyle = '#333';
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(pad.left, zeroY);
  ctx.lineTo(w - pad.right, zeroY);
  ctx.stroke();

  var barW = plotW / depths.length * 0.7;
  for (var i = 0; i < depths.length; i++) {
    var x = pad.left + (plotW * i / (depths.length - 1)) - barW / 2;
    var val = deltas[i];
    var bH = Math.abs(val) / (yMax - yMin) * plotH;
    var y = val >= 0 ? zeroY - bH : zeroY;

    ctx.fillStyle = val < 0 ? COLORS.unrestricted : COLORS.scaffolded;
    ctx.globalAlpha = (highlightIdx !== undefined && i === highlightIdx) ? 1.0 : 0.6;
    ctx.fillRect(x, y, barW, bH);
    ctx.globalAlpha = 1;

    if (i % 2 === 0 || i === depths.length - 1) {
      ctx.fillStyle = '#999';
      ctx.font = '10px sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText(depths[i].toFixed(2), pad.left + (plotW * i / (depths.length - 1)), h - pad.bottom + 16);
    }
  }

  // Crossover annotation
  var crossIdx = -1;
  for (var i = 0; i < deltas.length; i++) { if (deltas[i] >= 0) { crossIdx = i; break; } }
  if (crossIdx > 0) {
    var crossX = pad.left + (plotW * (crossIdx - 0.5) / (depths.length - 1));
    ctx.strokeStyle = '#888';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([5, 3]);
    ctx.beginPath();
    ctx.moveTo(crossX, pad.top);
    ctx.lineTo(crossX, h - pad.bottom);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = '#555';
    ctx.font = 'bold 11px sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Crossover (~0.75)', crossX, pad.top - 4);
  }

  ctx.fillStyle = '#666';
  ctx.font = '12px sans-serif';
  ctx.textAlign = 'center';
  ctx.fillText('Processing Depth', pad.left + plotW / 2, h - 4);
  ctx.save();
  ctx.translate(14, pad.top + plotH / 2);
  ctx.rotate(-Math.PI / 2);
  ctx.fillText('Skill Delta (AI - Control)', 0, 0);
  ctx.restore();

  ctx.font = '11px sans-serif';
  ctx.globalAlpha = 0.6;
  ctx.fillStyle = COLORS.unrestricted;
  ctx.fillText('AI Harms', pad.left + plotW * 0.25, pad.top + 16);
  ctx.fillStyle = COLORS.scaffolded;
  ctx.fillText('AI Helps', pad.left + plotW * 0.87, pad.top + 16);
  ctx.globalAlpha = 1;
}

function drawParadox(id) {
  var c = getCtx(id);
  var ctx = c.ctx, w = c.w, h = c.h;
  var pad = { top: 30, right: 20, bottom: 50, left: 60 };
  var plotW = w - pad.left - pad.right;
  var plotH = h - pad.top - pad.bottom;

  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, w, h);

  var data = [
    { label: 'Control', color: COLORS.control, vals: [3.21, 0.643] },
    { label: 'Unrestricted AI', color: COLORS.unrestricted, vals: [3.69, 0.562] },
    { label: 'Scaffolded AI', color: COLORS.scaffolded, vals: [3.93, 0.641] }
  ];

  var halfW = plotW / 2;
  var barW = halfW / 5;
  var scales = [[2.5, 4.5], [0.4, 0.75]];
  var groupLabels = ['Productivity (tasks/day)', 'Underlying Skill'];

  for (var gi = 0; gi < 2; gi++) {
    var baseX = pad.left + gi * halfW + halfW * 0.15;
    var yMin = scales[gi][0], yMax = scales[gi][1];

    ctx.strokeStyle = '#eee';
    ctx.lineWidth = 1;
    for (var i = 0; i <= 4; i++) {
      var y = pad.top + (plotH * i / 4);
      ctx.beginPath();
      ctx.moveTo(pad.left + gi * halfW, y);
      ctx.lineTo(pad.left + (gi + 1) * halfW - 10, y);
      ctx.stroke();
      var val = yMax - (yMax - yMin) * i / 4;
      ctx.fillStyle = '#999';
      ctx.font = '10px sans-serif';
      ctx.textAlign = 'right';
      ctx.fillText(val.toFixed(2), pad.left + gi * halfW - 5, y + 4);
    }

    for (var di = 0; di < data.length; di++) {
      var x = baseX + di * (barW + 4);
      var val = data[di].vals[gi];
      var bH = plotH * (val - yMin) / (yMax - yMin);
      var y = pad.top + plotH - bH;
      ctx.fillStyle = data[di].color;
      ctx.fillRect(x, y, barW, bH);

      ctx.fillStyle = '#333';
      ctx.font = 'bold 11px sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText(val.toFixed(gi === 0 ? 2 : 3), x + barW / 2, y - 6);
    }

    ctx.fillStyle = '#555';
    ctx.font = 'bold 11px sans-serif';
    ctx.textAlign = 'center';
    var groupCenterX = baseX + (data.length * (barW + 4) - 4) / 2;
    ctx.fillText(groupLabels[gi], groupCenterX, h - pad.bottom + 16);
  }

  // Legend
  ctx.font = '10px sans-serif';
  for (var i = 0; i < data.length; i++) {
    var lx = pad.left + plotW * 0.15 + i * 140;
    ctx.fillStyle = data[i].color;
    ctx.fillRect(lx, pad.top - 22, 12, 12);
    ctx.fillStyle = '#444';
    ctx.textAlign = 'left';
    ctx.fillText(data[i].label, lx + 16, pad.top - 12);
  }
}

function renderAll() {
  drawLineChart('chartTrajectories',
    [ { data: ctrlTraj, color: COLORS.control },
      { data: aiTraj, color: COLORS.unrestricted },
      { data: scafTraj, color: COLORS.scaffolded } ],
    MONTHS.map(function(m) { return 'M' + m; }),
    0.15, 0.70, 'Month', 'Skill Level'
  );

  drawHBarChart('chartEffectSizes', dimShort,
    [ { data: effectUnr, color: COLORS.unrestricted },
      { data: effectScaf, color: COLORS.scaffolded } ],
    -5.5, 1.0, "Cohen's d"
  );

  drawBarChart('chartDimensions', dimShort,
    [ { data: dimFinals.control, color: COLORS.control },
      { data: dimFinals.unrestricted, color: COLORS.unrestricted },
      { data: dimFinals.scaffolded, color: COLORS.scaffolded } ],
    0, 0.75, 'Skill Level'
  );

  drawParadox('chartParadox');

  drawLineChart('chartDependency',
    [ { data: depUnr, color: COLORS.unrestricted },
      { data: depScaf, color: COLORS.scaffolded } ],
    depMonths.map(function(m) { return m === 0 ? 'Start' : 'M' + m; }),
    0.10, 0.70, 'Month', 'Dependency Index'
  );

  drawSensitivity('chartSensitivity', sensDepths, sensDeltaValues);
}

window.addEventListener('load', renderAll);
window.addEventListener('resize', renderAll);

// Interactive slider
var slider = document.getElementById('depthSlider');
var depthValueEl = document.getElementById('depthValue');
var depthResultEl = document.getElementById('depthResult');

slider.addEventListener('input', function() {
  var val = parseInt(slider.value) / 100;
  depthValueEl.textContent = val.toFixed(2);

  var delta = 0;
  for (var i = 0; i < sensDepths.length - 1; i++) {
    if (val >= sensDepths[i] - 0.01 && val <= sensDepths[i+1] + 0.01) {
      var t = (val - sensDepths[i]) / (sensDepths[i+1] - sensDepths[i]);
      delta = sensDeltaValues[i] + t * (sensDeltaValues[i+1] - sensDeltaValues[i]);
      break;
    }
  }
  if (val >= sensDepths[sensDepths.length - 1]) delta = sensDeltaValues[sensDeltaValues.length - 1];

  var harms = delta < 0;
  var sign = delta >= 0 ? '+' : '';
  var color = harms ? 'var(--unrestricted)' : 'var(--control)';
  var word = harms ? 'HARMS' : 'HELPS';
  depthResultEl.textContent = 'At processing depth ' + val.toFixed(2) + ': AI ' + word + ' skill formation. Skill delta: ' + sign + delta.toFixed(4);
  depthResultEl.style.color = harms ? '#d62728' : '#2ca02c';

  var highlightIdx = -1;
  for (var i = 0; i < sensDepths.length; i++) {
    if (Math.abs(sensDepths[i] - val) < 0.03) { highlightIdx = i; break; }
  }
  drawSensitivity('chartSensitivity', sensDepths, sensDeltaValues, highlightIdx >= 0 ? highlightIdx : undefined);
});

// Smooth scroll nav
document.querySelectorAll('nav a').forEach(function(a) {
  a.addEventListener('click', function(e) {
    e.preventDefault();
    var target = document.querySelector(a.getAttribute('href'));
    if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    document.querySelectorAll('nav a').forEach(function(n) { n.classList.remove('active'); });
    a.classList.add('active');
  });
});

var sections = document.querySelectorAll('section');
var navLinks = document.querySelectorAll('nav a');
window.addEventListener('scroll', function() {
  var current = '';
  sections.forEach(function(s) {
    if (window.scrollY >= s.offsetTop - 100) current = s.getAttribute('id');
  });
  navLinks.forEach(function(a) {
    a.classList.remove('active');
    if (a.getAttribute('href') === '#' + current) a.classList.add('active');
  });
});
</script>
</body>
</html>
