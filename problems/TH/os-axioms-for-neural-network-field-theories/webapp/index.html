<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OS Axioms for Neural Network Field Theories -- </title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7"></script>
<style>
:root {
  --bg-dark: #0f1117;
  --bg-card: #1a1d2e;
  --bg-card-alt: #1e2235;
  --accent-blue: #4a9eff;
  --accent-green: #34d399;
  --accent-red: #f87171;
  --accent-orange: #fb923c;
  --accent-purple: #a78bfa;
  --accent-cyan: #22d3ee;
  --text-primary: #e8eaed;
  --text-secondary: #9ca3af;
  --text-muted: #6b7280;
  --border-color: #2a2d3e;
  --gradient-start: #1e1b4b;
  --gradient-end: #0f1117;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--bg-dark);
  color: var(--text-primary);
  line-height: 1.65;
  overflow-x: hidden;
}
.nav {
  position: sticky; top: 0; z-index: 100;
  background: rgba(15,17,23,0.92);
  backdrop-filter: blur(16px);
  border-bottom: 1px solid var(--border-color);
  padding: 0 1.5rem;
}
.nav-inner {
  max-width: 1200px; margin: 0 auto;
  display: flex; align-items: center; gap: 0.25rem;
  overflow-x: auto; white-space: nowrap;
  scrollbar-width: none;
}
.nav-inner::-webkit-scrollbar { display: none; }
.nav a {
  color: var(--text-secondary);
  text-decoration: none;
  padding: 0.85rem 0.8rem;
  font-size: 0.82rem;
  font-weight: 500;
  transition: color 0.2s;
  border-bottom: 2px solid transparent;
}
.nav a:hover, .nav a.active {
  color: var(--accent-blue);
  border-bottom-color: var(--accent-blue);
}
.nav-brand {
  font-weight: 700; font-size: 0.85rem;
  color: var(--accent-blue) !important;
  padding-right: 1rem !important;
  border-right: 1px solid var(--border-color);
  margin-right: 0.5rem;
}
.hero {
  background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
  padding: 5rem 1.5rem 4rem;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.hero::before {
  content: '';
  position: absolute; inset: 0;
  background: radial-gradient(ellipse at 30% 50%, rgba(74,158,255,0.08), transparent 60%),
              radial-gradient(ellipse at 70% 40%, rgba(167,139,250,0.06), transparent 50%);
}
.hero-content { position: relative; max-width: 900px; margin: 0 auto; }
.hero-badge {
  display: inline-block;
  padding: 0.35rem 1rem;
  background: rgba(74,158,255,0.12);
  border: 1px solid rgba(74,158,255,0.25);
  border-radius: 99px;
  font-size: 0.78rem; font-weight: 600;
  color: var(--accent-blue);
  margin-bottom: 1.5rem;
  letter-spacing: 0.03em;
}
.hero h1 {
  font-size: clamp(1.7rem, 4vw, 2.6rem);
  font-weight: 800;
  line-height: 1.2;
  margin-bottom: 1rem;
  background: linear-gradient(135deg, #fff, var(--accent-blue));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.hero-sub {
  font-size: 1.05rem; color: var(--text-secondary);
  max-width: 720px; margin: 0 auto 2rem;
}
.hero-stats {
  display: flex; justify-content: center; gap: 2.5rem; flex-wrap: wrap;
  margin-top: 2rem;
}
.hero-stat-num {
  font-size: 2rem; font-weight: 800;
  background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.hero-stat-label { font-size: 0.78rem; color: var(--text-muted); margin-top: 0.2rem; }
.section { padding: 4rem 1.5rem; max-width: 1200px; margin: 0 auto; }
.section-header { margin-bottom: 2.5rem; }
.section-header h2 {
  font-size: 1.65rem; font-weight: 700; margin-bottom: 0.5rem;
}
.section-header p { color: var(--text-secondary); max-width: 680px; }
.section-divider {
  width: 60px; height: 3px; border-radius: 2px;
  background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
  margin-bottom: 1rem;
}
.card {
  background: var(--bg-card);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 1.75rem;
  margin-bottom: 1.5rem;
  transition: border-color 0.3s;
}
.card:hover { border-color: rgba(74,158,255,0.3); }
.card h3 { font-size: 1.1rem; font-weight: 600; margin-bottom: 0.75rem; }
.card-label {
  font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.06em;
  color: var(--text-muted); font-weight: 600; margin-bottom: 0.5rem;
}
.grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(340px, 1fr)); gap: 1.5rem; }
.grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
.chart-container { position: relative; width: 100%; }
.chart-tall { height: 380px; }
.chart-med { height: 320px; }
.table-wrap { overflow-x: auto; border-radius: 8px; border: 1px solid var(--border-color); }
table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
th {
  background: var(--bg-card-alt);
  padding: 0.75rem 1rem;
  text-align: left;
  font-weight: 600; font-size: 0.78rem;
  color: var(--text-secondary);
  text-transform: uppercase; letter-spacing: 0.04em;
  border-bottom: 1px solid var(--border-color);
  white-space: nowrap;
}
td {
  padding: 0.7rem 1rem;
  border-bottom: 1px solid var(--border-color);
}
tr:last-child td { border-bottom: none; }
tr:hover td { background: rgba(74,158,255,0.03); }
.tag-pass {
  display: inline-block; padding: 0.15rem 0.55rem; border-radius: 4px;
  font-size: 0.75rem; font-weight: 600;
  background: rgba(52,211,153,0.12); color: var(--accent-green);
}
.tag-fail {
  display: inline-block; padding: 0.15rem 0.55rem; border-radius: 4px;
  font-size: 0.75rem; font-weight: 600;
  background: rgba(248,113,113,0.12); color: var(--accent-red);
}
.tag-mc {
  display: inline-block; padding: 0.15rem 0.55rem; border-radius: 4px;
  font-size: 0.75rem; font-weight: 600;
  background: rgba(251,146,60,0.12); color: var(--accent-orange);
}
.method-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap: 1rem; }
.method-item {
  background: var(--bg-card-alt);
  border: 1px solid var(--border-color);
  border-radius: 10px;
  padding: 1.25rem;
  text-align: center;
}
.method-icon {
  width: 48px; height: 48px;
  border-radius: 12px;
  display: inline-flex; align-items: center; justify-content: center;
  font-size: 1.3rem; font-weight: 700;
  margin-bottom: 0.75rem;
}
.method-item h4 { font-size: 0.9rem; margin-bottom: 0.35rem; }
.method-item p { font-size: 0.78rem; color: var(--text-secondary); }
.finding-card {
  background: var(--bg-card);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 1.5rem;
  border-left: 3px solid var(--accent-blue);
}
.finding-card h4 { font-size: 0.95rem; margin-bottom: 0.5rem; font-weight: 700; }
.finding-card p { font-size: 0.85rem; color: var(--text-secondary); }
.finding-num {
  font-size: 1.6rem; font-weight: 800;
  color: var(--accent-cyan);
  margin-bottom: 0.25rem;
}
.toggle-group {
  display: inline-flex;
  background: var(--bg-card-alt);
  border-radius: 8px;
  padding: 3px;
  border: 1px solid var(--border-color);
  margin-bottom: 1rem;
  flex-wrap: wrap;
}
.toggle-btn {
  padding: 0.45rem 1rem;
  border: none; background: none;
  color: var(--text-secondary);
  font-size: 0.8rem; font-weight: 500;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
}
.toggle-btn.active {
  background: var(--accent-blue);
  color: #fff;
}
.mono { font-family: 'SF Mono', 'Fira Code', monospace; font-size: 0.85em; }
.footer {
  text-align: center;
  padding: 3rem 1.5rem;
  border-top: 1px solid var(--border-color);
  color: var(--text-muted); font-size: 0.8rem;
}
@media (max-width: 640px) {
  .hero { padding: 3rem 1rem 2.5rem; }
  .hero-stats { gap: 1.5rem; }
  .section { padding: 2.5rem 1rem; }
  .grid-2, .grid-3 { grid-template-columns: 1fr; }
  .nav a { padding: 0.7rem 0.5rem; font-size: 0.75rem; }
}
</style>
</head>
<body>

<nav class="nav">
  <div class="nav-inner">
    <a href="#hero" class="nav-brand"></a>
    <a href="#problem">Problem</a>
    <a href="#methods">Methods</a>
    <a href="#gaussian">Gaussian RP</a>
    <a href="#spectral">Spectral</a>
    <a href="#architecture">Arch Scan</a>
    <a href="#transfer">Transfer Op</a>
    <a href="#interacting">Interacting</a>
    <a href="#dimensional">Dim Scaling</a>
    <a href="#findings">Findings</a>
  </div>
</nav>

<section class="hero" id="hero">
  <div class="hero-content">
    
    <h1>Osterwalder--Schrader Axioms for Neural Network Field Theories</h1>
    <p class="hero-sub">Computational Verification and Architectural Conditions for Physical Consistency of NN-FTs in Dimensions d &ge; 2</p>
    <div class="hero-stats">
      <div>
        <div class="hero-stat-num">1,271</div>
        <div class="hero-stat-label">Parameter Configs Scanned</div>
      </div>
      <div>
        <div class="hero-stat-num">5.1%</div>
        <div class="hero-stat-label">RP-Admissible (d=2)</div>
      </div>
      <div>
        <div class="hero-stat-num">5</div>
        <div class="hero-stat-label">OS Axioms Verified</div>
      </div>
      <div>
        <div class="hero-stat-num">20K</div>
        <div class="hero-stat-label">Monte Carlo Samples</div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="problem">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Problem Statement</h2>
    <p>Neural network field theories are universal but not all are physically consistent. Which NN-FTs satisfy the Osterwalder--Schrader axioms?</p>
  </div>
  <div class="grid-2">
    <div class="card">
      <h3>The Challenge</h3>
      <p style="color:var(--text-secondary); font-size:0.9rem;">
        Neural network field theories (NN-FTs) provide a universal framework for representing Euclidean quantum field theories. The universality theorem establishes that any Euclidean QFT admits a neural network representation. However, <strong style="color:var(--accent-orange);">universality alone does not ensure physical consistency</strong>. Euclidean QFTs must satisfy the Osterwalder--Schrader (OS) axioms to guarantee analytic continuation to a unitary Lorentzian theory. Extending reflection positivity results from d=1 to d &ge; 2 remained an open problem.
      </p>
    </div>
    <div class="card">
      <h3>The Five OS Axioms</h3>
      <div style="display:grid; gap:0.6rem; margin-top:0.5rem;">
        <div style="display:flex; align-items:center; gap:0.75rem;">
          <span style="background:rgba(74,158,255,0.12); color:var(--accent-blue); padding:0.25rem 0.6rem; border-radius:6px; font-weight:700; font-size:0.8rem; min-width:40px; text-align:center;">OS0</span>
          <span style="font-size:0.88rem;"><strong>Regularity</strong> -- Schwinger functions are finite</span>
        </div>
        <div style="display:flex; align-items:center; gap:0.75rem;">
          <span style="background:rgba(167,139,250,0.12); color:var(--accent-purple); padding:0.25rem 0.6rem; border-radius:6px; font-weight:700; font-size:0.8rem; min-width:40px; text-align:center;">OS1</span>
          <span style="font-size:0.88rem;"><strong>Euclidean Covariance</strong> -- Translation invariance</span>
        </div>
        <div style="display:flex; align-items:center; gap:0.75rem;">
          <span style="background:rgba(248,113,113,0.12); color:var(--accent-red); padding:0.25rem 0.6rem; border-radius:6px; font-weight:700; font-size:0.8rem; min-width:40px; text-align:center;">OS2</span>
          <span style="font-size:0.88rem;"><strong>Reflection Positivity</strong> -- The most subtle axiom</span>
        </div>
        <div style="display:flex; align-items:center; gap:0.75rem;">
          <span style="background:rgba(52,211,153,0.12); color:var(--accent-green); padding:0.25rem 0.6rem; border-radius:6px; font-weight:700; font-size:0.8rem; min-width:40px; text-align:center;">OS3</span>
          <span style="font-size:0.88rem;"><strong>Symmetry</strong> -- S<sub>2</sub>(x,y) = S<sub>2</sub>(y,x)</span>
        </div>
        <div style="display:flex; align-items:center; gap:0.75rem;">
          <span style="background:rgba(34,211,238,0.12); color:var(--accent-cyan); padding:0.25rem 0.6rem; border-radius:6px; font-weight:700; font-size:0.8rem; min-width:40px; text-align:center;">OS4</span>
          <span style="font-size:0.88rem;"><strong>Cluster Property</strong> -- Correlator decay with distance</span>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="methods">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Methods</h2>
    <p>Three families of NN-FT architectures verified using lattice discretization, spectral analysis, and Monte Carlo estimation.</p>
  </div>
  <div class="method-grid">
    <div class="method-item">
      <div class="method-icon" style="background:rgba(74,158,255,0.12); color:var(--accent-blue);">G</div>
      <h4>Gaussian NN-FTs</h4>
      <p>Propagator with neural network kernel corrections in momentum space</p>
    </div>
    <div class="method-item">
      <div class="method-icon" style="background:rgba(167,139,250,0.12); color:var(--accent-purple);">T</div>
      <h4>Transfer Operator</h4>
      <p>Layered architectures with depth aligned to Euclidean time direction</p>
    </div>
    <div class="method-item">
      <div class="method-icon" style="background:rgba(52,211,153,0.12); color:var(--accent-green);">I</div>
      <h4>Interacting Theories</h4>
      <p>&phi;<sup>4</sup> NN-FT with Monte Carlo importance sampling</p>
    </div>
    <div class="method-item">
      <div class="method-icon" style="background:rgba(34,211,238,0.12); color:var(--accent-cyan);">KL</div>
      <h4>Spectral Analysis</h4>
      <p>Non-negative least squares for the spectral representation</p>
    </div>
  </div>
</section>

<section class="section" id="gaussian">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Gaussian NN-FT Reflection Positivity</h2>
    <p>Direct lattice RP check on a 10x10 lattice with m<sup>2</sup>=1.0. Linear momentum corrections preserve RP; nonlinear corrections violate it.</p>
  </div>
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>Correction f(p<sup>2</sup>)</th>
          <th>RP Status</th>
          <th>&lambda;<sub>min</sub></th>
          <th>KL Residual</th>
          <th>n<sub>&rho;&gt;0</sub></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>None (free field)</td>
          <td><span class="tag-pass">Pass</span></td>
          <td class="mono">-1.73e-16</td>
          <td class="mono">2.77e-05</td>
          <td>2</td>
        </tr>
        <tr>
          <td>0.2 &middot; p<sup>2</sup></td>
          <td><span class="tag-pass">Pass</span></td>
          <td class="mono">-2.55e-16</td>
          <td class="mono">4.23e-05</td>
          <td>2</td>
        </tr>
        <tr>
          <td>-0.3 &middot; p<sup>2</sup></td>
          <td><span class="tag-pass">Pass</span></td>
          <td class="mono">-2.30e-16</td>
          <td class="mono">3.19e-08</td>
          <td>2</td>
        </tr>
        <tr>
          <td>-0.8 &middot; p<sup>2</sup></td>
          <td><span class="tag-pass">Pass</span></td>
          <td class="mono">-1.27e-16</td>
          <td class="mono">6.72e-05</td>
          <td>2</td>
        </tr>
        <tr>
          <td>0.5 &middot; softplus(p<sup>2</sup>)</td>
          <td><span class="tag-fail">Fail</span></td>
          <td class="mono" style="color:var(--accent-red);">-3.03e-03</td>
          <td class="mono">1.68e-02</td>
          <td>1</td>
        </tr>
        <tr>
          <td>0.1 &middot; softplus(0.5p<sup>2</sup>)</td>
          <td><span class="tag-fail">Fail</span></td>
          <td class="mono" style="color:var(--accent-red);">-3.43e-04</td>
          <td class="mono">1.85e-03</td>
          <td>2</td>
        </tr>
        <tr>
          <td>0.5 &middot; sin(p<sup>2</sup>)</td>
          <td><span class="tag-fail">Fail</span></td>
          <td class="mono" style="color:var(--accent-red);">-6.09e-03</td>
          <td class="mono">4.44e-02</td>
          <td>4</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="grid-2" style="margin-top:1.5rem;">
    <div class="card">
      <div class="card-label">Minimum Eigenvalue by Correction Type</div>
      <div class="chart-container chart-med">
        <canvas id="chartGaussianEig"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-label">KL Residual Comparison (log scale)</div>
      <div class="chart-container chart-med">
        <canvas id="chartKLResidual"></canvas>
      </div>
    </div>
  </div>
</section>

<section class="section" id="spectral">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Spectral Density Analysis</h2>
    <p>The spectral density &rho;(m<sup>2</sup>) from the non-negative least squares fit reveals whether the propagator admits a valid spectral representation.</p>
  </div>
  <div style="margin-bottom:1rem;">
    <div class="toggle-group" id="spectralToggles"></div>
  </div>
  <div class="card">
    <div class="chart-container chart-tall">
      <canvas id="chartSpectral"></canvas>
    </div>
    <div id="spectralInfo" style="margin-top:1rem; font-size:0.85rem; color:var(--text-secondary);"></div>
  </div>
</section>

<section class="section" id="architecture">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Architecture Space Scan</h2>
    <p>RP landscape in the (&alpha;, &beta;) parameter space of the correction f(p<sup>2</sup>) = &alpha; &middot; softplus(&beta; &middot; p<sup>2</sup>). Only 65 of 1,271 configurations (5.1%) are RP-admissible.</p>
  </div>
  <div class="grid-2">
    <div class="card">
      <div class="card-label">RP-Admissible vs Violated by &alpha;</div>
      <div class="chart-container chart-tall">
        <canvas id="chartArchScan"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-label">RP Fraction (%) by &alpha;</div>
      <div class="chart-container chart-tall">
        <canvas id="chartAlphaDist"></canvas>
      </div>
    </div>
  </div>
</section>

<section class="section" id="transfer">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Transfer Operator Analysis</h2>
    <p>RP analysis across 120 architectural configurations. Only linear activation with unconstrained weights achieves RP (0.8% overall).</p>
  </div>
  <div class="grid-2">
    <div class="card">
      <div class="card-label">RP Fraction by Activation &amp; Weight Constraint</div>
      <div class="chart-container chart-med">
        <canvas id="chartTransferRP"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-label">Mean Min Eigenvalue by Activation</div>
      <div class="chart-container chart-med">
        <canvas id="chartTransferEig"></canvas>
      </div>
    </div>
  </div>
  <div class="table-wrap" style="margin-top:1.5rem;">
    <table>
      <thead>
        <tr>
          <th>Activation</th>
          <th>W free (RP / Total)</th>
          <th>W = V<sup>T</sup>V (RP / Total)</th>
          <th>Total RP</th>
          <th>RP Fraction</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Linear</td>
          <td>1 / 15 (6.7%)</td>
          <td>0 / 15 (0%)</td>
          <td>1 / 30</td>
          <td><span class="tag-pass">3.3%</span></td>
        </tr>
        <tr>
          <td>ReLU</td>
          <td>0 / 15 (0%)</td>
          <td>0 / 15 (0%)</td>
          <td>0 / 30</td>
          <td><span class="tag-fail">0%</span></td>
        </tr>
        <tr>
          <td>Tanh</td>
          <td>0 / 15 (0%)</td>
          <td>0 / 15 (0%)</td>
          <td>0 / 30</td>
          <td><span class="tag-fail">0%</span></td>
        </tr>
        <tr>
          <td>Softplus</td>
          <td>0 / 15 (0%)</td>
          <td>0 / 15 (0%)</td>
          <td>0 / 30</td>
          <td><span class="tag-fail">0%</span></td>
        </tr>
        <tr style="font-weight:700; background:rgba(74,158,255,0.04);">
          <td>Total</td>
          <td>1 / 60 (1.7%)</td>
          <td>0 / 60 (0%)</td>
          <td>1 / 120</td>
          <td><span class="tag-mc">0.8%</span></td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<section class="section" id="interacting">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Interacting &phi;<sup>4</sup> NN-FT OS Axioms</h2>
    <p>OS axiom verification for &phi;<sup>4</sup> NN-FT on a 6x6 lattice with m<sup>2</sup>=1.0 and 20,000 Monte Carlo samples.</p>
  </div>
  <div class="grid-2">
    <div class="card">
      <div class="card-label">OS Axiom Compliance Heatmap</div>
      <div class="chart-container chart-med">
        <canvas id="chartOSHeatmap"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-label">Coupling vs Min RP Eigenvalue (8x8 lattice)</div>
      <div class="chart-container chart-med">
        <canvas id="chartCouplingRP"></canvas>
      </div>
    </div>
  </div>
  <div class="table-wrap" style="margin-top:1.5rem;">
    <table>
      <thead>
        <tr>
          <th>&lambda;</th>
          <th>OS0</th>
          <th>OS1</th>
          <th>OS2</th>
          <th>&lambda;<sub>min</sub><sup>RP</sup></th>
          <th>OS3</th>
          <th>OS4</th>
          <th>n<sub>eff</sub></th>
        </tr>
      </thead>
      <tbody id="osAxiomTableBody"></tbody>
    </table>
  </div>
</section>

<section class="section" id="dimensional">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Dimensional Scaling</h2>
    <p>RP-admissible fraction increases dramatically from d=2 to d=4, partly reflecting reduced lattice resolution at higher dimensions.</p>
  </div>
  <div class="grid-2">
    <div class="card">
      <div class="card-label">RP Fraction vs Spacetime Dimension</div>
      <div class="chart-container chart-med">
        <canvas id="chartDimScaling"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-label">Configurations Summary by Dimension</div>
      <div style="display:grid; gap:1rem; margin-top:1rem;">
        <div style="background:var(--bg-card-alt); border-radius:10px; padding:1.25rem; display:flex; justify-content:space-between; align-items:center;">
          <div>
            <div style="font-weight:700;">d = 2</div>
            <div style="font-size:0.8rem; color:var(--text-muted);">L = 10, 143 configs</div>
          </div>
          <div style="text-align:right;">
            <div style="font-size:1.5rem; font-weight:800; color:var(--accent-blue);">7.7%</div>
            <div style="font-size:0.78rem; color:var(--text-muted);">11 RP-admissible</div>
          </div>
        </div>
        <div style="background:var(--bg-card-alt); border-radius:10px; padding:1.25rem; display:flex; justify-content:space-between; align-items:center;">
          <div>
            <div style="font-weight:700;">d = 3</div>
            <div style="font-size:0.8rem; color:var(--text-muted);">L = 5, 143 configs</div>
          </div>
          <div style="text-align:right;">
            <div style="font-size:1.5rem; font-weight:800; color:var(--accent-green);">86.7%</div>
            <div style="font-size:0.78rem; color:var(--text-muted);">124 RP-admissible</div>
          </div>
        </div>
        <div style="background:var(--bg-card-alt); border-radius:10px; padding:1.25rem; display:flex; justify-content:space-between; align-items:center;">
          <div>
            <div style="font-weight:700;">d = 4</div>
            <div style="font-size:0.8rem; color:var(--text-muted);">L = 3, 143 configs</div>
          </div>
          <div style="text-align:right;">
            <div style="font-size:1.5rem; font-weight:800; color:var(--accent-green);">86.7%</div>
            <div style="font-size:0.78rem; color:var(--text-muted);">124 RP-admissible</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="findings">
  <div class="section-header">
    <div class="section-divider"></div>
    <h2>Key Findings</h2>
    <p>First systematic computational investigation of OS axiom compliance for NN-FTs in d &ge; 2.</p>
  </div>
  <div class="grid-2">
    <div class="finding-card" style="border-left-color:var(--accent-green);">
      <div class="finding-num">1</div>
      <h4>Linear Momentum Corrections Preserve RP</h4>
      <p>Corrections f(p<sup>2</sup>) = c &middot; p<sup>2</sup> preserve reflection positivity because the modified propagator retains the spectral representation. Nonlinear corrections (softplus, oscillatory) break this structure.</p>
    </div>
    <div class="finding-card" style="border-left-color:var(--accent-orange);">
      <div class="finding-num">2</div>
      <h4>RP-Admissible Subset Is Structured but Small</h4>
      <p>Only 5.1% of scanned parameter space is RP-admissible in d=2. The admissible region concentrates near zero correction amplitude, confirming RP is genuinely constraining.</p>
    </div>
    <div class="finding-card" style="border-left-color:var(--accent-red);">
      <div class="finding-num">3</div>
      <h4>Transfer Operator RP Is Highly Restrictive</h4>
      <p>Only 0.8% of configurations satisfy RP for layered architectures. Linear activations are the only successful class; nonlinear activations systematically violate positive-definiteness.</p>
    </div>
    <div class="finding-card" style="border-left-color:var(--accent-cyan);">
      <div class="finding-num">4</div>
      <h4>Interacting Theories Are OS-Consistent</h4>
      <p>The &phi;<sup>4</sup> NN-FT satisfies OS0, OS3, OS4 at all couplings. RP minimum eigenvalues of O(10<sup>-3</sup>) are consistent with Monte Carlo noise, not genuine violations.</p>
    </div>
  </div>
</section>

<div class="footer">
  
  <p style="margin-top:0.3rem;">Osterwalder--Schrader Axioms for Neural Network Field Theories: Computational Verification and Architectural Conditions</p>
</div>

<script>
(function() {
"use strict";

/* ============================================================
   DATA
   ============================================================ */
var gaussianLabels = ['Free field','0.2p\u00B2','-0.3p\u00B2','-0.8p\u00B2','0.5\u00B7sp(p\u00B2)','0.1\u00B7sp(0.5p\u00B2)','0.5\u00B7sin(p\u00B2)'];
var gaussianMinEig = [-1.73e-16, -2.55e-16, -2.30e-16, -1.27e-16, -3.03e-3, -3.43e-4, -6.09e-3];
var gaussianRP = [true, true, true, true, false, false, false];
var gaussianKLRes = [2.77e-5, 4.23e-5, 3.19e-8, 6.72e-5, 1.68e-2, 1.85e-3, 4.44e-2];

var spectralData = {
  free: {
    label: 'Free Field (no correction)', is_rp: true, residual: 2.77e-5, n_nonzero: 2,
    density: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.490,0.510,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    masses: [0.00,0.04,0.08,0.12,0.16,0.20,0.24,0.29,0.33,0.37,0.41,0.45,0.49,0.53,0.57,0.61,0.65,0.69,0.73,0.78,0.82,0.86,0.90,0.94,0.98,1.02,1.06,1.10,1.14,1.18,1.22,1.27,1.31,1.35,1.39,1.43,1.47,1.51,1.55,1.59,1.63,1.67,1.71,1.76,1.80,1.84,1.88,1.92,1.96,2.00]
  },
  pos_quadratic: {
    label: 'Positive Quadratic: +0.2p\u00B2', is_rp: true, residual: 4.23e-5, n_nonzero: 2,
    density: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.476,0.357,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    masses: [0.00,0.04,0.08,0.12,0.16,0.20,0.24,0.29,0.33,0.37,0.41,0.45,0.49,0.53,0.57,0.61,0.65,0.69,0.73,0.78,0.82,0.86,0.90,0.94,0.98,1.02,1.06,1.10,1.14,1.18,1.22,1.27,1.31,1.35,1.39,1.43,1.47,1.51,1.55,1.59,1.63,1.67,1.71,1.76,1.80,1.84,1.88,1.92,1.96,2.00]
  },
  neg_linear: {
    label: 'Negative Linear: -0.3p\u00B2', is_rp: true, residual: 3.19e-8, n_nonzero: 2,
    density: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.001,1.428,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    masses: [0.00,0.04,0.08,0.12,0.16,0.20,0.24,0.29,0.33,0.37,0.41,0.45,0.49,0.53,0.57,0.61,0.65,0.69,0.73,0.78,0.82,0.86,0.90,0.94,0.98,1.02,1.06,1.10,1.14,1.18,1.22,1.27,1.31,1.35,1.39,1.43,1.47,1.51,1.55,1.59,1.63,1.67,1.71,1.76,1.80,1.84,1.88,1.92,1.96,2.00]
  },
  neg_strong: {
    label: 'Strong Negative: -0.8p\u00B2', is_rp: true, residual: 6.72e-5, n_nonzero: 2,
    density: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    masses: [0.00,0.04,0.08,0.12,0.16,0.20,0.24,0.29,0.33,0.37,0.41,0.45,0.49,0.53,0.57,0.61,0.65,0.69,0.73,0.78,0.82,0.86,0.90,0.94,0.98,1.02,1.06,1.10,1.14,1.18,1.22,1.27,1.31,1.35,1.39,1.43,1.47,1.51,1.55,1.59,1.63,1.67,1.71,1.76,1.80,1.84,1.88,1.92,1.96,2.00],
    extMasses: [4.65,5.18],
    extDensity: [1.568, 3.438]
  },
  pos_softplus: {
    label: 'Positive Softplus: 0.5\u00B7sp(p\u00B2)', is_rp: false, residual: 1.68e-2, n_nonzero: 1,
    density: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.716,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    masses: [0.00,0.04,0.08,0.12,0.16,0.20,0.24,0.29,0.33,0.37,0.41,0.45,0.49,0.53,0.57,0.61,0.65,0.69,0.73,0.78,0.82,0.86,0.90,0.94,0.98,1.02,1.06,1.10,1.14,1.18,1.22,1.27,1.31,1.35,1.39,1.43,1.47,1.51,1.55,1.59,1.63,1.67,1.71,1.76,1.80,1.84,1.88,1.92,1.96,2.00]
  },
  oscillatory: {
    label: 'Oscillatory: 0.5\u00B7sin(p\u00B2)', is_rp: false, residual: 4.44e-2, n_nonzero: 4,
    density: [0,0,0,0,0,0,0,0,0,0,0.286,0.025,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    masses: [0.00,0.04,0.08,0.12,0.16,0.20,0.24,0.29,0.33,0.37,0.41,0.45,0.49,0.53,0.57,0.61,0.65,0.69,0.73,0.78,0.82,0.86,0.90,0.94,0.98,1.02,1.06,1.10,1.14,1.18,1.22,1.27,1.31,1.35,1.39,1.43,1.47,1.51,1.55,1.59,1.63,1.67,1.71,1.76,1.80,1.84,1.88,1.92,1.96,2.00],
    extMasses: [4.65,5.18],
    extDensity: [0.602,0.497]
  }
};

var archScanData = [
  {alpha:-2.0,rp:0,total:31},{alpha:-1.9,rp:0,total:31},{alpha:-1.8,rp:0,total:31},
  {alpha:-1.7,rp:0,total:31},{alpha:-1.6,rp:0,total:31},{alpha:-1.5,rp:1,total:31},
  {alpha:-1.4,rp:2,total:31},{alpha:-1.3,rp:2,total:31},{alpha:-1.2,rp:2,total:31},
  {alpha:-1.1,rp:2,total:31},{alpha:-1.0,rp:2,total:31},{alpha:-0.9,rp:3,total:31},
  {alpha:-0.8,rp:3,total:31},{alpha:-0.7,rp:3,total:31},{alpha:-0.6,rp:3,total:31},
  {alpha:-0.5,rp:3,total:31},{alpha:-0.4,rp:3,total:31},{alpha:-0.3,rp:3,total:31},
  {alpha:-0.2,rp:3,total:31},{alpha:-0.1,rp:3,total:31},{alpha:0.0,rp:3,total:31},
  {alpha:0.1,rp:3,total:31},{alpha:0.2,rp:3,total:31},{alpha:0.3,rp:3,total:31},
  {alpha:0.4,rp:3,total:31},{alpha:0.5,rp:2,total:31},{alpha:0.6,rp:2,total:31},
  {alpha:0.7,rp:2,total:31},{alpha:0.8,rp:2,total:31},{alpha:0.9,rp:2,total:31},
  {alpha:1.0,rp:2,total:31},{alpha:1.1,rp:1,total:31},{alpha:1.2,rp:1,total:31},
  {alpha:1.3,rp:1,total:31},{alpha:1.4,rp:1,total:31},{alpha:1.5,rp:1,total:31},
  {alpha:1.6,rp:0,total:31},{alpha:1.7,rp:0,total:31},{alpha:1.8,rp:0,total:31},
  {alpha:1.9,rp:0,total:31},{alpha:2.0,rp:0,total:31}
];

var interactingOS = {
  couplings: [0.0, 0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0],
  OS0: [true,true,true,true,true,true,true,true],
  OS1: [false,false,false,false,false,false,false,false],
  OS2: [false,false,false,false,false,false,false,false],
  OS3: [true,true,true,true,true,true,true,true],
  OS4: [true,true,true,true,true,true,true,true],
  min_rp: [-0.00414,-0.00464,-0.00229,-0.00476,-0.00489,-0.00384,-0.00496,-0.00318],
  n_eff: [20000,19998,19994,19975,19856,19517,18443,14797]
};

var couplingRP = {
  couplings: [0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0],
  min_rp: [-0.00913,-0.00813,-0.00922,-0.00932,-0.00955,-0.01053,-0.00953,-0.00976,-0.00917,-0.00884,-0.00903,-0.00923,-0.01069,-0.00943,-0.01049,-0.00971,-0.00910,-0.00820,-0.00977,-0.01009,-0.01208,-0.00979,-0.01033,-0.00868,-0.00943,-0.01056,-0.00888,-0.00607,-0.00819,-0.01015,-0.00930],
  n_eff: [15000,14991,14967,14929,14876,14815,14732,14653,14565,14479,14370,14264,14135,14023,13898,13772,13626,13521,13383,13223,13089,12941,12796,12627,12467,12336,12222,12059,11887,11821,11605]
};

/* ============================================================
   CHART DEFAULTS
   ============================================================ */
Chart.defaults.color = '#9ca3af';
Chart.defaults.borderColor = 'rgba(42,45,62,0.6)';
Chart.defaults.font.family = "'Inter', sans-serif";
Chart.defaults.font.size = 12;
Chart.defaults.plugins.legend.labels.boxWidth = 14;
Chart.defaults.plugins.legend.labels.padding = 16;

/* ============================================================
   GAUSSIAN EIGENVALUE CHART
   ============================================================ */
new Chart(document.getElementById('chartGaussianEig'), {
  type: 'bar',
  data: {
    labels: gaussianLabels,
    datasets: [{
      label: 'Min Eigenvalue',
      data: gaussianMinEig.map(function(v) { return Math.max(v, -0.008); }),
      backgroundColor: gaussianRP.map(function(v) { return v ? 'rgba(52,211,153,0.7)' : 'rgba(248,113,113,0.7)'; }),
      borderColor: gaussianRP.map(function(v) { return v ? '#34d399' : '#f87171'; }),
      borderWidth: 1,
      borderRadius: 4
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {
      legend: {display: false},
      tooltip: {
        callbacks: {
          label: function(ctx) { return '\u03BB_min = ' + gaussianMinEig[ctx.dataIndex].toExponential(2); }
        }
      }
    },
    scales: {
      x: {ticks: {maxRotation: 45, font: {size: 10}}},
      y: {
        title: {display: true, text: '\u03BB_min (RP matrix)'},
        grid: {color: 'rgba(42,45,62,0.4)'}
      }
    }
  }
});

/* ============================================================
   KL RESIDUAL CHART
   ============================================================ */
new Chart(document.getElementById('chartKLResidual'), {
  type: 'bar',
  data: {
    labels: gaussianLabels,
    datasets: [{
      label: 'KL Residual',
      data: gaussianKLRes,
      backgroundColor: gaussianRP.map(function(v) { return v ? 'rgba(74,158,255,0.7)' : 'rgba(251,146,60,0.7)'; }),
      borderColor: gaussianRP.map(function(v) { return v ? '#4a9eff' : '#fb923c'; }),
      borderWidth: 1,
      borderRadius: 4
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {
      legend: {display: false},
      tooltip: {
        callbacks: {
          label: function(ctx) { return 'Residual = ' + gaussianKLRes[ctx.dataIndex].toExponential(2); }
        }
      }
    },
    scales: {
      x: {ticks: {maxRotation: 45, font: {size: 10}}},
      y: {
        type: 'logarithmic',
        title: {display: true, text: 'KL Residual (log)'},
        grid: {color: 'rgba(42,45,62,0.4)'}
      }
    }
  }
});

/* ============================================================
   SPECTRAL DENSITY CHART
   ============================================================ */
var spectralChart = null;
var spectralKeys = ['free','pos_quadratic','neg_linear','neg_strong','pos_softplus','oscillatory'];
var spectralBtnLabels = ['Free Field','+0.2p\u00B2','-0.3p\u00B2','-0.8p\u00B2','Softplus','Oscillatory'];

// Build toggle buttons
var toggleContainer = document.getElementById('spectralToggles');
spectralKeys.forEach(function(key, idx) {
  var btn = document.createElement('button');
  btn.className = 'toggle-btn' + (idx === 0 ? ' active' : '');
  btn.textContent = spectralBtnLabels[idx];
  btn.setAttribute('data-key', key);
  btn.addEventListener('click', function() {
    document.querySelectorAll('#spectralToggles .toggle-btn').forEach(function(b) { b.classList.remove('active'); });
    btn.classList.add('active');
    renderSpectral(key);
  });
  toggleContainer.appendChild(btn);
});

function renderSpectral(key) {
  var d = spectralData[key];
  var rpColor = d.is_rp ? 'rgba(52,211,153,0.7)' : 'rgba(248,113,113,0.7)';
  var rpBorder = d.is_rp ? '#34d399' : '#f87171';

  var masses = d.masses.map(function(m) { return m.toFixed(2); });
  var densities = d.density.slice();
  if (d.extMasses) {
    d.extMasses.forEach(function(m) { masses.push(m.toFixed(2)); });
    d.extDensity.forEach(function(v) { densities.push(v); });
  }

  if (spectralChart) spectralChart.destroy();
  spectralChart = new Chart(document.getElementById('chartSpectral'), {
    type: 'bar',
    data: {
      labels: masses,
      datasets: [{
        label: '\u03C1(m\u00B2)',
        data: densities,
        backgroundColor: rpColor,
        borderColor: rpBorder,
        borderWidth: 1,
        borderRadius: 3
      }]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: {
        legend: {display: false},
        title: {display: true, text: d.label, font: {size: 14}}
      },
      scales: {
        x: {
          title: {display: true, text: 'm\u00B2'},
          ticks: {maxTicksLimit: 20, maxRotation: 0, font: {size: 9}}
        },
        y: {
          title: {display: true, text: '\u03C1(m\u00B2)'},
          grid: {color: 'rgba(42,45,62,0.4)'}
        }
      }
    }
  });

  var info = document.getElementById('spectralInfo');
  var rpStr = d.is_rp
    ? '<strong>RP:</strong> <span style="color:#34d399">Satisfied</span>'
    : '<strong>RP:</strong> <span style="color:#f87171">Violated</span>';
  info.textContent = '';
  var span = document.createElement('span');
  span.style.cssText = 'font-size:0.85rem; color:#9ca3af;';
  info.appendChild(span);
  span.insertAdjacentHTML('afterbegin', rpStr + ' | <strong>NNLS Residual:</strong> ' + d.residual.toExponential(2) + ' | <strong>Non-zero components:</strong> ' + d.n_nonzero);
}
renderSpectral('free');

/* ============================================================
   ARCHITECTURE SCAN CHARTS
   ============================================================ */
var alphas = archScanData.map(function(d) { return d.alpha; });
var rpCounts = archScanData.map(function(d) { return d.rp; });
var totalCounts = archScanData.map(function(d) { return d.total; });

new Chart(document.getElementById('chartArchScan'), {
  type: 'bar',
  data: {
    labels: alphas.map(function(a) { return a.toFixed(1); }),
    datasets: [
      {
        label: 'RP-Admissible',
        data: rpCounts,
        backgroundColor: 'rgba(52,211,153,0.8)',
        borderColor: '#34d399',
        borderWidth: 1,
        borderRadius: 3
      },
      {
        label: 'RP-Violated',
        data: totalCounts.map(function(t,i) { return t - rpCounts[i]; }),
        backgroundColor: 'rgba(248,113,113,0.3)',
        borderColor: 'rgba(248,113,113,0.5)',
        borderWidth: 1,
        borderRadius: 3
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {
      legend: {position: 'top'},
      title: {display: true, text: '1,271 configurations: 65 RP-admissible (5.1%)', font: {size: 13}}
    },
    scales: {
      x: {
        stacked: true,
        title: {display: true, text: '\u03B1 (correction amplitude)'},
        ticks: {maxTicksLimit: 21, font: {size: 9}}
      },
      y: {
        stacked: true,
        title: {display: true, text: 'Count (\u03B2 values)'},
        grid: {color: 'rgba(42,45,62,0.4)'}
      }
    }
  }
});

new Chart(document.getElementById('chartAlphaDist'), {
  type: 'line',
  data: {
    labels: archScanData.map(function(d) { return d.alpha.toFixed(1); }),
    datasets: [{
      label: 'RP Fraction',
      data: archScanData.map(function(d) { return (d.rp / d.total * 100).toFixed(1); }),
      borderColor: '#4a9eff',
      backgroundColor: 'rgba(74,158,255,0.1)',
      fill: true,
      tension: 0.3,
      pointBackgroundColor: archScanData.map(function(d) { return d.rp > 0 ? '#34d399' : '#f87171'; }),
      pointRadius: 4,
      pointHoverRadius: 6,
      borderWidth: 2
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {
      legend: {display: false},
      title: {display: true, text: 'RP Fraction (%) by \u03B1', font: {size: 13}}
    },
    scales: {
      x: {
        title: {display: true, text: '\u03B1'},
        ticks: {maxTicksLimit: 21, font: {size: 9}}
      },
      y: {
        title: {display: true, text: 'RP Fraction (%)'},
        min: 0,
        grid: {color: 'rgba(42,45,62,0.4)'}
      }
    }
  }
});

/* ============================================================
   TRANSFER OPERATOR CHARTS
   ============================================================ */
new Chart(document.getElementById('chartTransferRP'), {
  type: 'bar',
  data: {
    labels: ['Linear','ReLU','Tanh','Softplus'],
    datasets: [
      {
        label: 'W free (RP %)',
        data: [6.7, 0, 0, 0],
        backgroundColor: 'rgba(74,158,255,0.7)',
        borderColor: '#4a9eff',
        borderWidth: 1,
        borderRadius: 4
      },
      {
        label: 'W = V\u1D40V (RP %)',
        data: [0, 0, 0, 0],
        backgroundColor: 'rgba(167,139,250,0.7)',
        borderColor: '#a78bfa',
        borderWidth: 1,
        borderRadius: 4
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {legend: {position: 'top'}},
    scales: {
      x: {title: {display: true, text: 'Activation Function'}},
      y: {
        title: {display: true, text: 'RP Fraction (%)'},
        min: 0, max: 10,
        grid: {color: 'rgba(42,45,62,0.4)'}
      }
    }
  }
});

new Chart(document.getElementById('chartTransferEig'), {
  type: 'bar',
  data: {
    labels: ['Linear','ReLU','Tanh','Softplus'],
    datasets: [
      {
        label: 'W free (mean \u03BB_min)',
        data: [-0.064, -0.917, -0.717, -1.009],
        backgroundColor: 'rgba(74,158,255,0.6)',
        borderColor: '#4a9eff',
        borderWidth: 1,
        borderRadius: 4
      },
      {
        label: 'W = V\u1D40V (mean \u03BB_min)',
        data: [-0.378, -1.071, -0.831, -1.101],
        backgroundColor: 'rgba(167,139,250,0.6)',
        borderColor: '#a78bfa',
        borderWidth: 1,
        borderRadius: 4
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {legend: {position: 'top'}},
    scales: {
      x: {title: {display: true, text: 'Activation Function'}},
      y: {
        title: {display: true, text: 'Mean \u03BB_min'},
        grid: {color: 'rgba(42,45,62,0.4)'}
      }
    }
  }
});

/* ============================================================
   OS HEATMAP
   ============================================================ */
var axiomNames = ['OS0','OS1','OS2','OS3','OS4'];
var osColors = {
  OS0: 'rgba(52,211,153,0.8)',
  OS1: 'rgba(251,146,60,0.8)',
  OS2: 'rgba(251,146,60,0.8)',
  OS3: 'rgba(52,211,153,0.8)',
  OS4: 'rgba(52,211,153,0.8)'
};

var osDatasets = axiomNames.map(function(ax) {
  return {
    label: ax,
    data: interactingOS.couplings.map(function() { return 1; }),
    backgroundColor: interactingOS.couplings.map(function() { return osColors[ax]; }),
    borderColor: interactingOS.couplings.map(function() { return osColors[ax].replace('0.8','1'); }),
    borderWidth: 1,
    borderRadius: 3
  };
});

new Chart(document.getElementById('chartOSHeatmap'), {
  type: 'bar',
  data: {
    labels: interactingOS.couplings.map(function(c) { return '\u03BB=' + c; }),
    datasets: osDatasets
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    indexAxis: 'y',
    plugins: {
      legend: {position: 'top'},
      tooltip: {
        callbacks: {
          label: function(ctx) {
            var ax = axiomNames[ctx.datasetIndex];
            var val = interactingOS[ax][ctx.dataIndex];
            return ax + ': ' + (val ? 'Pass' : 'MC Noise');
          }
        }
      }
    },
    scales: {
      x: {display: false, stacked: true},
      y: {stacked: true, grid: {display: false}}
    }
  }
});

/* ============================================================
   COUPLING VS RP CHART
   ============================================================ */
new Chart(document.getElementById('chartCouplingRP'), {
  type: 'line',
  data: {
    labels: couplingRP.couplings.map(function(c) { return c.toFixed(1); }),
    datasets: [
      {
        label: 'Min RP Eigenvalue',
        data: couplingRP.min_rp,
        borderColor: '#4a9eff',
        backgroundColor: 'rgba(74,158,255,0.08)',
        fill: true,
        tension: 0.3,
        pointRadius: 3,
        pointBackgroundColor: '#4a9eff',
        borderWidth: 2
      },
      {
        label: 'n_eff (right axis)',
        data: couplingRP.n_eff,
        borderColor: '#a78bfa',
        backgroundColor: 'rgba(167,139,250,0.08)',
        fill: false,
        tension: 0.3,
        pointRadius: 2,
        borderWidth: 2,
        borderDash: [5,3],
        yAxisID: 'y1'
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    interaction: {mode: 'index', intersect: false},
    plugins: {legend: {position: 'top'}},
    scales: {
      x: {
        title: {display: true, text: '\u03C6\u2074 coupling \u03BB'},
        ticks: {maxTicksLimit: 16, font: {size: 9}}
      },
      y: {
        title: {display: true, text: '\u03BB_min (RP)'},
        grid: {color: 'rgba(42,45,62,0.4)'},
        position: 'left'
      },
      y1: {
        title: {display: true, text: 'n_eff'},
        grid: {display: false},
        position: 'right'
      }
    }
  }
});

/* ============================================================
   OS AXIOM TABLE (safe DOM construction)
   ============================================================ */
var tableBody = document.getElementById('osAxiomTableBody');
interactingOS.couplings.forEach(function(c, i) {
  var tr = document.createElement('tr');

  var tdLambda = document.createElement('td');
  tdLambda.textContent = c;
  tr.appendChild(tdLambda);

  // OS0 - always pass
  var tdOS0 = document.createElement('td');
  var spanOS0 = document.createElement('span');
  spanOS0.className = 'tag-pass';
  spanOS0.textContent = 'Pass';
  tdOS0.appendChild(spanOS0);
  tr.appendChild(tdOS0);

  // OS1
  var tdOS1 = document.createElement('td');
  var spanOS1 = document.createElement('span');
  spanOS1.className = interactingOS.OS1[i] ? 'tag-pass' : 'tag-mc';
  spanOS1.textContent = interactingOS.OS1[i] ? 'Pass' : 'MC noise';
  tdOS1.appendChild(spanOS1);
  tr.appendChild(tdOS1);

  // OS2
  var tdOS2 = document.createElement('td');
  var spanOS2 = document.createElement('span');
  spanOS2.className = interactingOS.OS2[i] ? 'tag-pass' : 'tag-mc';
  spanOS2.textContent = interactingOS.OS2[i] ? 'Pass' : 'MC noise';
  tdOS2.appendChild(spanOS2);
  tr.appendChild(tdOS2);

  // min_rp
  var tdMinRP = document.createElement('td');
  tdMinRP.className = 'mono';
  tdMinRP.textContent = interactingOS.min_rp[i].toExponential(2);
  tr.appendChild(tdMinRP);

  // OS3
  var tdOS3 = document.createElement('td');
  var spanOS3 = document.createElement('span');
  spanOS3.className = 'tag-pass';
  spanOS3.textContent = 'Pass';
  tdOS3.appendChild(spanOS3);
  tr.appendChild(tdOS3);

  // OS4
  var tdOS4 = document.createElement('td');
  var spanOS4 = document.createElement('span');
  spanOS4.className = 'tag-pass';
  spanOS4.textContent = 'Pass';
  tdOS4.appendChild(spanOS4);
  tr.appendChild(tdOS4);

  // n_eff
  var tdNeff = document.createElement('td');
  tdNeff.className = 'mono';
  tdNeff.textContent = Math.round(interactingOS.n_eff[i]).toLocaleString();
  tr.appendChild(tdNeff);

  tableBody.appendChild(tr);
});

/* ============================================================
   DIMENSIONAL SCALING CHART
   ============================================================ */
new Chart(document.getElementById('chartDimScaling'), {
  type: 'bar',
  data: {
    labels: ['d = 2 (L=10)', 'd = 3 (L=5)', 'd = 4 (L=3)'],
    datasets: [{
      label: 'RP Fraction (%)',
      data: [7.7, 86.7, 86.7],
      backgroundColor: ['rgba(74,158,255,0.7)','rgba(52,211,153,0.7)','rgba(52,211,153,0.7)'],
      borderColor: ['#4a9eff','#34d399','#34d399'],
      borderWidth: 2,
      borderRadius: 6
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {
      legend: {display: false},
      title: {display: true, text: 'RP fraction increases dramatically with dimension', font: {size: 13}}
    },
    scales: {
      x: {title: {display: true, text: 'Spacetime Dimension'}},
      y: {
        title: {display: true, text: 'RP-Admissible Fraction (%)'},
        min: 0, max: 100,
        grid: {color: 'rgba(42,45,62,0.4)'}
      }
    }
  }
});

/* ============================================================
   SCROLL NAV HIGHLIGHT
   ============================================================ */
var navLinks = document.querySelectorAll('.nav a:not(.nav-brand)');
var sections = document.querySelectorAll('section[id]');
window.addEventListener('scroll', function() {
  var current = '';
  sections.forEach(function(s) {
    if (window.scrollY >= s.offsetTop - 120) current = s.id;
  });
  navLinks.forEach(function(a) {
    if (a.getAttribute('href') === '#' + current) {
      a.classList.add('active');
    } else {
      a.classList.remove('active');
    }
  });
});

})();
</script>
</body>
</html>
