<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generalized Gibbs Phase Rule for Nonequilibrium Steady States</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7"></script>
<style>
:root {
  --primary: #1a3a5c;
  --primary-light: #234b73;
  --accent: #2980b9;
  --accent-light: #3498db;
  --bg: #f5f7fa;
  --card-bg: #ffffff;
  --text: #2c3e50;
  --text-light: #7f8c8d;
  --border: #e1e8ed;
  --success: #27ae60;
  --warning: #f39c12;
  --danger: #e74c3c;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
}

.hero {
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 50%, var(--accent) 100%);
  color: white;
  padding: 3rem 2rem;
  text-align: center;
}

.hero h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  letter-spacing: -0.02em;
}

.hero .subtitle {
  font-size: 1.1rem;
  opacity: 0.9;
  max-width: 800px;
  margin: 0 auto 1.5rem;
}

.hero .equation-box {
  display: inline-block;
  background: rgba(255,255,255,0.15);
  border: 2px solid rgba(255,255,255,0.4);
  border-radius: 12px;
  padding: 1rem 2rem;
  margin: 1rem 0;
}

.hero .equation-box .eq {
  font-size: 1.6rem;
  font-weight: 700;
  font-family: 'Cambria Math', 'Times New Roman', serif;
}

.hero .equation-box .eq-label {
  font-size: 0.85rem;
  opacity: 0.8;
  margin-top: 0.3rem;
}

.stats-row {
  display: flex;
  justify-content: center;
  gap: 2rem;
  margin-top: 1.5rem;
  flex-wrap: wrap;
}

.stat-item { text-align: center; }
.stat-value { font-size: 1.8rem; font-weight: 700; }
.stat-label {
  font-size: 0.8rem;
  opacity: 0.8;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.section-title {
  font-size: 1.4rem;
  color: var(--primary);
  margin-bottom: 1.5rem;
  padding-bottom: 0.5rem;
  border-bottom: 3px solid var(--accent);
  display: inline-block;
}

.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.card {
  background: var(--card-bg);
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  border: 1px solid var(--border);
}

.card h3 {
  font-size: 1.05rem;
  color: var(--primary);
  margin-bottom: 1rem;
}

.chart-container {
  position: relative;
  height: 320px;
  width: 100%;
}

.chart-container-tall { height: 400px; }

.data-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
}

.data-table th {
  background: var(--primary);
  color: white;
  padding: 0.6rem 0.8rem;
  text-align: left;
  font-weight: 600;
}

.data-table td {
  padding: 0.5rem 0.8rem;
  border-bottom: 1px solid var(--border);
}

.data-table tr:nth-child(even) { background: #f8f9fa; }
.data-table tr:hover { background: #e8f4fd; }

.controls {
  display: flex;
  gap: 1rem;
  margin-bottom: 1rem;
  align-items: center;
  flex-wrap: wrap;
}

.controls label {
  font-weight: 600;
  font-size: 0.9rem;
  color: var(--primary);
}

.controls input[type="range"] {
  width: 200px;
  accent-color: var(--accent);
}

.controls .value-display {
  background: var(--accent);
  color: white;
  padding: 0.2rem 0.6rem;
  border-radius: 4px;
  font-weight: 600;
  min-width: 50px;
  text-align: center;
  font-size: 0.9rem;
}

.finding {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  margin-bottom: 1rem;
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 8px;
  border-left: 4px solid var(--accent);
}

.finding-icon {
  font-size: 1.5rem;
  min-width: 30px;
  font-weight: 700;
  color: var(--accent);
}

.finding h4 {
  font-size: 0.95rem;
  color: var(--primary);
  margin-bottom: 0.3rem;
}

.finding p {
  font-size: 0.85rem;
  color: var(--text-light);
}

.badge {
  display: inline-block;
  padding: 0.15rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
}
.badge-success { background: #d5f5e3; color: #1e8449; }
.badge-warning { background: #fdebd0; color: #d68910; }

.footer {
  background: var(--primary);
  color: rgba(255,255,255,0.8);
  text-align: center;
  padding: 1.5rem;
  font-size: 0.85rem;
}

.footer a {
  color: var(--accent-light);
  text-decoration: none;
}

@media (max-width: 768px) {
  .grid-2 { grid-template-columns: 1fr; }
  .hero h1 { font-size: 1.5rem; }
  .stats-row { gap: 1rem; }
  .controls { flex-direction: column; }
  .controls input[type="range"] { width: 100%; }
}
</style>
</head>
<body>

<section class="hero">
  <h1>Generalized Gibbs Phase Rule for Nonequilibrium Steady States</h1>
  <p class="subtitle">
    Extending the fundamental phase rule F = C - P + 2 to systems
    maintained out of equilibrium by external driving forces
  </p>
  <div class="equation-box">
    <div class="eq">F_neq = C + N_A - P + 2</div>
    <div class="eq-label">C = components, N_A = affinities, P = phases</div>
  </div>
  <div class="stats-row">
    <div class="stat-item">
      <div class="stat-value">764</div>
      <div class="stat-label">Coexistence Points</div>
    </div>
    <div class="stat-item">
      <div class="stat-value">2.15</div>
      <div class="stat-label">NESS Manifold Dim.</div>
    </div>
    <div class="stat-item">
      <div class="stat-value">1.30</div>
      <div class="stat-label">EQ Manifold Dim.</div>
    </div>
    <div class="stat-item">
      <div class="stat-value">17</div>
      <div class="stat-label">Critical Line Points</div>
    </div>
  </div>
</section>

<div class="container">

  <h2 class="section-title">Key Findings</h2>
  <div class="grid-2">
    <div class="finding">
      <div class="finding-icon">1</div>
      <div>
        <h4>Each affinity adds one degree of freedom</h4>
        <p>The coexistence manifold dimension grows linearly with the
        number of independent nonequilibrium driving parameters N_A.
        For C=1, P=2: F=1 (EQ) versus F=2 (NESS with N_A=1).</p>
      </div>
    </div>
    <div class="finding">
      <div class="finding-icon">2</div>
      <div>
        <h4>Critical line replaces critical point</h4>
        <p>In equilibrium, the critical point is isolated (F=0). Under
        driving, T_c(A) traces a one-dimensional curve in the
        (T, A) plane, consistent with F_crit = 1.</p>
      </div>
    </div>
    <div class="finding">
      <div class="finding-icon">3</div>
      <div>
        <h4>Current matching is a new constraint</h4>
        <p>At steady-state interfaces, particle currents must be
        continuous. This extra coexistence condition is absent in
        equilibrium, partially offsetting the enlarged state space.</p>
      </div>
    </div>
    <div class="finding">
      <div class="finding-icon">4</div>
      <div>
        <h4>Manifold dimensionality confirmed</h4>
        <p>Correlation dimension analysis yields dim=2.15 for the NESS
        manifold (predicted: 2) and dim=1.30 for the equilibrium slice
        (predicted: 1).</p>
      </div>
    </div>
  </div>

  <h2 class="section-title">Interactive Phase Rule Calculator</h2>
  <div class="grid-2">
    <div class="card">
      <h3>Compute Degrees of Freedom</h3>
      <div class="controls">
        <label>Components C:</label>
        <input type="range" id="slider-C" min="1" max="5" value="1" step="1">
        <span class="value-display" id="val-C">1</span>
      </div>
      <div class="controls">
        <label>Affinities N_A:</label>
        <input type="range" id="slider-NA" min="0" max="5" value="1" step="1">
        <span class="value-display" id="val-NA">1</span>
      </div>
      <div class="controls">
        <label>Phases P:</label>
        <input type="range" id="slider-P" min="1" max="5" value="2" step="1">
        <span class="value-display" id="val-P">2</span>
      </div>
      <div style="margin-top: 1rem; padding: 1rem; background: #e8f4fd; border-radius: 8px; text-align: center;">
        <div style="font-size: 0.9rem; color: var(--text-light);">Degrees of Freedom</div>
        <div id="result-F" style="font-size: 2.5rem; font-weight: 700; color: var(--primary);">2</div>
        <div id="result-formula" style="font-size: 0.85rem; color: var(--accent);">F = 1 + 1 - 2 + 2 = 2</div>
        <div id="result-eq" style="font-size: 0.8rem; color: var(--text-light); margin-top: 0.3rem;"></div>
      </div>
    </div>
    <div class="card">
      <h3>Degrees of Freedom vs. N_A</h3>
      <div class="chart-container">
        <canvas id="chart-dof"></canvas>
      </div>
    </div>
  </div>

  <h2 class="section-title">Mean-Field Coexistence Surface</h2>
  <div class="grid-2">
    <div class="card">
      <h3>Critical Line T_c(A)</h3>
      <div class="chart-container">
        <canvas id="chart-critical"></canvas>
      </div>
    </div>
    <div class="card">
      <h3>Free Energy Landscape</h3>
      <div class="controls">
        <label>Affinity A:</label>
        <input type="range" id="slider-A" min="0" max="5" value="0" step="0.1">
        <span class="value-display" id="val-A">0.0</span>
      </div>
      <div class="chart-container">
        <canvas id="chart-freeenergy"></canvas>
      </div>
    </div>
  </div>

  <h2 class="section-title">KLS Monte Carlo Simulation</h2>
  <div class="grid-2">
    <div class="card">
      <h3>Steady-State Current vs. Field</h3>
      <div class="chart-container">
        <canvas id="chart-current"></canvas>
      </div>
    </div>
    <div class="card">
      <h3>Density Profiles at T=1.2</h3>
      <div class="chart-container">
        <canvas id="chart-density"></canvas>
      </div>
    </div>
  </div>

  <h2 class="section-title">Manifold Dimensionality</h2>
  <div class="grid-2">
    <div class="card">
      <h3>Predicted vs. Measured</h3>
      <div class="chart-container">
        <canvas id="chart-dim"></canvas>
      </div>
    </div>
    <div class="card">
      <h3>Constraint Counting Summary</h3>
      <table class="data-table">
        <thead>
          <tr>
            <th>Quantity</th>
            <th>Equilibrium</th>
            <th>NESS (N_A=1)</th>
            <th>NESS (N_A=2)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Components C</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>Affinities N_A</td><td>0</td><td>1</td><td>2</td></tr>
          <tr><td>Phases P</td><td>2</td><td>2</td><td>2</td></tr>
          <tr><td>Unknowns/phase D</td><td>2</td><td>3</td><td>4</td></tr>
          <tr><td>Constraints/interface K</td><td>3</td><td>4</td><td>5</td></tr>
          <tr style="font-weight: 700; background: #e8f4fd;">
            <td>Degrees of Freedom F</td><td>1</td><td>2</td><td>3</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <h2 class="section-title">Critical Temperature Data</h2>
  <div class="card">
    <table class="data-table">
      <thead>
        <tr>
          <th>Affinity A</th>
          <th>T_c(A)</th>
          <th>Shift from EQ</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>0.00</td><td>2.003</td><td>0.0%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>0.12</td><td>2.003</td><td>0.0%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>0.24</td><td>1.996</td><td>-0.4%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>0.37</td><td>1.988</td><td>-0.8%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>0.49</td><td>1.974</td><td>-1.5%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>0.61</td><td>1.959</td><td>-2.2%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>0.73</td><td>1.937</td><td>-3.3%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>0.86</td><td>1.908</td><td>-4.8%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>0.98</td><td>1.878</td><td>-6.3%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>1.10</td><td>1.841</td><td>-8.1%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>1.22</td><td>1.797</td><td>-10.3%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>1.35</td><td>1.746</td><td>-12.9%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>1.47</td><td>1.680</td><td>-16.1%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>1.59</td><td>1.606</td><td>-19.8%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>1.71</td><td>1.518</td><td>-24.2%</td><td><span class="badge badge-success">Confirmed</span></td></tr>
        <tr><td>1.84</td><td>1.401</td><td>-30.1%</td><td><span class="badge badge-warning">Large shift</span></td></tr>
        <tr><td>1.96</td><td>1.202</td><td>-39.9%</td><td><span class="badge badge-warning">Large shift</span></td></tr>
      </tbody>
    </table>
  </div>

  <h2 class="section-title">KLS Phase Diagram Data</h2>
  <div class="card">
    <h3>Order Parameter (density-profile variance) across (T, E) space</h3>
    <div class="chart-container chart-container-tall">
      <canvas id="chart-heatmap"></canvas>
    </div>
  </div>

</div>

<div class="footer">
  <p>Generalized Gibbs Phase Rule for Nonequilibrium Steady States |
  Reference: Maes, <a href="https://arxiv.org/abs/2601.16716">arXiv:2601.16716</a> (2026)</p>
</div>

<script>
// ========== DATA ==========

var criticalLine = [
  {A: 0.00, Tc: 2.003}, {A: 0.12, Tc: 2.003}, {A: 0.24, Tc: 1.996},
  {A: 0.37, Tc: 1.988}, {A: 0.49, Tc: 1.974}, {A: 0.61, Tc: 1.959},
  {A: 0.73, Tc: 1.937}, {A: 0.86, Tc: 1.908}, {A: 0.98, Tc: 1.878},
  {A: 1.10, Tc: 1.841}, {A: 1.22, Tc: 1.797}, {A: 1.35, Tc: 1.746},
  {A: 1.47, Tc: 1.680}, {A: 1.59, Tc: 1.606}, {A: 1.71, Tc: 1.518},
  {A: 1.84, Tc: 1.401}, {A: 1.96, Tc: 1.202}
];

var currentData = {
  E: [0.0, 0.364, 0.727, 1.091, 1.455, 1.818, 2.182, 2.545, 2.909, 3.273, 3.636, 4.0],
  J: [-0.0009, 0.0191, 0.0346, 0.0457, 0.0607, 0.0686, 0.0761, 0.0807, 0.0923, 0.0929, 0.0967, 0.0985]
};

var densityEq = [0.55,0.50,0.55,0.50,0.50,0.55,0.55,0.55,0.55,0.80,0.75,0.75,0.70,0.70,0.65,0.70,0.65,0.60,0.65,0.60,0.55,0.55,0.45,0.40,0.30,0.25,0.30,0.30,0.30,0.30,0.30,0.35,0.40,0.40,0.35,0.35,0.35,0.35,0.40,0.50];
var densityNe = [0.50,0.50,0.55,0.55,0.55,0.55,0.55,0.60,0.65,0.70,0.70,0.70,0.70,0.70,0.65,0.60,0.55,0.55,0.50,0.45,0.40,0.40,0.35,0.35,0.35,0.30,0.30,0.35,0.35,0.40,0.40,0.40,0.45,0.45,0.45,0.50,0.50,0.50,0.50,0.75];

var phaseDiagram = {
  T: [1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2],
  E: [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0],
  OP: [
    [0.0206, 0.0152, 0.0125, 0.0107, 0.0109, 0.0130, 0.0105],
    [0.0187, 0.0198, 0.0133, 0.0145, 0.0114, 0.0103, 0.0108],
    [0.0167, 0.0185, 0.0148, 0.0151, 0.0146, 0.0121, 0.0114],
    [0.0153, 0.0170, 0.0140, 0.0136, 0.0122, 0.0161, 0.0138],
    [0.0152, 0.0164, 0.0148, 0.0123, 0.0136, 0.0124, 0.0124],
    [0.0200, 0.0171, 0.0139, 0.0144, 0.0126, 0.0134, 0.0114],
    [0.0159, 0.0147, 0.0146, 0.0120, 0.0123, 0.0142, 0.0136]
  ]
};

// ========== INTERACTIVE PHASE RULE ==========

function updatePhaseRule() {
  var C = parseInt(document.getElementById('slider-C').value);
  var NA = parseInt(document.getElementById('slider-NA').value);
  var P = parseInt(document.getElementById('slider-P').value);
  var F = C + NA - P + 2;
  var Feq = C - P + 2;

  document.getElementById('val-C').textContent = C;
  document.getElementById('val-NA').textContent = NA;
  document.getElementById('val-P').textContent = P;
  document.getElementById('result-F').textContent = F;
  document.getElementById('result-formula').textContent =
    'F = ' + C + ' + ' + NA + ' - ' + P + ' + 2 = ' + F;
  document.getElementById('result-eq').textContent =
    'Equilibrium (N_A=0): F = ' + Feq;

  document.getElementById('result-F').style.color =
    F >= 0 ? 'var(--primary)' : 'var(--danger)';
}

document.getElementById('slider-C').addEventListener('input', updatePhaseRule);
document.getElementById('slider-NA').addEventListener('input', updatePhaseRule);
document.getElementById('slider-P').addEventListener('input', updatePhaseRule);
updatePhaseRule();

// ========== DOF CHART ==========

var ctxDof = document.getElementById('chart-dof').getContext('2d');
new Chart(ctxDof, {
  type: 'bar',
  data: {
    labels: ['EQ (N_A=0)', 'NESS (N_A=1)', 'NESS (N_A=2)', 'NESS (N_A=3)'],
    datasets: [{
      label: 'Degrees of Freedom F',
      data: [1, 2, 3, 4],
      backgroundColor: ['#1565C0', '#E65100', '#F57C00', '#FFB300'],
      borderColor: '#333',
      borderWidth: 1
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: { display: false },
      title: { display: true, text: 'F = C + N_A - P + 2 (C=1, P=2)' }
    },
    scales: {
      y: { beginAtZero: true, title: { display: true, text: 'F (degrees of freedom)' },
           ticks: { stepSize: 1 } }
    }
  }
});

// ========== CRITICAL LINE CHART ==========

var ctxCrit = document.getElementById('chart-critical').getContext('2d');
new Chart(ctxCrit, {
  type: 'line',
  data: {
    labels: criticalLine.map(function(d) { return d.A.toFixed(2); }),
    datasets: [{
      label: 'T_c(A)',
      data: criticalLine.map(function(d) { return d.Tc; }),
      borderColor: '#e74c3c',
      backgroundColor: 'rgba(231,76,60,0.1)',
      fill: true,
      tension: 0.3,
      pointRadius: 4,
      pointBackgroundColor: '#e74c3c',
      borderWidth: 2
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'Critical Temperature vs. Affinity' }
    },
    scales: {
      x: { title: { display: true, text: 'Affinity A' } },
      y: { title: { display: true, text: 'T_c(A)' }, min: 1.0, max: 2.2 }
    }
  }
});

// ========== FREE ENERGY CHART ==========

function computeFreeEnergy(A) {
  var T = 1.5;
  var J = 1.0, z = 4;
  var rhos = [];
  var fs = [];
  for (var i = 1; i < 100; i++) {
    var rho = i / 100;
    rhos.push(rho);
    var fEq = T * (rho * Math.log(rho) + (1 - rho) * Math.log(1 - rho))
              + J * z * rho * (1 - rho);
    var fNeq = -A * A * rho * (1 - rho) / (2 * T);
    fs.push(fEq + fNeq);
  }
  return { rhos: rhos, fs: fs };
}

var ctxFE = document.getElementById('chart-freeenergy').getContext('2d');
var initFE = computeFreeEnergy(0);
var freeEnergyChart = new Chart(ctxFE, {
  type: 'line',
  data: {
    labels: initFE.rhos.map(function(r) { return r.toFixed(2); }),
    datasets: [{
      label: 'f(rho, T=1.5, A=0.0)',
      data: initFE.fs,
      borderColor: '#2980b9',
      backgroundColor: 'rgba(41,128,185,0.1)',
      fill: true,
      tension: 0.3,
      pointRadius: 0,
      borderWidth: 2
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'Effective Free Energy f(rho) at T=1.5' }
    },
    scales: {
      x: { title: { display: true, text: 'Density rho' },
           ticks: { maxTicksLimit: 10 } },
      y: { title: { display: true, text: 'f(rho, T, A)' } }
    },
    animation: { duration: 200 }
  }
});

document.getElementById('slider-A').addEventListener('input', function() {
  var A = parseFloat(this.value);
  document.getElementById('val-A').textContent = A.toFixed(1);
  var newFE = computeFreeEnergy(A);
  freeEnergyChart.data.datasets[0].data = newFE.fs;
  freeEnergyChart.data.datasets[0].label = 'f(rho, T=1.5, A=' + A.toFixed(1) + ')';
  freeEnergyChart.update();
});

// ========== CURRENT VS FIELD ==========

var ctxCurr = document.getElementById('chart-current').getContext('2d');
var slope = 0.0300;
var intercept = -0.002;
var linFit = currentData.E.map(function(e) { return slope * e + intercept; });

new Chart(ctxCurr, {
  type: 'scatter',
  data: {
    datasets: [
      {
        label: 'KLS simulation',
        data: currentData.E.map(function(e, i) { return { x: e, y: currentData.J[i] }; }),
        borderColor: '#2c3e50',
        backgroundColor: '#2c3e50',
        pointRadius: 5,
        showLine: true,
        borderWidth: 2,
        tension: 0.3
      },
      {
        label: 'Linear fit (slope=0.030)',
        data: currentData.E.map(function(e, i) { return { x: e, y: linFit[i] }; }),
        borderColor: '#e74c3c',
        borderDash: [5, 5],
        pointRadius: 0,
        showLine: true,
        borderWidth: 1.5
      }
    ]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'Steady-State Current (T=1.5)' }
    },
    scales: {
      x: { title: { display: true, text: 'External field E' } },
      y: { title: { display: true, text: 'Mean current <J_x>' } }
    }
  }
});

// ========== DENSITY PROFILES ==========

var ctxDens = document.getElementById('chart-density').getContext('2d');
var xPositions = [];
for (var ii = 0; ii < 40; ii++) xPositions.push(ii);

new Chart(ctxDens, {
  type: 'line',
  data: {
    labels: xPositions,
    datasets: [
      {
        label: 'E=0 (equilibrium)',
        data: densityEq,
        borderColor: '#2980b9',
        fill: false,
        tension: 0.2,
        pointRadius: 0,
        borderWidth: 2
      },
      {
        label: 'E=2 (NESS)',
        data: densityNe,
        borderColor: '#e74c3c',
        fill: false,
        tension: 0.2,
        pointRadius: 0,
        borderWidth: 2
      }
    ]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'Density Profiles at T=1.2' }
    },
    scales: {
      x: { title: { display: true, text: 'Position x' }, ticks: { maxTicksLimit: 10 } },
      y: { title: { display: true, text: 'Density' }, min: 0.2, max: 0.85 }
    }
  }
});

// ========== MANIFOLD DIMENSION ==========

var ctxDim = document.getElementById('chart-dim').getContext('2d');
new Chart(ctxDim, {
  type: 'bar',
  data: {
    labels: ['Equilibrium', 'NESS'],
    datasets: [
      {
        label: 'Predicted',
        data: [1.0, 2.0],
        backgroundColor: '#4CAF50',
        borderColor: '#333',
        borderWidth: 1
      },
      {
        label: 'Measured',
        data: [1.30, 2.15],
        backgroundColor: '#2196F3',
        borderColor: '#333',
        borderWidth: 1
      }
    ]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'Coexistence Manifold Dimensionality' }
    },
    scales: {
      y: { beginAtZero: true, title: { display: true, text: 'Intrinsic Dimension' }, max: 3 }
    }
  }
});

// ========== PHASE DIAGRAM (grouped bar) ==========

var ctxHeat = document.getElementById('chart-heatmap').getContext('2d');
var colors7 = ['#1a237e','#283593','#3949ab','#5c6bc0','#7986cb','#9fa8da','#c5cae9'];
var heatDatasets = phaseDiagram.E.map(function(E, j) {
  return {
    label: 'E=' + E.toFixed(1),
    data: phaseDiagram.OP.map(function(row) { return row[j]; }),
    backgroundColor: colors7[j],
    borderColor: '#333',
    borderWidth: 0.5
  };
});

new Chart(ctxHeat, {
  type: 'bar',
  data: {
    labels: phaseDiagram.T.map(function(t) { return 'T=' + t.toFixed(1); }),
    datasets: heatDatasets
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      title: { display: true, text: 'KLS Order Parameter across (T, E)' },
      legend: { position: 'top' }
    },
    scales: {
      x: { title: { display: true, text: 'Temperature' } },
      y: { title: { display: true, text: 'Order Parameter' }, beginAtZero: true }
    }
  }
});
</script>
</body>
</html>
