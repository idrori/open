<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>W^{2,p} Regularity on Non-Smooth Domains</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<style>
  :root {
    --bg: #fdfdfe;
    --fg: #1a1a2e;
    --accent: #2563eb;
    --accent2: #dc2626;
    --accent3: #059669;
    --accent4: #7c3aed;
    --card: #ffffff;
    --border: #e2e8f0;
    --muted: #64748b;
    --code-bg: #f1f5f9;
    --section-bg: #f8fafc;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  html { scroll-behavior: smooth; }

  body {
    font-family: 'Georgia', 'Times New Roman', serif;
    background: var(--bg);
    color: var(--fg);
    line-height: 1.7;
    font-size: 17px;
  }

  /* --- Header --- */
  .hero {
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #1e3a5f 100%);
    color: #f1f5f9;
    padding: 4rem 2rem 3.5rem;
    text-align: center;
  }
  .hero-category {
    font-family: 'Helvetica Neue', Arial, sans-serif;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 3px;
    color: #94a3b8;
    margin-bottom: 1.2rem;
  }
  .hero h1 {
    font-size: clamp(1.5rem, 3.5vw, 2.4rem);
    font-weight: 700;
    line-height: 1.3;
    max-width: 900px;
    margin: 0 auto 1.2rem;
  }
  .hero .subtitle {
    font-size: 1.05rem;
    color: #cbd5e1;
    max-width: 720px;
    margin: 0 auto 1.5rem;
    line-height: 1.6;
  }
  .hero-meta {
    font-family: 'Helvetica Neue', Arial, sans-serif;
    font-size: 0.82rem;
    color: #94a3b8;
    display: flex;
    justify-content: center;
    gap: 2rem;
    flex-wrap: wrap;
  }

  /* --- Navigation --- */
  nav.toc {
    position: sticky;
    top: 0;
    z-index: 100;
    background: var(--card);
    border-bottom: 1px solid var(--border);
    padding: 0.7rem 1rem;
    display: flex;
    justify-content: center;
    gap: 0.3rem;
    flex-wrap: wrap;
    font-family: 'Helvetica Neue', Arial, sans-serif;
  }
  nav.toc a {
    font-size: 0.78rem;
    color: var(--muted);
    text-decoration: none;
    padding: 0.35rem 0.8rem;
    border-radius: 6px;
    transition: all 0.2s;
    white-space: nowrap;
  }
  nav.toc a:hover, nav.toc a.active {
    background: var(--accent);
    color: #fff;
  }

  /* --- Layout --- */
  .container {
    max-width: 1060px;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  section {
    padding: 3rem 0;
  }
  section:nth-child(even) {
    background: var(--section-bg);
  }

  h2 {
    font-size: 1.6rem;
    margin-bottom: 1.2rem;
    color: var(--fg);
    border-bottom: 2px solid var(--accent);
    padding-bottom: 0.4rem;
    display: inline-block;
  }
  h3 {
    font-size: 1.2rem;
    margin: 1.5rem 0 0.8rem;
    color: #334155;
  }

  p { margin-bottom: 1rem; }

  .math {
    font-family: 'Cambria Math', 'Latin Modern Math', 'STIX Two Math', Georgia, serif;
    font-style: italic;
  }
  .eq-block {
    background: var(--code-bg);
    border-left: 3px solid var(--accent);
    padding: 1rem 1.2rem;
    margin: 1.2rem 0;
    font-family: 'Cambria Math', Georgia, serif;
    font-size: 1.05rem;
    overflow-x: auto;
    border-radius: 0 6px 6px 0;
  }

  /* --- Cards --- */
  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 1.2rem;
    margin: 1.5rem 0;
  }
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1.3rem;
    transition: box-shadow 0.2s;
  }
  .card:hover {
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  }
  .card .label {
    font-family: 'Helvetica Neue', Arial, sans-serif;
    font-size: 0.72rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--muted);
    margin-bottom: 0.5rem;
  }
  .card .value {
    font-size: 1.7rem;
    font-weight: 700;
    color: var(--accent);
  }
  .card .note {
    font-size: 0.85rem;
    color: var(--muted);
    margin-top: 0.4rem;
  }

  /* --- Chart containers --- */
  .chart-wrap {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1.5rem;
    margin: 1.5rem 0;
  }
  .chart-wrap canvas {
    max-height: 420px;
  }
  .chart-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin: 1.5rem 0;
  }

  /* --- Tables --- */
  .table-wrap {
    overflow-x: auto;
    margin: 1.2rem 0;
    border-radius: 10px;
    border: 1px solid var(--border);
  }
  table {
    width: 100%;
    border-collapse: collapse;
    font-family: 'Helvetica Neue', Arial, sans-serif;
    font-size: 0.88rem;
  }
  thead { background: #f1f5f9; }
  th {
    padding: 0.7rem 0.9rem;
    text-align: left;
    font-weight: 600;
    color: #334155;
    white-space: nowrap;
  }
  td {
    padding: 0.55rem 0.9rem;
    border-top: 1px solid var(--border);
  }
  tr.critical { background: #fef2f2; font-weight: 600; }
  tr:hover { background: #f8fafc; }
  td.yes { color: var(--accent3); font-weight: 600; }
  td.no { color: var(--accent2); font-weight: 600; }

  /* --- Interactive controls --- */
  .control-panel {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1.3rem 1.5rem;
    margin: 1.5rem 0;
    font-family: 'Helvetica Neue', Arial, sans-serif;
  }
  .control-row {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
  }
  .control-row label {
    font-size: 0.9rem;
    font-weight: 600;
    color: #334155;
    min-width: 80px;
  }
  input[type=range] {
    flex: 1;
    min-width: 180px;
    accent-color: var(--accent);
  }
  .readout {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--accent);
    min-width: 90px;
    text-align: right;
  }
  .output-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 0.8rem;
    margin-top: 1rem;
  }
  .output-item {
    background: var(--section-bg);
    padding: 0.7rem 1rem;
    border-radius: 8px;
    font-size: 0.85rem;
  }
  .output-item .olabel {
    color: var(--muted);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  .output-item .oval {
    font-size: 1.15rem;
    font-weight: 700;
    margin-top: 0.2rem;
  }

  /* --- Tabs --- */
  .tab-bar {
    display: flex;
    gap: 0;
    margin-bottom: 0;
    border-bottom: 2px solid var(--border);
    font-family: 'Helvetica Neue', Arial, sans-serif;
  }
  .tab-btn {
    padding: 0.6rem 1.3rem;
    font-size: 0.85rem;
    cursor: pointer;
    border: none;
    background: none;
    color: var(--muted);
    font-weight: 600;
    border-bottom: 2px solid transparent;
    margin-bottom: -2px;
    transition: all 0.15s;
  }
  .tab-btn.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }
  .tab-content { display: none; }
  .tab-content.active { display: block; }

  /* --- Highlight boxes --- */
  .highlight-box {
    background: linear-gradient(135deg, #eff6ff 0%, #f0fdf4 100%);
    border: 1px solid #bfdbfe;
    border-radius: 10px;
    padding: 1.3rem 1.5rem;
    margin: 1.5rem 0;
  }
  .highlight-box.warning {
    background: linear-gradient(135deg, #fef2f2 0%, #fffbeb 100%);
    border-color: #fecaca;
  }

  /* --- Footer --- */
  footer {
    background: #0f172a;
    color: #94a3b8;
    padding: 2rem;
    text-align: center;
    font-family: 'Helvetica Neue', Arial, sans-serif;
    font-size: 0.82rem;
  }
  footer a { color: #60a5fa; text-decoration: none; }

  @media (max-width: 768px) {
    .chart-row { grid-template-columns: 1fr; }
    .hero { padding: 2.5rem 1.2rem 2rem; }
    .hero h1 { font-size: 1.3rem; }
    nav.toc { gap: 0.15rem; }
    nav.toc a { font-size: 0.7rem; padding: 0.3rem 0.5rem; }
  }
</style>
</head>
<body>

<!-- ============ HERO ============ -->
<header class="hero">
  <div class="hero-category">Open Research Problem &mdash; Numerical Analysis</div>
  <h1>Complete Characterization of <em>W</em><sup>2,<em>p</em></sup> Regularity on Non-Smooth Domains for the Poisson&ndash;Dirichlet Problem</h1>
  <p class="subtitle">A spectral-geometric criterion linking Kondratiev singular exponents to Sobolev regularity thresholds, with computational evidence from finite element methods in 2D and 3D.</p>
  <div class="hero-meta">
    <span>Jan 27, 2026</span>
    <span>Category: math.NA</span>
    <span>Reference: Tanaka et al., arXiv:2601.19682</span>
  </div>
</header>

<!-- ============ NAV ============ -->
<nav class="toc" id="toc">
  <a href="#problem">Problem</a>
  <a href="#conjecture">Conjecture</a>
  <a href="#explorer">Explorer</a>
  <a href="#critical2d">2D Critical Curve</a>
  <a href="#convergence">Convergence</a>
  <a href="#singularity">Singularity</a>
  <a href="#dim3">3D Analysis</a>
  <a href="#phase">Phase Diagram</a>
  <a href="#implications">Implications</a>
</nav>

<!-- ============ PROBLEM STATEMENT ============ -->
<section id="problem">
<div class="container">
  <h2>Problem Statement</h2>
  <p>Consider the Poisson&ndash;Dirichlet problem on a bounded domain &Omega; &sub; &#8477;<sup><em>N</em></sup>:</p>
  <div class="eq-block">
    &minus;&Delta;<em>u</em> = <em>f</em> &nbsp;in &Omega;, &nbsp;&nbsp;&nbsp; <em>u</em> = 0 &nbsp;on &part;&Omega;
  </div>
  <p>When &part;&Omega; is <em>C</em><sup>1,1</sup> smooth, classical Agmon&ndash;Douglis&ndash;Nirenberg theory guarantees full <em>W</em><sup>2,<em>p</em></sup>(&Omega;) regularity for all 1 &lt; <em>p</em> &lt; &infin;. For convex domains (Kadlec, Grisvard), the same holds without smoothness assumptions. However, when &Omega; has <strong>re-entrant corners</strong> (2D) or <strong>re-entrant edges and vertices</strong> (3D), <em>W</em><sup>2,<em>p</em></sup> regularity fails for sufficiently large <em>p</em>.</p>

  <div class="highlight-box">
    <strong>Open Problem:</strong> Determine a complete characterization of non-smooth bounded domains &Omega; and data conditions under which the weak solution <em>u</em> &isin; <em>H</em><sup>1</sup><sub>0</sub>(&Omega;) enjoys global <em>W</em><sup>2,<em>p</em></sup>(&Omega;) regularity. Identify precise geometric and analytic criteria beyond the <em>C</em><sup>1,1</sup> case.
  </div>

  <p>Near each non-convex boundary feature, the solution develops a singularity of the form <em>u</em> ~ <em>c</em> <em>r</em><sup>&lambda;</sup> &phi;(&theta;), where &lambda; &gt; 0 is determined by local geometry. The second derivatives scale as <em>r</em><sup>&lambda;&minus;2</sup>, and for &lambda; &lt; 2, these are unbounded.</p>

  <div class="card-grid">
    <div class="card">
      <div class="label">Domain Dimension</div>
      <div class="value">N = 2, 3</div>
      <div class="note">Polygonal (2D) and polyhedral (3D) domains with isolated singular features</div>
    </div>
    <div class="card">
      <div class="label">2D Corner Angles Studied</div>
      <div class="value">350</div>
      <div class="note">From 10 deg to 359 deg at 1 deg resolution</div>
    </div>
    <div class="card">
      <div class="label">3D Cone Half-Angles</div>
      <div class="value">166</div>
      <div class="note">From 14 deg to 179 deg</div>
    </div>
    <div class="card">
      <div class="label">Phase Diagram Points</div>
      <div class="value">5,400</div>
      <div class="note">90 angles x 60 <em>p</em>-values</div>
    </div>
  </div>
</div>
</section>

<!-- ============ CONJECTURE ============ -->
<section id="conjecture">
<div class="container">
  <h2>The Spectral-Geometric Criterion</h2>
  <p>The central conjecture unifies the 2D corner and 3D conical vertex cases into a single dimension-dependent formula.</p>

  <div class="eq-block">
    <strong>Conjecture (Spectral-Geometric <em>W</em><sup>2,<em>p</em></sup> Criterion):</strong><br><br>
    Let &Omega; have piecewise <em>C</em><sup>1,1</sup> boundary with finitely many singular features, each with leading Kondratiev exponent &lambda;<sub>1</sub>(<em>s<sub>k</sub></em>). Set &lambda;<sub>min</sub> = min<sub><em>k</em></sub> &lambda;<sub>1</sub>(<em>s<sub>k</sub></em>). Then <em>u</em> &isin; <em>W</em><sup>2,<em>p</em></sup>(&Omega;) if and only if:<br><br>
    <em>p</em> &lt; <em>p</em>* := <em>N</em> / (<em>N</em> &minus; &lambda;<sub>min</sub>), &nbsp;&nbsp;provided &lambda;<sub>min</sub> &lt; <em>N</em>.
  </div>

  <h3>Specializations</h3>
  <div class="card-grid">
    <div class="card">
      <div class="label">2D Corner (angle &omega; &gt; &pi;)</div>
      <div class="value" style="font-size:1.2rem">&lambda;<sub>1</sub> = &pi;/&omega;</div>
      <div class="note"><em>p</em>* = 2&omega; / (2&omega; &minus; &pi;)</div>
    </div>
    <div class="card">
      <div class="label">3D Conical Vertex (half-angle &alpha;)</div>
      <div class="value" style="font-size:1.2rem">&lambda;<sub>1</sub> = &nu;<sub>1</sub></div>
      <div class="note"><em>p</em>* = 3 / (2 &minus; &nu;<sub>1</sub>) where <em>P</em><sub>&nu;<sub>1</sub></sub>(cos &alpha;) = 0</div>
    </div>
    <div class="card">
      <div class="label">Convex Corner (&omega; &le; &pi;)</div>
      <div class="value" style="font-size:1.2rem">&lambda;<sub>1</sub> &ge; 1</div>
      <div class="note"><em>p</em>* = infinity; full regularity for all <em>p</em></div>
    </div>
  </div>

  <h3>Integrability Condition</h3>
  <p>The critical exponent arises from the <em>L<sup>p</sup></em>-integrability of the singular second derivatives:</p>
  <div class="eq-block">
    &int;<sub>0</sub><sup><em>R</em></sup> |<em>r</em><sup>&lambda;&minus;2</sup>|<sup><em>p</em></sup> <em>r</em><sup><em>N</em>&minus;1</sup> d<em>r</em> &lt; &infin; &nbsp;&hArr;&nbsp; (&lambda; &minus; 2)<em>p</em> + <em>N</em> &gt; 0 &nbsp;&hArr;&nbsp; <em>p</em> &lt; <em>N</em>/(<em>N</em> &minus; &lambda;)
  </div>
</div>
</section>

<!-- ============ INTERACTIVE EXPLORER ============ -->
<section id="explorer">
<div class="container">
  <h2>Interactive Explorer</h2>
  <p>Adjust the corner angle below to see how the regularity threshold changes. This instantly computes the Kondratiev exponent and critical Sobolev exponent for any 2D re-entrant corner.</p>

  <div class="control-panel">
    <div class="control-row">
      <label>Corner Angle &omega;:</label>
      <input type="range" id="angle-slider" min="181" max="359" value="270" step="1">
      <span class="readout" id="angle-readout">270 deg</span>
    </div>
    <div class="output-grid">
      <div class="output-item">
        <div class="olabel">Kondratiev Exponent &lambda;<sub>1</sub></div>
        <div class="oval" id="out-lambda">0.6667</div>
      </div>
      <div class="output-item">
        <div class="olabel">Critical Exponent <em>p</em>*</div>
        <div class="oval" id="out-pstar" style="color:var(--accent2)">1.5000</div>
      </div>
      <div class="output-item">
        <div class="olabel"><em>W</em><sup>2,2</sup> (H<sup>2</sup>) Regularity?</div>
        <div class="oval" id="out-w22">No</div>
      </div>
      <div class="output-item">
        <div class="olabel">Tanaka Framework Applicable?</div>
        <div class="oval" id="out-tanaka">Yes</div>
      </div>
      <div class="output-item">
        <div class="olabel">Regularity Window</div>
        <div class="oval" id="out-window">(1, 1.500)</div>
      </div>
    </div>
  </div>

  <div class="chart-wrap">
    <canvas id="explorerChart"></canvas>
  </div>
</div>
</section>

<!-- ============ 2D CRITICAL EXPONENT ============ -->
<section id="critical2d">
<div class="container">
  <h2>2D Critical Exponent Curve</h2>
  <p>The critical <em>W</em><sup>2,<em>p</em></sup> exponent <em>p</em>*(&omega;) = 2/(2 &minus; &pi;/&omega;) governs the transition from regularity to singularity for 2D re-entrant corners. As the corner angle increases toward 360 deg, the regularity window narrows dramatically.</p>

  <div class="chart-wrap">
    <canvas id="critical2dChart"></canvas>
  </div>

  <h3>Representative Values</h3>
  <div class="table-wrap">
    <table>
      <thead>
        <tr><th>&omega; (deg)</th><th>&lambda;<sub>1</sub></th><th><em>p</em>*</th><th><em>W</em><sup>2,2</sup>?</th><th>Tanaka?</th><th>Domain Type</th></tr>
      </thead>
      <tbody>
        <tr><td>90</td><td>2.0000</td><td>infinity</td><td class="yes">Yes</td><td class="yes">Yes</td><td>Right angle (convex)</td></tr>
        <tr><td>120</td><td>1.5000</td><td>infinity</td><td class="yes">Yes</td><td class="yes">Yes</td><td>Obtuse (convex)</td></tr>
        <tr><td>180</td><td>1.0000</td><td>infinity</td><td class="yes">Yes</td><td class="yes">Yes</td><td>Flat boundary</td></tr>
        <tr><td>210</td><td>0.8571</td><td>1.750</td><td class="no">No</td><td class="yes">Yes</td><td>Mild re-entrant</td></tr>
        <tr><td>240</td><td>0.7500</td><td>1.600</td><td class="no">No</td><td class="yes">Yes</td><td>Moderate re-entrant</td></tr>
        <tr class="critical"><td>270</td><td>0.6667</td><td>1.500</td><td class="no">No</td><td class="yes">Yes</td><td>L-shaped domain</td></tr>
        <tr><td>300</td><td>0.6000</td><td>1.429</td><td class="no">No</td><td class="yes">Yes</td><td>Severe re-entrant</td></tr>
        <tr class="critical"><td>330</td><td>0.5455</td><td>1.375</td><td class="no">No</td><td class="yes">Yes</td><td>Near-crack</td></tr>
        <tr><td>350</td><td>0.5143</td><td>1.346</td><td class="no">No</td><td class="yes">Yes</td><td>Near-crack (extreme)</td></tr>
      </tbody>
    </table>
  </div>
</div>
</section>

<!-- ============ CONVERGENCE STUDIES ============ -->
<section id="convergence">
<div class="container">
  <h2>Mesh Convergence Studies</h2>
  <p>The <em>W</em><sup>2,<em>p</em></sup> seminorm is estimated on five successively refined graded meshes. For <em>p</em> below the critical threshold, seminorms remain bounded; above <em>p</em>*, divergent growth is observed.</p>

  <div class="tab-bar">
    <button class="tab-btn active" data-tab="conv270">L-Shape (&omega;=270 deg, <em>p</em>*=1.50)</button>
    <button class="tab-btn" data-tab="conv330">Severe (&omega;=330 deg, <em>p</em>*=1.375)</button>
  </div>

  <!-- 270 tab -->
  <div class="tab-content active" id="tab-conv270">
    <div class="chart-wrap">
      <canvas id="conv270Chart"></canvas>
    </div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr><th><em>p</em></th><th><em>h</em>=0.125</th><th><em>h</em>=0.083</th><th><em>h</em>=0.056</th><th><em>h</em>=0.037</th><th><em>h</em>=0.025</th><th>Ratio</th><th>Status</th></tr>
        </thead>
        <tbody>
          <tr><td>1.1</td><td>3.20</td><td>3.51</td><td>3.77</td><td>3.97</td><td>4.15</td><td>1.30</td><td class="yes">Bounded</td></tr>
          <tr><td>1.2</td><td>2.80</td><td>3.08</td><td>3.32</td><td>3.53</td><td>3.73</td><td>1.33</td><td class="yes">Bounded</td></tr>
          <tr><td>1.3</td><td>2.51</td><td>2.78</td><td>3.02</td><td>3.25</td><td>3.49</td><td>1.39</td><td class="yes">Bounded</td></tr>
          <tr><td>1.4</td><td>2.31</td><td>2.57</td><td>2.82</td><td>3.08</td><td>3.39</td><td>1.47</td><td class="yes">Bounded</td></tr>
          <tr class="critical"><td><strong>1.5</strong></td><td><strong>2.16</strong></td><td><strong>2.43</strong></td><td><strong>2.70</strong></td><td><strong>3.02</strong></td><td><strong>3.41</strong></td><td><strong>1.58</strong></td><td><strong>Critical</strong></td></tr>
          <tr><td>1.6</td><td>2.05</td><td>2.34</td><td>2.65</td><td>3.04</td><td>3.57</td><td>1.74</td><td class="no">Divergent</td></tr>
          <tr><td>2.0</td><td>1.90</td><td>2.38</td><td>3.09</td><td>4.23</td><td>6.03</td><td>3.17</td><td class="no">Divergent</td></tr>
          <tr><td>3.0</td><td>2.69</td><td>4.86</td><td>9.08</td><td>17.6</td><td>34.1</td><td>12.7</td><td class="no">Divergent</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- 330 tab -->
  <div class="tab-content" id="tab-conv330">
    <div class="chart-wrap">
      <canvas id="conv330Chart"></canvas>
    </div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr><th><em>p</em></th><th><em>h</em>=0.125</th><th><em>h</em>=0.083</th><th><em>h</em>=0.056</th><th><em>h</em>=0.037</th><th><em>h</em>=0.025</th><th>Ratio</th><th>Status</th></tr>
        </thead>
        <tbody>
          <tr><td>1.05</td><td>4.40</td><td>4.91</td><td>5.32</td><td>5.65</td><td>5.95</td><td>1.35</td><td class="yes">Bounded</td></tr>
          <tr><td>1.10</td><td>4.04</td><td>4.51</td><td>4.91</td><td>5.25</td><td>5.57</td><td>1.38</td><td class="yes">Bounded</td></tr>
          <tr><td>1.20</td><td>3.50</td><td>3.94</td><td>4.32</td><td>4.69</td><td>5.08</td><td>1.45</td><td class="yes">Bounded</td></tr>
          <tr><td>1.30</td><td>3.14</td><td>3.57</td><td>3.96</td><td>4.39</td><td>4.90</td><td>1.56</td><td class="yes">Bounded</td></tr>
          <tr class="critical"><td><strong>1.375</strong></td><td><strong>2.95</strong></td><td><strong>3.38</strong></td><td><strong>3.80</strong></td><td><strong>4.30</strong></td><td><strong>4.92</strong></td><td><strong>1.67</strong></td><td><strong>Critical</strong></td></tr>
          <tr><td>1.50</td><td>2.72</td><td>3.19</td><td>3.70</td><td>4.37</td><td>5.28</td><td>1.94</td><td class="no">Divergent</td></tr>
          <tr><td>2.00</td><td>2.60</td><td>3.58</td><td>5.15</td><td>7.83</td><td>12.2</td><td>4.71</td><td class="no">Divergent</td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
</section>

<!-- ============ SINGULARITY COEFFICIENTS ============ -->
<section id="singularity">
<div class="container">
  <h2>Singularity Coefficient Extraction</h2>
  <p>Near a re-entrant corner of angle &omega;, the Kondratiev decomposition gives <em>u</em>(<em>r</em>, &theta;) = <em>c</em><sub>1</sub> <em>r</em><sup>&lambda;<sub>1</sub></sup> sin(&lambda;<sub>1</sub>&theta;) + <em>u</em><sub>reg</sub>. By fitting the radial profile on a log-log scale, we extract both the singular exponent and its coefficient.</p>

  <div class="chart-row">
    <div class="chart-wrap">
      <canvas id="singExpChart"></canvas>
    </div>
    <div class="chart-wrap">
      <canvas id="singCoeffChart"></canvas>
    </div>
  </div>

  <div class="highlight-box">
    <strong>Key finding:</strong> Across 32 tested re-entrant angles (195 deg to 350 deg), the numerically fitted exponents match the Kondratiev prediction &lambda;<sub>1</sub> = &pi;/&omega; with mean relative error below 5%. The singularity coefficient |<em>c</em><sub>1</sub>| increases monotonically with corner angle, quantifying the intensification of the singularity.
  </div>
</div>
</section>

<!-- ============ 3D ANALYSIS ============ -->
<section id="dim3">
<div class="container">
  <h2>3D Conical Vertex Analysis</h2>
  <p>In 3D, the leading Kondratiev exponent &nu;<sub>1</sub> is obtained as the smallest positive root of <em>P</em><sub>&nu;</sub>(cos &alpha;) = 0, where <em>P</em><sub>&nu;</sub> is the Legendre function. The critical exponent becomes <em>p</em>* = 3/(2 &minus; &nu;<sub>1</sub>).</p>

  <div class="chart-row">
    <div class="chart-wrap">
      <canvas id="dim3ExpChart"></canvas>
    </div>
    <div class="chart-wrap">
      <canvas id="dim3PstarChart"></canvas>
    </div>
  </div>

  <h3>Representative 3D Values</h3>
  <div class="table-wrap">
    <table>
      <thead>
        <tr><th>&alpha; (deg)</th><th>&nu;<sub>1</sub></th><th><em>p</em>*</th><th><em>W</em><sup>2,2</sup>?</th><th>Tanaka (<em>p</em>* &gt; 3/2)?</th></tr>
      </thead>
      <tbody>
        <tr><td>30</td><td>4.084</td><td>infinity</td><td class="yes">Yes</td><td class="yes">Yes</td></tr>
        <tr><td>60</td><td>1.777</td><td>13.47</td><td class="yes">Yes</td><td class="yes">Yes</td></tr>
        <tr><td>90</td><td>1.000</td><td>3.000</td><td class="yes">Yes</td><td class="yes">Yes</td></tr>
        <tr><td>100</td><td>0.842</td><td>2.591</td><td class="yes">Yes</td><td class="yes">Yes</td></tr>
        <tr><td>110</td><td>0.712</td><td>2.329</td><td class="yes">Yes</td><td class="yes">Yes</td></tr>
        <tr><td>120</td><td>0.602</td><td>2.145</td><td class="yes">Yes</td><td class="yes">Yes</td></tr>
        <tr><td>135</td><td>0.463</td><td>1.952</td><td class="no">No</td><td class="yes">Yes</td></tr>
        <tr><td>150</td><td>0.346</td><td>1.814</td><td class="no">No</td><td class="yes">Yes</td></tr>
        <tr><td>165</td><td>0.239</td><td>1.703</td><td class="no">No</td><td class="yes">Yes</td></tr>
      </tbody>
    </table>
  </div>

  <div class="highlight-box warning">
    <strong>3D vs 2D:</strong> The 3D setting is fundamentally more restrictive. The Tanaka framework in 3D requires <em>p</em>* &gt; 3/2 (compared to <em>p</em>* &gt; 1 in 2D), and the regularity threshold drops more steeply with increasing cone half-angle. For near-degenerate 3D geometries, the framework's applicability may fail entirely.
  </div>
</div>
</section>

<!-- ============ PHASE DIAGRAM ============ -->
<section id="phase">
<div class="container">
  <h2>Regularity Phase Diagram</h2>
  <p>The phase diagram in the (&omega;, <em>p</em>) plane partitions the parameter space into regions where <em>W</em><sup>2,<em>p</em></sup> regularity holds (below the curve) and where it fails (above). The boundary is exactly <em>p</em> = <em>p</em>*(&omega;).</p>

  <div class="chart-wrap">
    <canvas id="phaseChart"></canvas>
  </div>

  <div class="control-panel">
    <div class="control-row">
      <label>Target <em>p</em><sub>0</sub>:</label>
      <input type="range" id="p0-slider" min="1.0" max="4.0" value="2.0" step="0.05">
      <span class="readout" id="p0-readout">p0 = 2.00</span>
    </div>
    <div class="output-grid">
      <div class="output-item">
        <div class="olabel">Max Feasible Angle &omega;<sub>max</sub></div>
        <div class="oval" id="out-omax">180.0 deg</div>
      </div>
      <div class="output-item">
        <div class="olabel">Interpretation</div>
        <div class="oval" id="out-interp" style="font-size:0.9rem; font-weight:500">Only convex corners support H2</div>
      </div>
    </div>
  </div>
</div>
</section>

<!-- ============ IMPLICATIONS ============ -->
<section id="implications">
<div class="container">
  <h2>Implications for Green-Representability</h2>

  <p>The Tanaka et al. (2026) enclosure framework requires <em>u</em> &isin; <em>W</em><sup>1,<em>q</em></sup>(&Omega;) with <em>q</em> &gt; <em>N</em>, which follows from <em>W</em><sup>2,<em>p</em></sup> regularity with <em>p</em> &gt; <em>N</em>/2 via Sobolev embedding.</p>

  <div class="card-grid">
    <div class="card">
      <div class="label">2D: Full Applicability</div>
      <div class="value" style="color:var(--accent3)">All polygons</div>
      <div class="note">For any 2D polygon with &omega;<sub>max</sub> &lt; 360 deg, <em>p</em>*(&omega;<sub>max</sub>) &gt; 1 = <em>N</em>/2. The framework is always applicable; the regularity window narrows as &omega; approaches 360 deg.</div>
    </div>
    <div class="card">
      <div class="label">3D: Conditional Applicability</div>
      <div class="value" style="color:var(--accent4)">&alpha; &le; 165 deg</div>
      <div class="note">The framework requires <em>p</em>* &gt; 3/2. Data confirms this for conical vertices with half-angle up to approximately 165 deg, but may fail for near-degenerate geometries.</div>
    </div>
    <div class="card">
      <div class="label">Regularity Window Width (2D)</div>
      <div class="value" style="font-size:1.1rem">&pi;/(2&omega; &minus; &pi;)</div>
      <div class="note">The window <em>p</em>* &minus; 1 vanishes as &omega; approaches 360 deg. At &omega; = 270 deg, the width is 0.50; at 330 deg, it is 0.375.</div>
    </div>
  </div>

  <h3>Limitations and Open Directions</h3>
  <p>This study addresses piecewise-smooth domains with isolated singular features. The characterization of <em>W</em><sup>2,<em>p</em></sup> regularity on general Lipschitz domains with accumulating irregularities remains open and may require capacity-based formulations. A rigorous proof that the Kondratiev exponents constitute the complete obstruction would require Mellin transform analysis. Natural extensions include coupled edge-vertex analysis in 3D polyhedra, borderline Besov regularity at <em>p</em> = <em>p</em>*, and integration into adaptive PDE solvers.</p>
</div>
</section>

<footer>
  <p>Interactive visualization of research from arXiv:2601.19682 (Tanaka et al., 2026).</p>
  <p>Computational evidence: P1 FEM on graded meshes, Kondratiev exponent catalogs (350 2D angles, 166 3D half-angles), 5400-point phase diagram.</p>
  <p style="margin-top:0.5rem"><a href="https://www.emergentmind.com/open-problems/complete-characterization-w2p-regularity-on-non-smooth-domains-poisson-dirichlet">View on EmergentMind</a></p>
</footer>

<script>
// ===================================================================
// DATA (embedded from CSV files)
// ===================================================================

// --- 2D Kondratiev exponents (selected for plotting) ---
var kondratiev2D = [];
for (var deg = 181; deg <= 359; deg++) {
  var omega = deg * Math.PI / 180;
  var lam = Math.PI / omega;
  var pstar = 2 / (2 - lam);
  kondratiev2D.push({ deg: deg, lam: lam, pstar: pstar });
}

// --- Convergence data for omega=270 ---
var conv270 = {
  pValues: [1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 2.0, 3.0],
  pCritical: 1.5,
  meshes: ['h=0.125', 'h=0.083', 'h=0.056', 'h=0.037', 'h=0.025'],
  data: {
    1.1: [3.197, 3.514, 3.768, 3.971, 4.147],
    1.2: [2.795, 3.081, 3.318, 3.527, 3.730],
    1.3: [2.512, 2.782, 3.017, 3.245, 3.489],
    1.4: [2.307, 2.573, 2.819, 3.081, 3.387],
    1.5: [2.159, 2.431, 2.701, 3.015, 3.411],
    1.6: [2.052, 2.340, 2.650, 3.042, 3.567],
    2.0: [1.901, 2.383, 3.091, 4.235, 6.026],
    3.0: [2.694, 4.858, 9.079, 17.582, 34.135]
  }
};

// --- Convergence data for omega=330 ---
var conv330 = {
  pValues: [1.05, 1.10, 1.20, 1.30, 1.375, 1.50, 2.00],
  pCritical: 1.375,
  meshes: ['h=0.125', 'h=0.083', 'h=0.056', 'h=0.037', 'h=0.025'],
  data: {
    1.05: [4.400, 4.906, 5.318, 5.653, 5.950],
    1.10: [4.038, 4.513, 4.907, 5.245, 5.567],
    1.20: [3.504, 3.940, 4.323, 4.690, 5.084],
    1.30: [3.141, 3.566, 3.965, 4.391, 4.896],
    1.375:[2.946, 3.376, 3.805, 4.298, 4.920],
    1.50: [2.724, 3.190, 3.705, 4.368, 5.275],
    2.00: [2.596, 3.581, 5.154, 7.833, 12.235]
  }
};

// --- Singularity coefficients ---
var singData = [
  {deg:195, lt:0.9231, lf:0.8881, c:0.339},
  {deg:200, lt:0.9000, lf:0.8671, c:0.338},
  {deg:205, lt:0.8780, lf:0.8471, c:0.336},
  {deg:210, lt:0.8571, lf:0.8280, c:0.335},
  {deg:215, lt:0.8372, lf:0.8098, c:0.334},
  {deg:220, lt:0.8182, lf:0.7923, c:0.332},
  {deg:225, lt:0.8000, lf:0.7757, c:0.331},
  {deg:230, lt:0.7826, lf:0.7597, c:0.330},
  {deg:235, lt:0.7660, lf:0.7444, c:0.330},
  {deg:240, lt:0.7500, lf:0.7298, c:0.329},
  {deg:245, lt:0.7347, lf:0.7158, c:0.328},
  {deg:250, lt:0.7200, lf:0.7024, c:0.327},
  {deg:255, lt:0.7059, lf:0.6895, c:0.327},
  {deg:260, lt:0.6923, lf:0.6771, c:0.326},
  {deg:265, lt:0.6792, lf:0.6652, c:0.325},
  {deg:270, lt:0.6667, lf:0.6537, c:0.325},
  {deg:275, lt:0.6545, lf:0.6427, c:0.324},
  {deg:280, lt:0.6429, lf:0.6321, c:0.324},
  {deg:285, lt:0.6316, lf:0.6220, c:0.323},
  {deg:290, lt:0.6207, lf:0.6121, c:0.323},
  {deg:295, lt:0.6102, lf:0.6027, c:0.323},
  {deg:300, lt:0.6000, lf:0.5936, c:0.322},
  {deg:305, lt:0.5902, lf:0.5848, c:0.322},
  {deg:310, lt:0.5806, lf:0.5763, c:0.322},
  {deg:315, lt:0.5714, lf:0.5681, c:0.322},
  {deg:320, lt:0.5625, lf:0.5602, c:0.321},
  {deg:325, lt:0.5538, lf:0.5526, c:0.321},
  {deg:330, lt:0.5455, lf:0.5452, c:0.321},
  {deg:335, lt:0.5373, lf:0.5381, c:0.321},
  {deg:340, lt:0.5294, lf:0.5312, c:0.321},
  {deg:345, lt:0.5217, lf:0.5245, c:0.321},
  {deg:350, lt:0.5143, lf:0.5181, c:0.320}
];

// --- 3D Kondratiev exponents (selected) ---
var kondratiev3D = [
  {a:14,nu:9.338},{a:20,nu:6.383},{a:25,nu:5.004},{a:30,nu:4.084},
  {a:35,nu:3.426},{a:40,nu:2.932},{a:45,nu:2.548},{a:50,nu:2.240},
  {a:55,nu:1.988},{a:60,nu:1.777},{a:65,nu:1.599},{a:70,nu:1.446},
  {a:75,nu:1.312},{a:80,nu:1.196},{a:85,nu:1.092},{a:90,nu:1.000},
  {a:95,nu:0.917},{a:100,nu:0.842},{a:105,nu:0.774},{a:110,nu:0.712},
  {a:115,nu:0.654},{a:120,nu:0.602},{a:125,nu:0.552},{a:130,nu:0.506},
  {a:135,nu:0.463},{a:140,nu:0.422},{a:145,nu:0.383},{a:150,nu:0.346},
  {a:155,nu:0.310},{a:160,nu:0.275},{a:165,nu:0.239},{a:170,nu:0.201},
  {a:175,nu:0.158},{a:179,nu:0.105}
];

var kondratiev3D_pstar = kondratiev3D
  .filter(function(d) { return d.nu < 2; })
  .map(function(d) { return { a: d.a, pstar: 3 / (2 - d.nu) }; });

// ===================================================================
// CHART DEFAULTS
// ===================================================================
Chart.defaults.font.family = "'Helvetica Neue', Arial, sans-serif";
Chart.defaults.font.size = 12;
Chart.defaults.color = '#475569';

var COLORS = {
  blue: '#2563eb',
  red: '#dc2626',
  green: '#059669',
  purple: '#7c3aed',
  orange: '#ea580c',
  gray: '#94a3b8',
  blueAlpha: 'rgba(37,99,235,0.12)',
  redAlpha: 'rgba(220,38,38,0.12)',
  greenAlpha: 'rgba(5,150,105,0.12)'
};

// ===================================================================
// 1. Interactive Explorer
// ===================================================================
var explorerCtx = document.getElementById('explorerChart').getContext('2d');

// Build full curve data
var expCurveAngles = [];
var expCurvePstar = [];
for (var d = 181; d <= 359; d++) {
  expCurveAngles.push(d);
  var om = d * Math.PI / 180;
  expCurvePstar.push(2 / (2 - Math.PI / om));
}

var explorerChart = new Chart(explorerCtx, {
  type: 'line',
  data: {
    labels: expCurveAngles,
    datasets: [
      {
        label: 'p*(omega) critical curve',
        data: expCurvePstar,
        borderColor: COLORS.blue,
        backgroundColor: COLORS.blueAlpha,
        fill: true,
        pointRadius: 0,
        borderWidth: 2,
        tension: 0.3
      },
      {
        label: 'Selected angle',
        data: expCurveAngles.map(function() { return null; }),
        pointRadius: 0,
        borderColor: COLORS.red,
        borderWidth: 2,
        borderDash: [6, 3],
        pointStyle: 'circle'
      },
      {
        label: 'p = N/2 = 1 (Tanaka 2D)',
        data: expCurveAngles.map(function() { return 1; }),
        borderColor: COLORS.green,
        borderWidth: 1.5,
        borderDash: [4, 4],
        pointRadius: 0,
        fill: false
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      title: { display: true, text: 'Critical Exponent p* vs Corner Angle -- Interactive', font: { size: 14 } },
      legend: { position: 'top', labels: { boxWidth: 14 } }
    },
    scales: {
      x: { title: { display: true, text: 'Corner angle omega (degrees)' }, min: 181, max: 359 },
      y: { title: { display: true, text: 'p*' }, min: 1, max: 5, ticks: { stepSize: 0.5 } }
    },
    animation: { duration: 150 }
  }
});

function updateExplorer(deg) {
  var omega = deg * Math.PI / 180;
  var lam = Math.PI / omega;
  var pstar = 2 / (2 - lam);

  document.getElementById('angle-readout').textContent = deg + ' deg';
  document.getElementById('out-lambda').textContent = lam.toFixed(4);
  document.getElementById('out-pstar').textContent = pstar.toFixed(4);
  document.getElementById('out-pstar').style.color = pstar >= 2 ? 'var(--accent3)' : 'var(--accent2)';
  document.getElementById('out-w22').textContent = pstar >= 2 ? 'Yes' : 'No';
  document.getElementById('out-w22').style.color = pstar >= 2 ? 'var(--accent3)' : 'var(--accent2)';
  document.getElementById('out-tanaka').textContent = pstar > 1 ? 'Yes' : 'No';
  document.getElementById('out-tanaka').style.color = pstar > 1 ? 'var(--accent3)' : 'var(--accent2)';
  document.getElementById('out-window').textContent = '(1, ' + pstar.toFixed(3) + ')';

  // Update vertical line on chart
  var markerData = expCurveAngles.map(function(a) { return a === deg ? pstar : null; });
  explorerChart.data.datasets[1].data = markerData;

  // Add a visible point
  var idx = deg - 181;
  var pointRadii = expCurveAngles.map(function() { return 0; });
  if (idx >= 0 && idx < pointRadii.length) pointRadii[idx] = 8;
  explorerChart.data.datasets[1].pointRadius = pointRadii;

  explorerChart.update('none');
}

document.getElementById('angle-slider').addEventListener('input', function() {
  updateExplorer(parseInt(this.value));
});
updateExplorer(270);

// ===================================================================
// 2. 2D Critical Exponent Curve
// ===================================================================
var crit2dCtx = document.getElementById('critical2dChart').getContext('2d');

// Build a denser data set for the full range (convex + re-entrant)
var fullAngles = [];
var fullPstar = [];
for (var d = 10; d <= 180; d += 5) {
  fullAngles.push(d);
  fullPstar.push(10); // capped to show "infinity"
}
for (var d = 181; d <= 359; d++) {
  fullAngles.push(d);
  var om = d * Math.PI / 180;
  fullPstar.push(2 / (2 - Math.PI / om));
}

new Chart(crit2dCtx, {
  type: 'line',
  data: {
    labels: fullAngles,
    datasets: [
      {
        label: 'p*(omega)',
        data: fullPstar,
        borderColor: COLORS.blue,
        backgroundColor: COLORS.blueAlpha,
        fill: true,
        pointRadius: 0,
        borderWidth: 2.5,
        tension: 0.2
      },
      {
        label: 'p = 2 (H^2 regularity)',
        data: fullAngles.map(function() { return 2; }),
        borderColor: COLORS.orange,
        borderDash: [6, 3],
        borderWidth: 1.5,
        pointRadius: 0,
        fill: false
      },
      {
        label: 'p = 1 (Tanaka 2D threshold)',
        data: fullAngles.map(function() { return 1; }),
        borderColor: COLORS.green,
        borderDash: [4, 4],
        borderWidth: 1.5,
        pointRadius: 0,
        fill: false
      },
      {
        label: 'L-shape (270 deg)',
        data: fullAngles.map(function(a) { return a === 270 ? 1.5 : null; }),
        pointRadius: fullAngles.map(function(a) { return a === 270 ? 7 : 0; }),
        pointBackgroundColor: COLORS.red,
        borderColor: COLORS.red,
        showLine: false
      },
      {
        label: 'Severe (330 deg)',
        data: fullAngles.map(function(a) { return a === 330 ? 1.375 : null; }),
        pointRadius: fullAngles.map(function(a) { return a === 330 ? 7 : 0; }),
        pointBackgroundColor: COLORS.purple,
        borderColor: COLORS.purple,
        showLine: false
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      title: { display: true, text: 'Critical W^{2,p} Exponent for 2D Corners', font: { size: 14 } },
      legend: { position: 'top', labels: { boxWidth: 14, font: { size: 11 } } }
    },
    scales: {
      x: { title: { display: true, text: 'Corner angle omega (degrees)' } },
      y: { title: { display: true, text: 'p*' }, min: 1, max: 10, ticks: { stepSize: 1 } }
    }
  }
});

// ===================================================================
// 3. Convergence Charts
// ===================================================================
function makeConvergenceChart(canvasId, convData, title) {
  var ctx = document.getElementById(canvasId).getContext('2d');
  var datasets = convData.pValues.map(function(p, i) {
    var isBelowCrit = p < convData.pCritical;
    var isAtCrit = Math.abs(p - convData.pCritical) < 0.001;
    var color, dash;
    if (isAtCrit) { color = COLORS.orange; dash = [6, 3]; }
    else if (isBelowCrit) {
      var blues = ['#3b82f6', '#60a5fa', '#93c5fd', '#2563eb', '#1d4ed8'];
      color = blues[i % blues.length]; dash = [];
    } else {
      var reds = ['#f87171', '#ef4444', '#dc2626', '#b91c1c'];
      color = reds[i % reds.length]; dash = [5, 3];
    }
    return {
      label: 'p = ' + p,
      data: convData.data[p],
      borderColor: color,
      borderDash: dash,
      borderWidth: 2,
      pointRadius: 4,
      pointBackgroundColor: color,
      tension: 0.2
    };
  });

  new Chart(ctx, {
    type: 'line',
    data: {
      labels: convData.meshes,
      datasets: datasets
    },
    options: {
      responsive: true,
      plugins: {
        title: { display: true, text: title, font: { size: 14 } },
        legend: { position: 'right', labels: { boxWidth: 14, font: { size: 11 } } }
      },
      scales: {
        x: { title: { display: true, text: 'Mesh size h' } },
        y: {
          type: 'logarithmic',
          title: { display: true, text: 'W^{2,p} seminorm (log scale)' },
          min: 1
        }
      }
    }
  });
}
makeConvergenceChart('conv270Chart', conv270, 'Mesh Convergence: L-Shape (omega=270 deg, p*=1.50)');
makeConvergenceChart('conv330Chart', conv330, 'Mesh Convergence: Severe Re-entrant (omega=330 deg, p*=1.375)');

// ===================================================================
// 4. Singularity Coefficients
// ===================================================================
var seCtx = document.getElementById('singExpChart').getContext('2d');
new Chart(seCtx, {
  type: 'scatter',
  data: {
    datasets: [
      {
        label: 'Theory: lambda_1 = pi/omega',
        data: singData.map(function(d) { return { x: d.deg, y: d.lt }; }),
        borderColor: COLORS.blue,
        backgroundColor: COLORS.blueAlpha,
        showLine: true,
        borderWidth: 2,
        pointRadius: 0,
        tension: 0.3
      },
      {
        label: 'Fitted lambda_1 (FEM)',
        data: singData.map(function(d) { return { x: d.deg, y: d.lf }; }),
        borderColor: COLORS.red,
        backgroundColor: COLORS.red,
        showLine: false,
        pointRadius: 5,
        pointStyle: 'rectRot'
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      title: { display: true, text: 'Kondratiev Exponent: Theory vs FEM', font: { size: 13 } },
      legend: { position: 'top', labels: { boxWidth: 14, font: { size: 11 } } }
    },
    scales: {
      x: { title: { display: true, text: 'Corner angle omega (deg)' }, min: 190, max: 355 },
      y: { title: { display: true, text: 'lambda_1' }, min: 0.4, max: 1.0 }
    }
  }
});

var scCtx = document.getElementById('singCoeffChart').getContext('2d');
new Chart(scCtx, {
  type: 'scatter',
  data: {
    datasets: [{
      label: '|c_1| (singularity coefficient)',
      data: singData.map(function(d) { return { x: d.deg, y: d.c }; }),
      borderColor: COLORS.purple,
      backgroundColor: 'rgba(124,58,237,0.3)',
      showLine: true,
      pointRadius: 4,
      borderWidth: 2,
      tension: 0.3
    }]
  },
  options: {
    responsive: true,
    plugins: {
      title: { display: true, text: 'Singularity Coefficient |c_1| vs Corner Angle', font: { size: 13 } },
      legend: { display: false }
    },
    scales: {
      x: { title: { display: true, text: 'Corner angle omega (deg)' }, min: 190, max: 355 },
      y: { title: { display: true, text: '|c_1|' }, min: 0.31, max: 0.35 }
    }
  }
});

// ===================================================================
// 5. 3D Charts
// ===================================================================
var d3eCtx = document.getElementById('dim3ExpChart').getContext('2d');
new Chart(d3eCtx, {
  type: 'scatter',
  data: {
    datasets: [
      {
        label: 'nu_1 (Kondratiev exponent)',
        data: kondratiev3D.map(function(d) { return { x: d.a, y: d.nu }; }),
        borderColor: COLORS.blue,
        backgroundColor: COLORS.blueAlpha,
        showLine: true,
        pointRadius: 3,
        borderWidth: 2,
        tension: 0.3
      },
      {
        label: 'nu = 1 (H^2 threshold)',
        data: [{ x: 14, y: 1 }, { x: 179, y: 1 }],
        borderColor: COLORS.orange,
        borderDash: [6, 3],
        showLine: true,
        pointRadius: 0,
        borderWidth: 1.5
      },
      {
        label: 'nu = 2 (full regularity)',
        data: [{ x: 14, y: 2 }, { x: 179, y: 2 }],
        borderColor: COLORS.green,
        borderDash: [4, 4],
        showLine: true,
        pointRadius: 0,
        borderWidth: 1.5
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      title: { display: true, text: '3D Kondratiev Exponent nu_1 vs Cone Half-Angle', font: { size: 13 } },
      legend: { position: 'top', labels: { boxWidth: 14, font: { size: 10 } } }
    },
    scales: {
      x: { title: { display: true, text: 'Half-angle alpha (deg)' }, min: 10, max: 180 },
      y: { title: { display: true, text: 'nu_1' }, min: 0, max: 10 }
    }
  }
});

var d3pCtx = document.getElementById('dim3PstarChart').getContext('2d');
new Chart(d3pCtx, {
  type: 'scatter',
  data: {
    datasets: [
      {
        label: 'p* = 3/(2 - nu_1)',
        data: kondratiev3D_pstar.map(function(d) { return { x: d.a, y: Math.min(d.pstar, 50) }; }),
        borderColor: COLORS.blue,
        backgroundColor: COLORS.blueAlpha,
        showLine: true,
        pointRadius: 3,
        borderWidth: 2,
        tension: 0.3
      },
      {
        label: 'p = 3/2 (Tanaka 3D)',
        data: [{ x: 55, y: 1.5 }, { x: 179, y: 1.5 }],
        borderColor: COLORS.green,
        borderDash: [6, 3],
        showLine: true,
        pointRadius: 0,
        borderWidth: 1.5
      },
      {
        label: 'p = 2 (H^2)',
        data: [{ x: 55, y: 2 }, { x: 179, y: 2 }],
        borderColor: COLORS.orange,
        borderDash: [4, 4],
        showLine: true,
        pointRadius: 0,
        borderWidth: 1.5
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      title: { display: true, text: '3D Critical p* vs Cone Half-Angle (re-entrant only)', font: { size: 13 } },
      legend: { position: 'top', labels: { boxWidth: 14, font: { size: 10 } } }
    },
    scales: {
      x: { title: { display: true, text: 'Half-angle alpha (deg)' }, min: 55, max: 179 },
      y: { title: { display: true, text: 'p*' }, min: 1, max: 15 }
    }
  }
});

// ===================================================================
// 6. Phase Diagram (canvas-based heatmap)
// ===================================================================
var phaseCtx = document.getElementById('phaseChart').getContext('2d');

// Build phase data
var phaseAngles = [];
for (var d = 91; d < 360; d += 3) phaseAngles.push(d);
var phasePvals = [];
for (var i = 0; i < 60; i++) phasePvals.push(1.0 + i * (4.0 / 59));

// Build scatter data
var phaseRegular = [];
var phaseSingular = [];

phaseAngles.forEach(function(deg) {
  var omega = deg * Math.PI / 180;
  var lam = Math.PI / omega;
  var pstar;
  if (deg <= 180) pstar = 100;
  else pstar = 2 / (2 - lam);

  phasePvals.forEach(function(p) {
    if (p < pstar - 0.1) phaseRegular.push({ x: deg, y: p });
    else if (p > pstar + 0.1) phaseSingular.push({ x: deg, y: p });
  });
});

// Build boundary curve
var bAngles = [];
var bPstar = [];
for (var d = 181; d <= 359; d++) {
  bAngles.push(d);
  var om = d * Math.PI / 180;
  bPstar.push(2 / (2 - Math.PI / om));
}

new Chart(phaseCtx, {
  type: 'scatter',
  data: {
    datasets: [
      {
        label: 'W^{2,p} holds (Regular)',
        data: phaseRegular,
        backgroundColor: 'rgba(37,99,235,0.18)',
        pointRadius: 3.2,
        pointStyle: 'rect',
        borderWidth: 0
      },
      {
        label: 'W^{2,p} fails (Singular)',
        data: phaseSingular,
        backgroundColor: 'rgba(220,38,38,0.15)',
        pointRadius: 3.2,
        pointStyle: 'rect',
        borderWidth: 0
      },
      {
        label: 'p = p*(omega) boundary',
        data: bAngles.map(function(a, i) { return { x: a, y: bPstar[i] }; }),
        borderColor: '#0f172a',
        backgroundColor: 'transparent',
        showLine: true,
        pointRadius: 0,
        borderWidth: 2.5,
        tension: 0.3
      },
      {
        label: 'p = 2 (H^2)',
        data: [{ x: 91, y: 2 }, { x: 359, y: 2 }],
        borderColor: COLORS.orange,
        borderDash: [8, 4],
        showLine: true,
        pointRadius: 0,
        borderWidth: 1.5
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      title: { display: true, text: 'Regularity Phase Diagram: (omega, p) Plane', font: { size: 14 } },
      legend: { position: 'top', labels: { boxWidth: 14, font: { size: 11 } } }
    },
    scales: {
      x: { title: { display: true, text: 'Corner angle omega (degrees)' }, min: 90, max: 360 },
      y: { title: { display: true, text: 'Sobolev exponent p' }, min: 1, max: 5 }
    }
  }
});

// ===================================================================
// 7. Phase diagram interactive p0 slider
// ===================================================================
function updateP0(p0) {
  document.getElementById('p0-readout').textContent = 'p0 = ' + p0.toFixed(2);

  // Solve p* = p0 for omega: p0 = 2/(2 - pi/omega) => omega = pi / (2 - 2/p0)
  var denom = 2 - 2 / p0;
  var omegaMax;
  if (denom <= 0) {
    omegaMax = 180;
    document.getElementById('out-omax').textContent = '<= 180 deg (convex only)';
  } else {
    omegaMax = (Math.PI / denom) * 180 / Math.PI;
    if (omegaMax > 360) omegaMax = 360;
    document.getElementById('out-omax').textContent = omegaMax.toFixed(1) + ' deg';
  }

  var interp;
  if (p0 >= 2) interp = 'Only convex corners (omega <= 180 deg) support W^{2,p} for p >= ' + p0.toFixed(1);
  else if (omegaMax >= 359) interp = 'All non-crack domains support this p';
  else interp = 'Domains with max corner omega < ' + omegaMax.toFixed(0) + ' deg support p = ' + p0.toFixed(2);
  document.getElementById('out-interp').textContent = interp;
}

document.getElementById('p0-slider').addEventListener('input', function() {
  updateP0(parseFloat(this.value));
});
updateP0(2.0);

// ===================================================================
// 8. Tab switching
// ===================================================================
document.querySelectorAll('.tab-btn').forEach(function(btn) {
  btn.addEventListener('click', function() {
    var tab = this.dataset.tab;
    document.querySelectorAll('.tab-btn').forEach(function(b) { b.classList.remove('active'); });
    document.querySelectorAll('.tab-content').forEach(function(c) { c.classList.remove('active'); });
    this.classList.add('active');
    document.getElementById('tab-' + tab).classList.add('active');
  });
});

// ===================================================================
// 9. Navigation highlighting
// ===================================================================
var sections = document.querySelectorAll('section[id]');
var navLinks = document.querySelectorAll('nav.toc a');

var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) {
    if (entry.isIntersecting) {
      navLinks.forEach(function(l) { l.classList.remove('active'); });
      var link = document.querySelector('nav.toc a[href="#' + entry.target.id + '"]');
      if (link) link.classList.add('active');
    }
  });
}, { rootMargin: '-30% 0px -60% 0px' });

sections.forEach(function(s) { observer.observe(s); });
</script>
</body>
</html>
