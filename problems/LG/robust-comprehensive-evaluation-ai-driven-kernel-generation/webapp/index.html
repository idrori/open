<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KernelEval: Robust Evaluation for AI-Driven Kernel Generation</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<style>
  :root { --primary: #1a3a5c; --accent: #2980b9; --bg: #f5f7fa; --card: #ffffff; --text: #2c3e50; --border: #dce1e8; --success: #27ae60; --warn: #e67e22; --danger: #e74c3c; }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }
  .header { background: linear-gradient(135deg, var(--primary), var(--accent)); color: #fff; padding: 2rem; text-align: center; }
  .header h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
  .header p { opacity: 0.9; font-size: 0.95rem; max-width: 700px; margin: 0 auto; }
  .container { max-width: 1200px; margin: 0 auto; padding: 1.5rem; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
  .card { background: var(--card); border-radius: 8px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border: 1px solid var(--border); }
  .card h2 { font-size: 1.1rem; color: var(--primary); margin-bottom: 1rem; border-bottom: 2px solid var(--accent); padding-bottom: 0.5rem; }
  .full-width { grid-column: 1 / -1; }
  .chart-container { position: relative; height: 350px; }
  .metric-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
  .metric-box { background: var(--card); border-radius: 8px; padding: 1rem; text-align: center; border: 1px solid var(--border); box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
  .metric-box .value { font-size: 1.8rem; font-weight: 700; color: var(--accent); }
  .metric-box .label { font-size: 0.8rem; color: #666; margin-top: 0.25rem; }
  .metric-box .delta { font-size: 0.85rem; font-weight: 600; }
  .formula { background: #f0f4f8; border-left: 3px solid var(--accent); padding: 0.75rem 1rem; margin: 0.5rem 0 1rem; font-family: 'Courier New', monospace; font-size: 0.9rem; border-radius: 0 4px 4px 0; }
  table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
  th, td { padding: 0.5rem 0.75rem; text-align: left; border-bottom: 1px solid var(--border); }
  th { background: var(--primary); color: #fff; }
  @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } .metric-grid { grid-template-columns: repeat(2, 1fr); } }
</style>
</head>
<body>
<div class="header">
  <h1>KernelEval: Robust Evaluation for AI-Driven Kernel Generation</h1>
  <p>A comprehensive framework evaluating shape robustness, operator coverage, and hardware portability for GPU kernel generators.</p>
</div>
<div class="container">
  <div class="formula">Composite Score = Median_Speedup x (1 - Shape_CV) x Operator_Coverage x Hardware_Portability</div>
  <div class="metric-grid">
    <div class="metric-box"><div class="value">3</div><div class="label">Evaluation Axes</div><div class="delta" style="color:#2980b9">Shape, Operator, Hardware</div></div>
    <div class="metric-box"><div class="value">8</div><div class="label">Shape Categories</div><div class="delta" style="color:#27ae60">Tiny to Large, P2/Non-P2</div></div>
    <div class="metric-box"><div class="value">7</div><div class="label">Operator Categories</div><div class="delta" style="color:#e67e22">Forward + Backward</div></div>
    <div class="metric-box"><div class="value">4</div><div class="label">Hardware Backends</div><div class="delta" style="color:#2980b9">CUDA, ROCm, Metal, CPU</div></div>
  </div>
  <div class="grid">
    <div class="card">
      <h2>Composite Score Comparison</h2>
      <div class="chart-container"><canvas id="chartComposite"></canvas></div>
    </div>
    <div class="card">
      <h2>Score Component Breakdown</h2>
      <div class="chart-container"><canvas id="chartRadar"></canvas></div>
    </div>
    <div class="card">
      <h2>Shape Robustness: Speedup by Category</h2>
      <div class="chart-container"><canvas id="chartShape"></canvas></div>
    </div>
    <div class="card">
      <h2>Operator Coverage: Forward vs Backward</h2>
      <div class="chart-container"><canvas id="chartOperator"></canvas></div>
    </div>
    <div class="card full-width">
      <h2>Hardware Portability: Relative Performance</h2>
      <div class="chart-container"><canvas id="chartHardware"></canvas></div>
    </div>
    <div class="card full-width">
      <h2>Detailed Generator Comparison</h2>
      <table>
        <thead><tr><th>Generator</th><th>Median Speedup</th><th>Shape CV</th><th>Robustness (1-CV)</th><th>Op Coverage</th><th>HW Portability</th><th>Composite</th></tr></thead>
        <tbody>
          <tr><td>Baseline</td><td>1.05x</td><td>0.15</td><td>0.85</td><td>0.85</td><td>0.75</td><td>0.420</td></tr>
          <tr><td>Fragile</td><td>1.40x</td><td>0.65</td><td>0.35</td><td>0.70</td><td>0.50</td><td style="color:#e74c3c;font-weight:bold">0.240</td></tr>
          <tr><td>Robust</td><td>1.20x</td><td>0.10</td><td>0.90</td><td>0.90</td><td>0.75</td><td style="color:#27ae60;font-weight:bold">0.520</td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
<script>
const gens=['Baseline','Fragile','Robust'];
const colors=['#2980b9','#e74c3c','#27ae60'];

new Chart(document.getElementById('chartComposite'),{
  type:'bar',data:{labels:gens,datasets:[{label:'Composite Score',data:[0.420,0.240,0.520],backgroundColor:colors.map(c=>c+'BB'),borderColor:colors,borderWidth:2}]},
  options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{y:{min:0,max:0.7,title:{display:true,text:'Composite Score'}}}}
});

new Chart(document.getElementById('chartRadar'),{
  type:'radar',data:{labels:['Speedup (norm)','Shape Robust.','Op Coverage','HW Portability'],
  datasets:[
    {label:'Baseline',data:[0.75,0.85,0.85,0.75],borderColor:'#2980b9',backgroundColor:'rgba(41,128,185,0.1)',borderWidth:2},
    {label:'Fragile',data:[1.0,0.35,0.70,0.50],borderColor:'#e74c3c',backgroundColor:'rgba(231,76,60,0.1)',borderWidth:2},
    {label:'Robust',data:[0.86,0.90,0.90,0.75],borderColor:'#27ae60',backgroundColor:'rgba(39,174,96,0.1)',borderWidth:2}
  ]},options:{responsive:true,maintainAspectRatio:false,scales:{r:{min:0,max:1}}}
});

const shapeCats=['Tiny','Small','Medium','Large','Power-of-2','Non-P2','Rect','Square'];
new Chart(document.getElementById('chartShape'),{
  type:'bar',data:{labels:shapeCats,datasets:[
    {label:'Baseline',data:[1.0,1.05,1.08,1.02,1.10,0.98,1.03,1.06],backgroundColor:'rgba(41,128,185,0.6)'},
    {label:'Fragile',data:[0.7,1.0,1.3,1.5,1.8,0.7,0.9,1.6],backgroundColor:'rgba(231,76,60,0.6)'},
    {label:'Robust',data:[1.1,1.15,1.22,1.18,1.25,1.15,1.18,1.20],backgroundColor:'rgba(39,174,96,0.6)'}
  ]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{title:{display:true,text:'Speedup (x)'}}}}
});

const opCats=['Element','Reduce','GEMM','Conv','Norm','Attention','Fused'];
new Chart(document.getElementById('chartOperator'),{
  type:'bar',data:{labels:opCats,datasets:[
    {label:'Forward Coverage',data:[95,95,90,85,90,70,60],backgroundColor:'rgba(41,128,185,0.7)'},
    {label:'Backward Coverage',data:[90,80,75,60,70,50,40],backgroundColor:'rgba(230,126,34,0.7)'}
  ]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{max:100,title:{display:true,text:'Coverage (%)'}}}}
});

new Chart(document.getElementById('chartHardware'),{
  type:'bar',data:{labels:['CUDA','ROCm','Metal','CPU'],datasets:[
    {label:'Baseline',data:[1.0,0.70,0.55,0.30],backgroundColor:'rgba(41,128,185,0.6)'},
    {label:'Fragile',data:[1.0,0.40,0.30,0.20],backgroundColor:'rgba(231,76,60,0.6)'},
    {label:'Robust',data:[1.0,0.75,0.60,0.35],backgroundColor:'rgba(39,174,96,0.6)'}
  ]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{title:{display:true,text:'Relative Performance (vs CUDA)'}}}}
});
</script>
</body>
</html>
