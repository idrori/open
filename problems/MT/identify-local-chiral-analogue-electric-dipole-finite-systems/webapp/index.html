<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Local Chiral Analogue of the Electric Dipole</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7"></script>
<style>
  :root {
    --primary: #1a3a5c;
    --primary-light: #2c5f8a;
    --accent: #2980b9;
    --accent-light: #3498db;
    --success: #27ae60;
    --danger: #e74c3c;
    --warn: #f39c12;
    --bg: #f8f9fa;
    --card-bg: #ffffff;
    --text: #2c3e50;
    --text-light: #7f8c8d;
    --border: #e0e6ed;
    --shadow: 0 2px 12px rgba(0,0,0,0.08);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
  }

  .hero {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 50%, var(--accent) 100%);
    color: white;
    padding: 3rem 2rem;
    text-align: center;
  }

  .hero h1 {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
    line-height: 1.3;
  }

  .hero .subtitle {
    font-size: 1.1rem;
    opacity: 0.9;
    max-width: 700px;
    margin: 0 auto 1.5rem;
  }

  .hero .formula {
    font-size: 1.4rem;
    font-family: 'Georgia', serif;
    font-style: italic;
    background: rgba(255,255,255,0.15);
    display: inline-block;
    padding: 0.6rem 1.5rem;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.3);
  }

  .hero .meta-badges {
    margin-top: 1.2rem;
    display: flex;
    gap: 0.75rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .badge {
    display: inline-block;
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
  }

  .badge-accent { background: rgba(255,255,255,0.2); color: white; }
  .badge-success { background: var(--success); color: white; }
  .badge-warn { background: var(--warn); color: white; }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  .section {
    margin: 2.5rem 0;
  }

  .section h2 {
    font-size: 1.5rem;
    color: var(--primary);
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 3px solid var(--accent);
    display: inline-block;
  }

  .section p {
    margin-bottom: 1rem;
    color: var(--text);
    max-width: 800px;
  }

  .grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-top: 1.5rem;
  }

  .grid-3 {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 1.5rem;
    margin-top: 1.5rem;
  }

  .card {
    background: var(--card-bg);
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
  }

  .card h3 {
    font-size: 1.1rem;
    color: var(--primary);
    margin-bottom: 0.75rem;
  }

  .chart-container {
    position: relative;
    width: 100%;
    height: 320px;
  }

  .card.full-width {
    grid-column: 1 / -1;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
  }

  th {
    background: var(--primary);
    color: white;
    padding: 0.7rem 0.5rem;
    text-align: left;
    font-weight: 600;
  }

  td {
    padding: 0.6rem 0.5rem;
    border-bottom: 1px solid var(--border);
  }

  tr:nth-child(even) { background: #f0f4f8; }
  tr:hover { background: #e3edf6; }

  .pass { color: var(--success); font-weight: 700; }
  .fail { color: var(--danger); font-weight: 700; }
  .zero { color: var(--text-light); }
  .positive { color: var(--accent); font-weight: 600; }
  .negative { color: var(--danger); font-weight: 600; }

  .insight-box {
    background: linear-gradient(135deg, #eef6fc, #f0faf0);
    border-left: 4px solid var(--accent);
    padding: 1.2rem 1.5rem;
    border-radius: 0 8px 8px 0;
    margin: 1.5rem 0;
  }

  .insight-box h4 {
    color: var(--primary);
    margin-bottom: 0.5rem;
  }

  .method-steps {
    display: flex;
    gap: 1rem;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    margin: 1.5rem 0;
  }

  .method-step {
    background: var(--card-bg);
    border: 2px solid var(--accent);
    border-radius: 12px;
    padding: 1rem 1.2rem;
    text-align: center;
    min-width: 180px;
    box-shadow: var(--shadow);
  }

  .method-step .label {
    font-size: 0.8rem;
    color: var(--text-light);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .method-step .formula-sm {
    font-family: 'Georgia', serif;
    font-style: italic;
    font-size: 1rem;
    color: var(--primary);
    margin-top: 0.3rem;
  }

  .arrow {
    font-size: 1.5rem;
    color: var(--accent);
    font-weight: 700;
  }

  .result-box {
    background: linear-gradient(135deg, var(--primary), var(--accent));
    color: white;
    border-radius: 12px;
    padding: 1.2rem 1.5rem;
    text-align: center;
    min-width: 220px;
    box-shadow: 0 4px 16px rgba(41,128,185,0.3);
  }

  .result-box .label { font-size: 0.8rem; opacity: 0.9; text-transform: uppercase; }
  .result-box .formula-lg {
    font-family: 'Georgia', serif;
    font-style: italic;
    font-size: 1.3rem;
    margin-top: 0.3rem;
  }

  footer {
    background: var(--primary);
    color: rgba(255,255,255,0.8);
    text-align: center;
    padding: 1.5rem;
    margin-top: 3rem;
    font-size: 0.85rem;
  }

  footer a { color: var(--accent-light); text-decoration: none; }
  footer a:hover { text-decoration: underline; }

  @media (max-width: 768px) {
    .hero h1 { font-size: 1.5rem; }
    .grid-2, .grid-3 { grid-template-columns: 1fr; }
    .method-steps { flex-direction: column; }
    .arrow { transform: rotate(90deg); }
    .hero .formula { font-size: 1.1rem; padding: 0.4rem 1rem; }
  }
</style>
</head>
<body>

<!-- Hero Section -->
<div class="hero">
  <h1>Identifying the Local Chiral Analogue<br>of the Electric Dipole in Finite Systems</h1>
  <p class="subtitle">
    A multi-channel dipole coupling approach to constructing a pseudoscalar chirality
    order parameter for finite molecular and atomic systems.
  </p>
  <div class="formula">&chi; = p&#x2081; &middot; (p&#x2082; &times; p&#x2083;)</div>
  <div class="meta-badges">
    <span class="badge badge-accent">Materials Science (cond-mat.mtrl-sci)</span>
    <span class="badge badge-accent">arXiv: 2601.16042</span>
    <span class="badge badge-success">8 Structures Tested</span>
    <span class="badge badge-warn">500 Rotation Trials</span>
  </div>
</div>

<div class="container">

  <!-- Method Overview -->
  <div class="section">
    <h2>Method: Multi-Channel Dipole Coupling</h2>
    <p>
      A pseudoscalar cannot be formed from a single vector field. The key insight is that
      three independent polar vectors, combined via a triple scalar product, naturally yield
      a pseudoscalar with the correct transformation properties under O(3).
    </p>
    <div class="method-steps">
      <div class="method-step">
        <div class="label">Channel 1: Geometric</div>
        <div class="formula-sm">p&#x2081; = &Sigma; r&#x1D62;</div>
      </div>
      <span class="arrow">+</span>
      <div class="method-step">
        <div class="label">Channel 2: Mass-weighted</div>
        <div class="formula-sm">p&#x2082; = &Sigma; m&#x1D62; r&#x1D62;</div>
      </div>
      <span class="arrow">+</span>
      <div class="method-step">
        <div class="label">Channel 3: Radial-moment</div>
        <div class="formula-sm">p&#x2083; = &Sigma; |r&#x1D62;|&sup2; r&#x1D62;</div>
      </div>
      <span class="arrow">&rarr;</span>
      <div class="result-box">
        <div class="label">Chirality Pseudoscalar</div>
        <div class="formula-lg">&chi; = p&#x2081; &middot; (p&#x2082; &times; p&#x2083;)</div>
      </div>
    </div>
  </div>

  <!-- Chirality Values Table -->
  <div class="section">
    <h2>Chirality Values Across Test Structures</h2>
    <div class="card full-width">
      <table>
        <thead>
          <tr>
            <th>Structure</th>
            <th>N</th>
            <th>&chi;<sub>TP</sub> (Triple Product)</th>
            <th>&chi;<sub>CM</sub> (Chiral Multipole)</th>
            <th>&chi;<sub>Full</sub> (Extended)</th>
            <th>S<sub>CSM</sub></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>CHFClBr (L)</td><td>5</td>
            <td class="negative">-4.800</td>
            <td class="zero">0.000</td>
            <td class="zero">0.000</td>
            <td>1.333</td>
          </tr>
          <tr>
            <td>CHFClBr (R)</td><td>5</td>
            <td class="positive">+4.800</td>
            <td class="zero">0.000</td>
            <td class="zero">0.000</td>
            <td>1.333</td>
          </tr>
          <tr>
            <td>CH&#x2082;F&#x2082; (achiral)</td><td>5</td>
            <td class="negative">-0.308</td>
            <td class="zero">0.000</td>
            <td class="zero">0.000</td>
            <td>1.333</td>
          </tr>
          <tr>
            <td>Right helix (12)</td><td>12</td>
            <td class="positive">+0.009</td>
            <td class="zero">&sim;0</td>
            <td class="positive">+0.520</td>
            <td>0.280</td>
          </tr>
          <tr>
            <td>Left helix (12)</td><td>12</td>
            <td class="negative">-0.009</td>
            <td class="zero">&sim;0</td>
            <td class="negative">-0.520</td>
            <td>0.286</td>
          </tr>
          <tr>
            <td>Planar triangle</td><td>3</td>
            <td class="zero">0.000</td>
            <td class="zero">0.000</td>
            <td class="zero">0.000</td>
            <td>0.034</td>
          </tr>
          <tr>
            <td>Propeller (&Delta;)</td><td>7</td>
            <td class="negative">-0.431</td>
            <td class="zero">0.000</td>
            <td class="zero">&sim;0</td>
            <td>0.214</td>
          </tr>
          <tr>
            <td>Propeller (&Lambda;)</td><td>7</td>
            <td class="positive">+0.330</td>
            <td class="zero">0.000</td>
            <td class="zero">&sim;0</td>
            <td>0.124</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="insight-box">
      <h4>Key Finding</h4>
      <p>
        The chiral multipole correctly produces opposite signs for enantiomeric pairs
        and vanishes for achiral structures. The triple product incorrectly yields
        &chi;<sub>TP</sub> = -0.308 for the achiral CH&#x2082;F&#x2082;.
        The CSM is always non-negative and cannot distinguish enantiomers.
      </p>
    </div>
  </div>

  <!-- O(3) Transformation Tests -->
  <div class="section">
    <h2>O(3) Transformation Verification</h2>
    <div class="card full-width">
      <table>
        <thead>
          <tr>
            <th>Structure</th>
            <th>Measure</th>
            <th>&chi;<sub>ref</sub></th>
            <th>Max Rel. Error</th>
            <th>SO(3) Invariance</th>
            <th>O(3)\SO(3) Sign Flip</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="3">CHFClBr (L)</td>
            <td>Triple Product</td><td>-77.549</td><td>1.28e-15</td>
            <td class="pass">PASS</td><td class="pass">PASS</td>
          </tr>
          <tr>
            <td>Chiral Multipole</td><td>0.000</td><td>4.00e-29</td>
            <td class="pass">PASS</td><td class="pass">PASS</td>
          </tr>
          <tr>
            <td>Full Multipole</td><td>0.000</td><td>6.14e-27</td>
            <td class="pass">PASS</td><td class="pass">PASS</td>
          </tr>
          <tr>
            <td rowspan="3">Right Helix</td>
            <td>Triple Product</td><td>+0.016</td><td>1.895</td>
            <td class="fail">FAIL</td><td class="fail">FAIL</td>
          </tr>
          <tr>
            <td>Chiral Multipole</td><td>&sim;0</td><td>6.55</td>
            <td class="pass">PASS</td><td class="pass">PASS</td>
          </tr>
          <tr>
            <td>Full Multipole</td><td>+0.520</td><td>1.99e-14</td>
            <td class="pass">PASS</td><td class="pass">PASS</td>
          </tr>
          <tr>
            <td rowspan="3">Propeller (&Delta;)</td>
            <td>Triple Product</td><td>-6.321</td><td>1.792</td>
            <td class="fail">FAIL</td><td class="fail">FAIL</td>
          </tr>
          <tr>
            <td>Chiral Multipole</td><td>&sim;0</td><td>1.85e-28</td>
            <td class="pass">PASS</td><td class="pass">PASS</td>
          </tr>
          <tr>
            <td>Full Multipole</td><td>&sim;0</td><td>8.20e-15</td>
            <td class="pass">PASS</td><td class="pass">PASS</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Charts: Pitch Scaling and Size Scaling -->
  <div class="section">
    <h2>Chirality Scaling with Helix Pitch</h2>
    <p>
      Chirality increases monotonically from zero (flat ring, achiral) as helix pitch grows.
      The full multipole shows cubic scaling for small pitch.
    </p>
    <div class="grid-2">
      <div class="card">
        <h3>&chi;<sub>TP</sub> vs Helix Pitch</h3>
        <div class="chart-container">
          <canvas id="chartPitchTP"></canvas>
        </div>
      </div>
      <div class="card">
        <h3>&chi;<sub>Full</sub> vs Helix Pitch</h3>
        <div class="chart-container">
          <canvas id="chartPitchFull"></canvas>
        </div>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>Size Scaling: Chirality vs Number of Atoms</h2>
    <p>
      For a helix with fixed pitch = 2.0, chirality grows superlinearly with the number of
      atoms in the extended multipole formulation.
    </p>
    <div class="grid-2">
      <div class="card">
        <h3>&chi;<sub>Full</sub> vs N (Helix, pitch=2.0)</h3>
        <div class="chart-container">
          <canvas id="chartSizeFull"></canvas>
        </div>
      </div>
      <div class="card">
        <h3>&chi;<sub>TP</sub> vs N (Helix, pitch=2.0)</h3>
        <div class="chart-container">
          <canvas id="chartSizeTP"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Extensivity -->
  <div class="section">
    <h2>Extensivity Test</h2>
    <p>
      Testing whether &chi;(A &cup; B) &asymp; &chi;(A) + &chi;(B) for two separated
      CHFClBr (L) molecules. Exact extensivity corresponds to ratio = 1.
    </p>
    <div class="grid-2">
      <div class="card">
        <h3>Extensivity Ratio vs Separation</h3>
        <div class="chart-container">
          <canvas id="chartExtensivity"></canvas>
        </div>
      </div>
      <div class="card">
        <h3>Extensivity Data</h3>
        <table>
          <thead>
            <tr><th>Separation</th><th>&chi;<sub>TP</sub> Ratio</th></tr>
          </thead>
          <tbody>
            <tr><td>10</td><td>0.190</td></tr>
            <tr><td>20</td><td>0.190</td></tr>
            <tr><td>50</td><td>0.190</td></tr>
            <tr><td>100</td><td>0.190</td></tr>
            <tr><td>200</td><td>0.190</td></tr>
            <tr><td>500</td><td>0.190</td></tr>
            <tr><td>1000</td><td>0.190</td></tr>
          </tbody>
        </table>
        <p style="font-size:0.85rem;color:var(--text-light);margin-top:0.75rem;">
          &chi;<sub>CM</sub> and &chi;<sub>Full</sub> yield machine-zero for CHFClBr
          due to channel degeneracy in this symmetric tetrahedron.
        </p>
      </div>
    </div>
  </div>

  <!-- Summary -->
  <div class="section">
    <h2>Summary of Findings</h2>
    <div class="grid-3">
      <div class="card" style="border-top: 4px solid var(--success);">
        <h3 style="color: var(--success);">Pseudoscalar Transformation</h3>
        <p style="font-size:0.9rem;">
          Multi-channel measures pass all O(3) tests with errors below 10<sup>-14</sup>.
          The triple product fails for structures with identical atomic species.
        </p>
      </div>
      <div class="card" style="border-top: 4px solid var(--accent);">
        <h3 style="color: var(--accent);">Enantiomer Discrimination</h3>
        <p style="font-size:0.9rem;">
          Correctly assigns opposite signs to L/R enantiomers.
          Helices: +0.520 (R) vs -0.520 (L). CSM cannot distinguish them.
        </p>
      </div>
      <div class="card" style="border-top: 4px solid var(--warn);">
        <h3 style="color: var(--warn);">Channel Degeneracy</h3>
        <p style="font-size:0.9rem;">
          For highly symmetric systems with identical species, the three weighting
          channels can become coplanar, yielding zero. Future work: electronic density channels.
        </p>
      </div>
    </div>

    <div class="insight-box" style="margin-top:1.5rem;">
      <h4>Proposed Chiral Analogue of the Electric Dipole</h4>
      <p>
        The triple product of three independently weighted dipole moments
        (&chi; = p&#x2081; &middot; (p&#x2082; &times; p&#x2083;)) is the
        natural pseudoscalar for structural chirality. For the bulk periodic
        generalization, each p<sub>&alpha;</sub> would be promoted to a Berry phase,
        and &chi; would become a triple product of Berry phases -- the "chiralization"
        of the crystal.
      </p>
    </div>
  </div>

</div>

<footer>
  <p>
    Open Problem from <a href="https://www.emergentmind.com/open-problems/identify-local-chiral-analogue-electric-dipole-finite-systems">Emergent Mind</a>
    &middot; Based on <a href="https://arxiv.org/abs/2601.16042">Spaldin (2026)</a>
    &middot; AI4Sciences Research
  </p>
</footer>

<script>
// ======================================================
// DATA FROM EXPERIMENTS
// ======================================================

// Pitch scaling data (50 points, sampled)
const pitchData = {
  pitches: [0.0,0.204,0.408,0.612,0.816,1.020,1.224,1.429,1.633,1.837,2.041,2.245,2.449,2.653,2.857,3.061,3.265,3.469,3.673,3.878,4.082,4.286,4.490,4.694,4.898,5.102,5.306,5.510,5.714,5.918,6.122,6.327,6.531,6.735,6.939,7.143,7.347,7.551,7.755,7.959,8.163,8.367,8.571,8.776,8.980,9.184,9.388,9.592,9.796,10.0],
  chi_tp: [0.0,0.000957,0.001914,0.002871,0.003828,0.004785,0.005742,0.006699,0.007657,0.008614,0.009571,0.010528,0.011485,0.012442,0.013399,0.014356,0.015313,0.016270,0.017227,0.018184,0.019141,0.020098,0.021055,0.022013,0.022970,0.023927,0.024884,0.025841,0.026798,0.027755,0.028712,0.029669,0.030626,0.031583,0.032540,0.033497,0.034454,0.035411,0.036369,0.037326,0.038283,0.039240,0.040197,0.041154,0.042111,0.043068,0.044025,0.044982,0.045939,0.046896],
  chi_full: [0.0,0.000007,0.000223,0.001669,0.006912,0.020650,0.050133,0.105429,0.199561,0.348551,0.571411,0.890099,1.329464,1.917188,2.683731,3.662283,4.888719,6.401572,8.241996,10.453750,13.083175,16.179180,19.793234,23.979349,28.794080,34.296516,40.548272,47.613492,55.558840,64.453501,74.369177,85.380087,97.562968,110.997068,125.764150,141.948493,159.636886,178.918633,199.885549,222.631962,247.254714,273.853157,302.529158,333.387094,366.533858,402.078851,440.133990,480.813705,524.234937,570.517139]
};

// Size scaling data (47 points, sampled at every 2)
const sizeData = {
  n: [4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50],
  chi_full: [0.000822,0.012200,0.061204,0.201069,0.519917,1.149480,2.273815,4.138030,7.057003,11.424103,17.719913,26.520951,38.508389,54.476776,75.342760,102.153808,136.096929,178.507392,230.877450,294.865063,372.302613,465.205633,575.781522,706.438271],
  chi_tp: [0.5,0.07698,0.02944,0.01535,0.00938,0.00631,0.00454,0.00341,0.00266,0.00213,0.00175,0.00146,0.00123,0.00106,0.000918,0.000804,0.000710,0.000631,0.000565,0.000508,0.000460,0.000418,0.000382,0.000350]
};

// Extensivity data
const extData = {
  separations: [10, 20, 50, 100, 200, 500, 1000],
  ratio_tp: [0.190, 0.190, 0.190, 0.190, 0.190, 0.190, 0.190]
};

// ======================================================
// CHART RENDERING
// ======================================================

const chartDefaults = {
  responsive: true,
  maintainAspectRatio: false,
  plugins: {
    legend: { display: false },
  },
  scales: {
    x: { grid: { color: '#e8e8e8' } },
    y: { grid: { color: '#e8e8e8' } }
  }
};

// Pitch scaling - Triple Product
new Chart(document.getElementById('chartPitchTP'), {
  type: 'line',
  data: {
    labels: pitchData.pitches,
    datasets: [{
      label: 'chi_TP',
      data: pitchData.chi_tp,
      borderColor: '#2196F3',
      backgroundColor: 'rgba(33,150,243,0.1)',
      fill: true,
      borderWidth: 2,
      pointRadius: 0,
      tension: 0.3
    }]
  },
  options: {
    ...chartDefaults,
    scales: {
      x: { ...chartDefaults.scales.x, title: { display: true, text: 'Helix Pitch' } },
      y: { ...chartDefaults.scales.y, title: { display: true, text: 'chi_TP' } }
    }
  }
});

// Pitch scaling - Full Multipole
new Chart(document.getElementById('chartPitchFull'), {
  type: 'line',
  data: {
    labels: pitchData.pitches,
    datasets: [{
      label: 'chi_Full',
      data: pitchData.chi_full,
      borderColor: '#4CAF50',
      backgroundColor: 'rgba(76,175,80,0.1)',
      fill: true,
      borderWidth: 2,
      pointRadius: 0,
      tension: 0.3
    }]
  },
  options: {
    ...chartDefaults,
    scales: {
      x: { ...chartDefaults.scales.x, title: { display: true, text: 'Helix Pitch' } },
      y: { ...chartDefaults.scales.y, title: { display: true, text: 'chi_Full' } }
    }
  }
});

// Size scaling - Full Multipole
new Chart(document.getElementById('chartSizeFull'), {
  type: 'line',
  data: {
    labels: sizeData.n,
    datasets: [{
      label: 'chi_Full',
      data: sizeData.chi_full,
      borderColor: '#4CAF50',
      backgroundColor: 'rgba(76,175,80,0.1)',
      fill: true,
      borderWidth: 2,
      pointRadius: 3,
      tension: 0.3
    }]
  },
  options: {
    ...chartDefaults,
    scales: {
      x: { ...chartDefaults.scales.x, title: { display: true, text: 'Number of Atoms (N)' } },
      y: { ...chartDefaults.scales.y, title: { display: true, text: 'chi_Full' } }
    }
  }
});

// Size scaling - Triple Product
new Chart(document.getElementById('chartSizeTP'), {
  type: 'line',
  data: {
    labels: sizeData.n,
    datasets: [{
      label: 'chi_TP',
      data: sizeData.chi_tp,
      borderColor: '#2196F3',
      backgroundColor: 'rgba(33,150,243,0.1)',
      fill: true,
      borderWidth: 2,
      pointRadius: 3,
      tension: 0.3
    }]
  },
  options: {
    ...chartDefaults,
    scales: {
      x: { ...chartDefaults.scales.x, title: { display: true, text: 'Number of Atoms (N)' } },
      y: { ...chartDefaults.scales.y, title: { display: true, text: 'chi_TP' } }
    }
  }
});

// Extensivity
new Chart(document.getElementById('chartExtensivity'), {
  type: 'line',
  data: {
    labels: extData.separations,
    datasets: [{
      label: 'chi_TP ratio',
      data: extData.ratio_tp,
      borderColor: '#2196F3',
      backgroundColor: 'rgba(33,150,243,0.15)',
      fill: true,
      borderWidth: 2,
      pointRadius: 5,
      pointBackgroundColor: '#2196F3'
    }, {
      label: 'Exact extensivity',
      data: extData.separations.map(() => 1.0),
      borderColor: '#333',
      borderDash: [8, 4],
      borderWidth: 1.5,
      pointRadius: 0,
      fill: false
    }]
  },
  options: {
    ...chartDefaults,
    plugins: {
      legend: { display: true, position: 'top' }
    },
    scales: {
      x: {
        type: 'logarithmic',
        title: { display: true, text: 'Separation' },
        grid: { color: '#e8e8e8' }
      },
      y: {
        min: 0,
        max: 1.2,
        title: { display: true, text: 'chi(A+B) / [chi(A) + chi(B)]' },
        grid: { color: '#e8e8e8' }
      }
    }
  }
});
</script>

</body>
</html>
