<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stabilizing Interactions in Assemblages with Weak Shared Evolutionary History</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7"></script>
<style>
:root {
    --primary: #1a3a5c;
    --primary-light: #2a5a8c;
    --accent: #2980b9;
    --accent-light: #3498db;
    --bg: #f8f9fa;
    --card-bg: #ffffff;
    --text: #2c3e50;
    --text-light: #5d6d7e;
    --border: #dee2e6;
    --success: #27ae60;
    --warning: #f39c12;
    --danger: #e74c3c;
    --gradient-start: #1a3a5c;
    --gradient-end: #2980b9;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
}
.hero {
    background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
    color: white;
    padding: 3rem 2rem;
    text-align: center;
}
.hero h1 {
    font-size: 2rem;
    font-weight: 700;
    max-width: 900px;
    margin: 0 auto 1rem;
    line-height: 1.3;
}
.hero p {
    font-size: 1.05rem;
    max-width: 750px;
    margin: 0 auto;
    opacity: 0.92;
    line-height: 1.7;
}
.hero .meta {
    margin-top: 1.2rem;
    font-size: 0.9rem;
    opacity: 0.8;
}
.hero .meta a {
    color: #a8d8ff;
    text-decoration: none;
}
.hero .meta a:hover { text-decoration: underline; }
.container { max-width: 1200px; margin: 0 auto; padding: 2rem 1.5rem; }
.key-findings {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 1.2rem;
    margin-bottom: 2.5rem;
}
.finding-card {
    background: var(--card-bg);
    border-radius: 10px;
    padding: 1.5rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    border-left: 4px solid var(--accent);
}
.finding-card h3 {
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-light);
    margin-bottom: 0.5rem;
}
.finding-card .value {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--primary);
    margin-bottom: 0.3rem;
}
.finding-card .description {
    font-size: 0.88rem;
    color: var(--text-light);
}
.finding-card.positive { border-left-color: var(--success); }
.finding-card.positive .value { color: var(--success); }
.finding-card.warning { border-left-color: var(--warning); }
.finding-card.warning .value { color: var(--warning); }
.section-title {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--primary);
    margin-bottom: 0.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--accent);
    display: inline-block;
}
.section-subtitle {
    color: var(--text-light);
    margin-bottom: 1.5rem;
    font-size: 0.95rem;
}
.chart-section { margin-bottom: 3rem; }
.chart-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(480px, 1fr));
    gap: 1.5rem;
}
.chart-card {
    background: var(--card-bg);
    border-radius: 10px;
    padding: 1.5rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}
.chart-card h4 {
    font-size: 1rem;
    color: var(--primary);
    margin-bottom: 1rem;
}
.chart-card canvas { width: 100% !important; }
.table-section { margin-bottom: 3rem; }
table {
    width: 100%;
    border-collapse: collapse;
    background: var(--card-bg);
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    font-size: 0.92rem;
}
thead { background: var(--primary); color: white; }
th { padding: 0.8rem 1rem; text-align: left; font-weight: 600; }
td { padding: 0.7rem 1rem; border-bottom: 1px solid var(--border); }
tbody tr:hover { background: #f0f4f8; }
tbody tr:last-child td { border-bottom: none; }
.methods-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.2rem;
    margin-bottom: 2rem;
}
.method-card {
    background: var(--card-bg);
    border-radius: 10px;
    padding: 1.5rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}
.method-card h4 {
    color: var(--primary);
    margin-bottom: 0.5rem;
    font-size: 1rem;
}
.method-card p { font-size: 0.9rem; color: var(--text-light); }
.tag {
    display: inline-block;
    padding: 0.2rem 0.6rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-right: 0.3rem;
}
.tag-blue { background: #dbeafe; color: #1e40af; }
.tag-green { background: #d1fae5; color: #065f46; }
.tag-orange { background: #ffedd5; color: #9a3412; }
.tag-purple { background: #ede9fe; color: #5b21b6; }
footer {
    background: var(--primary);
    color: white;
    padding: 2rem;
    text-align: center;
    font-size: 0.85rem;
    opacity: 0.9;
}
footer a { color: #a8d8ff; text-decoration: none; }
footer a:hover { text-decoration: underline; }
@media (max-width: 768px) {
    .hero h1 { font-size: 1.5rem; }
    .hero { padding: 2rem 1rem; }
    .container { padding: 1.5rem 1rem; }
    .chart-grid { grid-template-columns: 1fr; }
    .key-findings { grid-template-columns: 1fr; }
    .finding-card .value { font-size: 1.5rem; }
}
</style>
</head>
<body>

<div class="hero">
    <h1>Stabilizing Interactions in Assemblages with Weak Shared Evolutionary History</h1>
    <p>
        Do multispecies communities need deep coevolutionary history to generate stabilizing
        interactions that maintain species coexistence? We investigate through computational
        analysis of Lotka-Volterra communities across a coevolutionary gradient.
    </p>
    <div class="meta">
        Category: q-bio.PE &mdash; Populations and Evolution |
        Reference: <a href="https://arxiv.org/abs/2601.14213">Reynebeau et al. (2026) arXiv:2601.14213</a></div>
</div>

<div class="container">

    <!-- Key Findings -->
    <div class="key-findings">
        <div class="finding-card positive">
            <h3>NFD at &theta;=0</h3>
            <div class="value">+0.0728</div>
            <div class="description">Mean invasion growth rate in novel assemblages with no shared evolutionary history</div>
        </div>
        <div class="finding-card">
            <h3>Species Invading from Rarity</h3>
            <div class="value">65.7%</div>
            <div class="description">Fraction of species with positive invasion growth rate at &theta;=0</div>
        </div>
        <div class="finding-card positive">
            <h3>Stabilizing Niche Diff.</h3>
            <div class="value">0.525</div>
            <div class="description">Mean (1-&rho;) at &theta;=0 -- substantial without coevolution</div>
        </div>
        <div class="finding-card warning">
            <h3>Eco-Evo &alpha; Reduction</h3>
            <div class="value">-8.0%</div>
            <div class="description">Mean interspecific competition declines from 0.618 to 0.569 over 500 generations</div>
        </div>
    </div>

    <!-- Methods -->
    <div class="chart-section">
        <h2 class="section-title">Methods</h2>
        <p class="section-subtitle">Three complementary computational analyses addressing the open problem</p>
        <div class="methods-grid">
            <div class="method-card">
                <h4><span class="tag tag-blue">Experiment 1</span> Coevolutionary Gradient Sweep</h4>
                <p>Sweep &theta; from 0 (random assembly) to 1 (coevolved community) across Lotka-Volterra communities with S=10 species, 30 replicates per &theta; value, measuring NFD via invasion-from-rarity analysis.</p>
            </div>
            <div class="method-card">
                <h4><span class="tag tag-orange">Experiment 2</span> Eco-Evolutionary Rescue</h4>
                <p>Starting from &theta;=0, allow interaction coefficients to evolve via mutation and selection over 500 generations, testing whether NFD can emerge de novo through niche differentiation.</p>
            </div>
            <div class="method-card">
                <h4><span class="tag tag-purple">Experiment 3</span> MCT Pairwise Decomposition</h4>
                <p>Decompose coexistence into stabilizing niche differences (1-&rho;) and fitness ratios under Modern Coexistence Theory across the coevolutionary gradient (S=8, 50 replicates).</p>
            </div>
        </div>
    </div>

    <!-- Chart Section 1: Gradient Sweep -->
    <div class="chart-section">
        <h2 class="section-title">Coevolutionary Gradient Sweep</h2>
        <p class="section-subtitle">How does shared evolutionary history (&theta;) affect NFD strength and species persistence?</p>
        <div class="chart-grid">
            <div class="chart-card">
                <h4>NFD Strength vs. Coevolutionary History</h4>
                <canvas id="chartNFD"></canvas>
            </div>
            <div class="chart-card">
                <h4>Species Persistence vs. Coevolutionary History</h4>
                <canvas id="chartSurv"></canvas>
            </div>
        </div>
    </div>

    <!-- Chart Section 2: Fraction positive -->
    <div class="chart-section">
        <div class="chart-grid">
            <div class="chart-card">
                <h4>Fraction of Species with Positive Invasion Growth Rate</h4>
                <canvas id="chartFracPos"></canvas>
            </div>
            <div class="chart-card">
                <h4>NFD Strength: &theta;=0 vs &theta;=1 (Summary)</h4>
                <canvas id="chartCompare"></canvas>
            </div>
        </div>
    </div>

    <!-- Chart Section 3: Eco-Evo Rescue -->
    <div class="chart-section">
        <h2 class="section-title">Eco-Evolutionary Rescue Dynamics</h2>
        <p class="section-subtitle">Can novel assemblages develop NFD through rapid evolution?</p>
        <div class="chart-grid">
            <div class="chart-card">
                <h4>NFD Emergence over Eco-Evolutionary Generations</h4>
                <canvas id="chartEvoNFD"></canvas>
            </div>
            <div class="chart-card">
                <h4>Mean Interspecific Competition (&alpha;<sub>ij</sub>) over Time</h4>
                <canvas id="chartEvoAlpha"></canvas>
            </div>
        </div>
    </div>

    <!-- Chart Section 4: MCT Decomposition -->
    <div class="chart-section">
        <h2 class="section-title">Modern Coexistence Theory Decomposition</h2>
        <p class="section-subtitle">Stabilizing niche differences and pairwise coexistence across &theta;</p>
        <div class="chart-grid">
            <div class="chart-card">
                <h4>Stabilizing Niche Difference (1-&rho;) and Niche Overlap (&rho;)</h4>
                <canvas id="chartMCTStab"></canvas>
            </div>
            <div class="chart-card">
                <h4>Fraction of Coexisting Species Pairs</h4>
                <canvas id="chartMCTCoex"></canvas>
            </div>
        </div>
    </div>

    <!-- Results Table -->
    <div class="table-section">
        <h2 class="section-title">Summary Results</h2>
        <p class="section-subtitle">Key metrics at selected &theta; values from the gradient sweep (S=10, 30 replicates)</p>
        <table>
            <thead>
                <tr>
                    <th>&theta;</th>
                    <th>Mean NFD</th>
                    <th>SD NFD</th>
                    <th>Surviving (of 10)</th>
                    <th>% Positive Invasion</th>
                    <th>1-&rho; (MCT)</th>
                    <th>Coexisting Pairs</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>0.00</td><td>+0.0728</td><td>0.0318</td><td>6.67</td><td>65.7%</td><td>0.525</td><td>97.0%</td></tr>
                <tr><td>0.10</td><td>+0.0896</td><td>0.0179</td><td>7.50</td><td>74.3%</td><td>0.518</td><td>97.2%</td></tr>
                <tr><td>0.25</td><td>+0.0742</td><td>0.0279</td><td>7.37</td><td>73.7%</td><td>0.525</td><td>98.3%</td></tr>
                <tr><td>0.50</td><td>+0.0628</td><td>0.0178</td><td>7.27</td><td>71.3%</td><td>0.528</td><td>98.2%</td></tr>
                <tr><td>0.75</td><td>+0.0426</td><td>0.0111</td><td>6.67</td><td>65.0%</td><td>0.535</td><td>93.9%</td></tr>
                <tr><td>1.00</td><td>+0.0027</td><td>0.0023</td><td>4.00</td><td>40.0%</td><td>0.545</td><td>85.6%</td></tr>
            </tbody>
        </table>
    </div>

    <!-- Eco-Evo Table -->
    <div class="table-section">
        <h2 class="section-title">Eco-Evolutionary Rescue Summary</h2>
        <p class="section-subtitle">Metrics at start and end of 500-generation simulation (S=10, &theta;<sub>initial</sub>=0)</p>
        <table>
            <thead>
                <tr>
                    <th>Metric</th>
                    <th>Generation 0</th>
                    <th>Generation 499</th>
                    <th>Change</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Mean NFD</td><td>+0.0859</td><td>+0.0866</td><td>+0.8%</td></tr>
                <tr><td>Mean &alpha;<sub>ij</sub></td><td>0.618</td><td>0.569</td><td>-8.0%</td></tr>
                <tr><td>Surviving species</td><td>9</td><td>10</td><td>+1</td></tr>
                <tr><td>Fraction positive invasion</td><td>0.90</td><td>0.80</td><td>-0.10</td></tr>
            </tbody>
        </table>
    </div>

    <!-- Conclusions -->
    <div class="chart-section">
        <h2 class="section-title">Key Conclusions</h2>
        <div class="methods-grid">
            <div class="method-card">
                <h4><span class="tag tag-green">Finding 1</span> NFD Does Not Require Coevolution</h4>
                <p>Novel assemblages (&theta;=0) exhibit positive NFD with mean invasion growth rate +0.0728 and 65.7% of species achieving positive invasion rates. Stabilizing niche differences (1-&rho;=0.525) are nearly as large as in coevolved communities.</p>
            </div>
            <div class="method-card">
                <h4><span class="tag tag-green">Finding 2</span> Coevolution Reshapes but Does Not Uniformly Strengthen NFD</h4>
                <p>Increasing &theta; reduces mean NFD and fraction of coexisting pairs because structured niche partitioning introduces fitness asymmetries between neighboring species on the niche axis.</p>
            </div>
            <div class="method-card">
                <h4><span class="tag tag-green">Finding 3</span> Eco-Evolutionary Dynamics Maintain NFD</h4>
                <p>Novel assemblages maintain positive NFD over 500 generations while mean interspecific competition decreases by 8.0% through evolved niche differentiation, suggesting rapid coevolution can stabilize novel communities.</p>
            </div>
        </div>
    </div>

</div>

<footer>
    <p>
        Open Problem: Stabilizing Interactions in Assemblages with Weak Shared Evolutionary History |
        Category: q-bio.PE |
        Based on <a href="https://arxiv.org/abs/2601.14213">Reynebeau et al. (2026)</a></p>
</footer>

<script>
const GRADIENT_THETA = [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0];
const GRADIENT_NFD_MEAN = [0.072796, 0.07487, 0.08958, 0.078811, 0.081002, 0.074186, 0.074923, 0.073675, 0.069996, 0.070302, 0.06282, 0.065486, 0.061224, 0.054536, 0.048151, 0.042622, 0.039706, 0.034423, 0.025249, 0.015947, 0.002733];
const GRADIENT_NFD_STD = [0.031821, 0.037691, 0.017917, 0.032529, 0.026445, 0.027863, 0.034104, 0.028756, 0.021962, 0.019633, 0.01777, 0.016571, 0.010362, 0.014293, 0.015253, 0.011076, 0.007777, 0.004741, 0.00479, 0.003816, 0.002251];
const GRADIENT_SURV_MEAN = [6.6667, 7.1667, 7.5, 6.6, 7.4, 7.3667, 7.3333, 7.2333, 7.0, 7.5, 7.2667, 7.1333, 7.2333, 7.0667, 6.8, 6.6667, 6.6, 6.2, 5.2667, 4.7, 4.0];
const GRADIENT_SURV_STD = [1.2996, 1.4162, 1.0878, 1.1136, 1.2543, 1.2512, 1.1353, 1.4761, 1.1547, 1.4083, 1.3149, 1.384, 0.9195, 1.2092, 1.222, 1.2202, 1.2, 1.0456, 1.1235, 0.6904, 0.0];
const GRADIENT_FRAC_POS = [0.6567, 0.6967, 0.7433, 0.6533, 0.74, 0.7367, 0.7267, 0.7133, 0.6967, 0.74, 0.7133, 0.7, 0.7167, 0.6967, 0.6767, 0.65, 0.6433, 0.6033, 0.4933, 0.4433, 0.4];

const EVO_GEN = [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250, 255, 260, 265, 270, 275, 280, 285, 290, 295, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 405, 410, 415, 420, 425, 430, 435, 440, 445, 450, 455, 460, 465, 470, 475, 480, 485, 490, 495];
const EVO_NFD = [0.085937, 0.085424, 0.085123, 0.084816, 0.083024, 0.081869, 0.085163, 0.083293, 0.082767, 0.083342, 0.083091, 0.083327, 0.085946, 0.085624, 0.08606, 0.085575, 0.086693, 0.085863, 0.085737, 0.086781, 0.087393, 0.087777, 0.089198, 0.090265, 0.09009, 0.090282, 0.089968, 0.090588, 0.090784, 0.090222, 0.088925, 0.088465, 0.088364, 0.088956, 0.08875, 0.088768, 0.088816, 0.089487, 0.09023, 0.088609, 0.088945, 0.090539, 0.091191, 0.091134, 0.090905, 0.091047, 0.0894, 0.088363, 0.086487, 0.087511, 0.088061, 0.090931, 0.092204, 0.091866, 0.092535, 0.091821, 0.091731, 0.092236, 0.093359, 0.09285, 0.092657, 0.090812, 0.091249, 0.090023, 0.090077, 0.091076, 0.090554, 0.08818, 0.088429, 0.091354, 0.091136, 0.090373, 0.090531, 0.090828, 0.090859, 0.090063, 0.089122, 0.08873, 0.089048, 0.088094, 0.087461, 0.087358, 0.085801, 0.084785, 0.086529, 0.086623, 0.08794, 0.087124, 0.087133, 0.088554, 0.090001, 0.089864, 0.091419, 0.091568, 0.090752, 0.089725, 0.089181, 0.088226, 0.087744, 0.089144];
const EVO_ALPHA = [0.617971, 0.618154, 0.618276, 0.617103, 0.615758, 0.616649, 0.614639, 0.614235, 0.613853, 0.613403, 0.6133, 0.613148, 0.611465, 0.61036, 0.608628, 0.606875, 0.606275, 0.606124, 0.605789, 0.605724, 0.605108, 0.604299, 0.602925, 0.603115, 0.602842, 0.603247, 0.60176, 0.601214, 0.600653, 0.600985, 0.60076, 0.599741, 0.59905, 0.599343, 0.598556, 0.597853, 0.596725, 0.596633, 0.596399, 0.596328, 0.597364, 0.596783, 0.59653, 0.595753, 0.595348, 0.595062, 0.595738, 0.595164, 0.595325, 0.594357, 0.594776, 0.594688, 0.593708, 0.593148, 0.592497, 0.592828, 0.592165, 0.592688, 0.592161, 0.591406, 0.591368, 0.590983, 0.590438, 0.589899, 0.588879, 0.588212, 0.586466, 0.585635, 0.584958, 0.584803, 0.585063, 0.584481, 0.583773, 0.582892, 0.582224, 0.581389, 0.581345, 0.57983, 0.579686, 0.57895, 0.578069, 0.577136, 0.578272, 0.578704, 0.577082, 0.577638, 0.577231, 0.575812, 0.576284, 0.575475, 0.574812, 0.574944, 0.57377, 0.573257, 0.572504, 0.571623, 0.571224, 0.570988, 0.570792, 0.570239];

const MCT_THETA = [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0];
const MCT_STAB = [0.524838, 0.518355, 0.51784, 0.521396, 0.523674, 0.52466, 0.523847, 0.525205, 0.532454, 0.523631, 0.528371, 0.530878, 0.530219, 0.532068, 0.535899, 0.5353, 0.537334, 0.538503, 0.541509, 0.543163, 0.545353];
const MCT_COEX = [0.97, 0.957857, 0.972143, 0.973571, 0.973571, 0.982857, 0.987857, 0.981429, 0.985714, 0.979286, 0.982143, 0.969286, 0.970714, 0.962143, 0.962143, 0.938571, 0.939286, 0.917143, 0.904286, 0.875714, 0.856429];
const MCT_OVERLAP = [0.475162, 0.481645, 0.48216, 0.478604, 0.476326, 0.47534, 0.476153, 0.474795, 0.467546, 0.476369, 0.471629, 0.469122, 0.469781, 0.467932, 0.464101, 0.4647, 0.462666, 0.461497, 0.458491, 0.456837, 0.454647];

const thetaLabels = GRADIENT_THETA.map(t => t.toFixed(2));

// Utility: error band plugin
const errorBandPlugin = {
    id: 'errorBand',
    beforeDatasetsDraw(chart) {
        const meta = chart.getDatasetMeta(0);
        if (!meta | !meta.data | meta.data.length === 0) return;
        const ctx = chart.ctx;
        const ds = chart.data.datasets[0];
        if (!ds._errorHigh | !ds._errorLow) return;
        ctx.save();
        ctx.fillStyle = ds.backgroundColor | 'rgba(41,128,185,0.15)';
        ctx.beginPath();
        const yScale = chart.scales.y;
        const points = meta.data;
        for (let i = 0; i < points.length; i++) {
            const y = yScale.getPixelForValue(ds._errorHigh[i]);
            if (i === 0) ctx.moveTo(points[i].x, y);
            else ctx.lineTo(points[i].x, y);
        }
        for (let i = points.length - 1; i >= 0; i--) {
            const y = yScale.getPixelForValue(ds._errorLow[i]);
            ctx.lineTo(points[i].x, y);
        }
        ctx.closePath();
        ctx.fill();
        ctx.restore();
    }
};

// Chart 1: NFD vs theta
new Chart(document.getElementById('chartNFD'), {
    type: 'line',
    plugins: [errorBandPlugin],
    data: {
        labels: thetaLabels,
        datasets: [{
            label: 'Mean NFD',
            data: GRADIENT_NFD_MEAN,
            borderColor: '#2166ac',
            backgroundColor: 'rgba(33,102,172,0.15)',
            pointRadius: 3,
            borderWidth: 2,
            fill: false,
            _errorHigh: GRADIENT_NFD_MEAN.map((v,i) => v + GRADIENT_NFD_STD[i]),
            _errorLow: GRADIENT_NFD_MEAN.map((v,i) => v - GRADIENT_NFD_STD[i])
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { display: false },
            tooltip: { callbacks: { label: ctx => `NFD: ${ctx.parsed.y.toFixed(4)}` } }
        },
        scales: {
            x: { title: { display: true, text: 'Shared evolutionary history (theta)' } },
            y: { title: { display: true, text: 'Mean invasion growth rate (NFD)' }, suggestedMin: -0.02 }
        },
        annotation: {
            annotations: {
                zeroLine: { type: 'line', yMin: 0, yMax: 0, borderColor: 'gray', borderDash: [5,5], borderWidth: 1 }
            }
        }
    }
});

// Chart 2: Surviving species vs theta
new Chart(document.getElementById('chartSurv'), {
    type: 'line',
    plugins: [errorBandPlugin],
    data: {
        labels: thetaLabels,
        datasets: [{
            label: 'Mean surviving',
            data: GRADIENT_SURV_MEAN,
            borderColor: '#1b7837',
            backgroundColor: 'rgba(27,120,55,0.15)',
            pointRadius: 3,
            borderWidth: 2,
            fill: false,
            _errorHigh: GRADIENT_SURV_MEAN.map((v,i) => v + GRADIENT_SURV_STD[i]),
            _errorLow: GRADIENT_SURV_MEAN.map((v,i) => v - GRADIENT_SURV_STD[i])
        }]
    },
    options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
            x: { title: { display: true, text: 'Shared evolutionary history (theta)' } },
            y: { title: { display: true, text: 'Surviving species (of 10)' }, min: 0, max: 11 }
        }
    }
});

// Chart 3: Fraction positive invasion
new Chart(document.getElementById('chartFracPos'), {
    type: 'line',
    data: {
        labels: thetaLabels,
        datasets: [{
            label: '% species with positive invasion rate',
            data: GRADIENT_FRAC_POS.map(v => v * 100),
            borderColor: '#e6550d',
            backgroundColor: 'rgba(230,85,13,0.1)',
            pointRadius: 3,
            borderWidth: 2,
            fill: true
        }]
    },
    options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
            x: { title: { display: true, text: 'Shared evolutionary history (theta)' } },
            y: { title: { display: true, text: '% species with positive invasion rate' }, min: 0, max: 100 }
        }
    }
});

// Chart 4: Bar comparison theta=0 vs theta=1
new Chart(document.getElementById('chartCompare'), {
    type: 'bar',
    data: {
        labels: ['Mean NFD', 'Surviving (of 10)', '% Positive Inv.', '1-rho (MCT)'],
        datasets: [
            {
                label: 'theta = 0 (no history)',
                data: [0.0728, 6.67, 65.7, 52.5],
                backgroundColor: 'rgba(217,95,2,0.7)',
                borderColor: '#d95f02',
                borderWidth: 1
            },
            {
                label: 'theta = 1 (coevolved)',
                data: [0.0027, 4.0, 40.0, 54.5],
                backgroundColor: 'rgba(33,102,172,0.7)',
                borderColor: '#2166ac',
                borderWidth: 1
            }
        ]
    },
    options: {
        responsive: true,
        plugins: { legend: { position: 'top' } },
        scales: {
            x: { title: { display: true, text: 'Metric' } },
            y: { title: { display: true, text: 'Value' } }
        }
    }
});

// Chart 5: Eco-evo NFD over time
new Chart(document.getElementById('chartEvoNFD'), {
    type: 'line',
    data: {
        labels: EVO_GEN,
        datasets: [{
            label: 'Mean NFD',
            data: EVO_NFD,
            borderColor: '#d95f02',
            backgroundColor: 'rgba(217,95,2,0.1)',
            pointRadius: 0,
            borderWidth: 2,
            fill: true
        }]
    },
    options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
            x: { title: { display: true, text: 'Eco-evolutionary generation' } },
            y: { title: { display: true, text: 'Mean invasion growth rate' }, suggestedMin: 0.07 }
        }
    }
});

// Chart 6: Eco-evo alpha over time
new Chart(document.getElementById('chartEvoAlpha'), {
    type: 'line',
    data: {
        labels: EVO_GEN,
        datasets: [{
            label: 'Mean alpha_ij',
            data: EVO_ALPHA,
            borderColor: '#7570b3',
            backgroundColor: 'rgba(117,112,179,0.1)',
            pointRadius: 0,
            borderWidth: 2,
            fill: true
        }]
    },
    options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
            x: { title: { display: true, text: 'Eco-evolutionary generation' } },
            y: { title: { display: true, text: 'Mean interspecific competition' } }
        }
    }
});

// Chart 7: MCT stabilizing diff and niche overlap
new Chart(document.getElementById('chartMCTStab'), {
    type: 'line',
    data: {
        labels: MCT_THETA.map(t => t.toFixed(2)),
        datasets: [
            {
                label: '1-rho (stabilizing diff)',
                data: MCT_STAB,
                borderColor: '#b2182b',
                pointRadius: 3,
                borderWidth: 2,
                fill: false
            },
            {
                label: 'rho (niche overlap)',
                data: MCT_OVERLAP,
                borderColor: '#4393c3',
                borderDash: [5,5],
                pointRadius: 3,
                borderWidth: 2,
                fill: false
            }
        ]
    },
    options: {
        responsive: true,
        plugins: { legend: { position: 'top' } },
        scales: {
            x: { title: { display: true, text: 'Shared evolutionary history (theta)' } },
            y: { title: { display: true, text: 'Value' }, min: 0, max: 1 }
        }
    }
});

// Chart 8: MCT coexisting pairs
new Chart(document.getElementById('chartMCTCoex'), {
    type: 'line',
    data: {
        labels: MCT_THETA.map(t => t.toFixed(2)),
        datasets: [{
            label: 'Fraction coexisting pairs',
            data: MCT_COEX.map(v => v * 100),
            borderColor: '#762a83',
            backgroundColor: 'rgba(118,42,131,0.1)',
            pointRadius: 3,
            borderWidth: 2,
            fill: true
        }]
    },
    options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
            x: { title: { display: true, text: 'Shared evolutionary history (theta)' } },
            y: { title: { display: true, text: '% coexisting species pairs' }, min: 70, max: 100 }
        }
    }
});
</script>

</body>
</html>
